
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Uncertainty in biomarker identification &#8212; ml_uncertainty 0.1.1 documentation</title>
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css" />
    <link rel="stylesheet" type="text/css" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="https://pages.nist.gov/nist-header-footer/js/jquery-1.9.0.min.js"></script>
    <script type="text/javascript" src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js"></script>
    <script id="_fed_an_ua_tag" type="text/javascript" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NIST&subagency=github&pua=UA-42404149-54&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery.1.12.4.min.js"></script>
    <script type="text/javascript" src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
    <script type="text/javascript" src="_static/leave_notice.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Uncertainty in QSAR modeling" href="qsar_regression_object-oriented.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">ml_uncertainty 0.1.1 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="qsar_regression_object-oriented.html" title="Uncertainty in QSAR modeling"
             accesskey="P">previous</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 4ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Uncertainty-in-biomarker-identification">
<h1>Uncertainty in biomarker identification<a class="headerlink" href="#Uncertainty-in-biomarker-identification" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Imports-and-local-function-definitions">
<h2>Imports and local function definitions<a class="headerlink" href="#Imports-and-local-function-definitions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Imports">
<h3>Imports<a class="headerlink" href="#Imports" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">usepylab</span> <span class="o">=</span> <span class="kc">True</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>

<span class="k">if</span> <span class="n">usepylab</span><span class="p">:</span>
    <span class="o">%</span><span class="k">matplotlib</span> inline
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Agg&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">scipy.linalg</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>

<span class="c1">#scikit-learn</span>
<span class="kn">import</span> <span class="nn">sklearn.cross_decomposition</span>
<span class="kn">import</span> <span class="nn">sklearn.model_selection</span>
<span class="kn">import</span> <span class="nn">sklearn.decomposition</span>
<span class="kn">import</span> <span class="nn">sklearn.preprocessing</span>

<span class="c1">#NIST spectral analysis and uncertainty analysis packages</span>
<span class="kn">import</span> <span class="nn">qmet</span>
<span class="kn">import</span> <span class="nn">ml_uncertainty</span> <span class="k">as</span> <span class="nn">plu</span>
<span class="c1">#import pls_uncertainty as plu</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Utility-functions">
<h3>Utility functions<a class="headerlink" href="#Utility-functions" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">pca_uncertainty_plot</span><span class="p">(</span><span class="n">plsax</span><span class="p">,</span>
                         <span class="n">series_colors</span><span class="p">,</span>
                         <span class="n">classes</span><span class="p">,</span>
                         <span class="n">scores</span><span class="p">,</span>
                         <span class="n">bootstrap_classes</span><span class="p">,</span>
                         <span class="n">bootstrap_scores</span><span class="p">,</span>
                         <span class="n">class_names</span><span class="o">=</span><span class="p">[],</span>
                         <span class="n">x_comp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">y_comp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                         <span class="n">boot_scatter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">sample_ellipses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">boot_group_ellipses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">group_ellipses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">sample_bars</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">group_tags</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="p">):</span>
    <span class="c1">#Create the figure</span>
    <span class="c1">#fig,axes = plt.subplots(1,2,figsize=(12,6))</span>
    <span class="n">ellipses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">F_alpha</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="c1"># 95% confidence limit</span>

    <span class="k">for</span> <span class="n">class_num</span><span class="p">,</span><span class="n">color</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">series_colors</span><span class="p">):</span>
        <span class="c1">#Get the column that defines the samples as being in this class</span>
        <span class="n">sample_class</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[:,</span><span class="n">class_num</span><span class="p">]</span>
        <span class="c1">#Convert to a mask</span>
        <span class="n">class_mask</span> <span class="o">=</span> <span class="n">sample_class</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="c1">#PCA scores</span>
        <span class="n">x_pl</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="n">class_mask</span><span class="p">,</span><span class="n">x_comp</span><span class="p">]</span>
        <span class="n">y_pl</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="n">class_mask</span><span class="p">,</span><span class="n">y_comp</span><span class="p">]</span>
        <span class="n">plsax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_pl</span><span class="p">,</span><span class="n">y_pl</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="c1">#Number of samples in this class</span>
        <span class="n">num_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">class_mask</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bootstrap_classes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1">#Get the column that defines the samples as being in this class</span>
            <span class="n">sample_class</span> <span class="o">=</span> <span class="n">bootstrap_classes</span><span class="p">[:,</span><span class="n">class_num</span><span class="p">]</span>
            <span class="c1">#Change to a mask</span>
            <span class="n">class_mask_boot</span> <span class="o">=</span> <span class="n">sample_class</span> <span class="o">==</span> <span class="mi">1</span>

            <span class="c1">#Bootstrap scores</span>
            <span class="n">x_sc</span> <span class="o">=</span> <span class="n">scores_boot</span><span class="p">[</span><span class="n">class_mask_boot</span><span class="p">,</span><span class="n">x_comp</span><span class="p">]</span>
            <span class="n">y_sc</span> <span class="o">=</span> <span class="n">scores_boot</span><span class="p">[</span><span class="n">class_mask_boot</span><span class="p">,</span><span class="n">y_comp</span><span class="p">]</span>

        <span class="c1">#Bootstrap scores scatter plot</span>
        <span class="k">if</span> <span class="n">boot_scatter</span><span class="p">:</span> <span class="n">plsax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_sc</span><span class="p">,</span><span class="n">y_sc</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1">#Error bars on individual samples from bootstrap</span>
        <span class="k">if</span> <span class="n">sample_bars</span> <span class="ow">or</span> <span class="n">sample_ellipses</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">):</span>
                <span class="n">x_pt</span> <span class="o">=</span> <span class="n">x_sc</span><span class="p">[</span><span class="n">point</span><span class="p">::</span><span class="n">num_samples</span><span class="p">]</span>
                <span class="n">y_pt</span> <span class="o">=</span> <span class="n">y_sc</span><span class="p">[</span><span class="n">point</span><span class="p">::</span><span class="n">num_samples</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">sample_bars</span><span class="p">:</span>
                    <span class="n">x_err</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x_pt</span><span class="p">,</span><span class="mf">97.5</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x_pt</span><span class="p">,</span><span class="mf">2.5</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
                    <span class="n">y_err</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y_pt</span><span class="p">,</span><span class="mf">97.5</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y_pt</span><span class="p">,</span><span class="mf">2.5</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>

                    <span class="n">plsax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x_pl</span><span class="p">[</span><span class="n">point</span><span class="p">],</span><span class="n">y_pl</span><span class="p">[</span><span class="n">point</span><span class="p">],</span><span class="n">xerr</span><span class="o">=</span><span class="n">x_err</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">y_err</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">sample_ellipses</span><span class="p">:</span>
                    <span class="c1">#Calculate the covariance matrix for the bootstrap scores for this sample</span>
                    <span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x_pt</span><span class="p">,</span><span class="n">y_pt</span><span class="p">)</span>
                    <span class="c1">#Calculate the eigenvalues and eigenvectors of cov</span>
                    <span class="n">lam</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>
                    <span class="c1">#Calculate the size and orientation of the confidence ellipse</span>
                    <span class="n">lam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>
                    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">*</span><span class="n">v</span><span class="p">[:,</span><span class="mi">0</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

                    <span class="n">pca_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_pt</span><span class="p">)</span>

                    <span class="c1">#Calculate the 95% confidence limit based on the F distribution</span>
                    <span class="n">df1</span> <span class="o">=</span> <span class="mi">2</span>
                    <span class="n">df2</span> <span class="o">=</span> <span class="n">pca_samples</span> <span class="o">-</span> <span class="n">df1</span>
                    <span class="n">F_val</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="n">F_alpha</span><span class="p">,</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">)</span>

                    <span class="n">F_mult</span> <span class="o">=</span> <span class="n">F_val</span> <span class="o">*</span> <span class="n">df1</span><span class="o">*</span><span class="p">(</span><span class="n">pca_samples</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
                    <span class="n">F_mult</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">F_mult</span><span class="p">)</span>
                    <span class="n">ellipse_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_pt</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_pt</span><span class="p">)),</span>
                            <span class="n">width</span><span class="o">=</span><span class="n">lam</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">F_mult</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">lam</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">F_mult</span><span class="p">,</span>
                            <span class="n">angle</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
                    <span class="n">ell</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Ellipse</span><span class="p">(</span><span class="o">**</span><span class="n">ellipse_dict</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">boot_scatter</span><span class="p">:</span> <span class="n">ell</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;0.2&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">boot_group_ellipses</span><span class="p">:</span> <span class="n">ell</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;0.6&#39;</span><span class="p">)</span>

                    <span class="n">plsax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">boot_group_ellipses</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">class_mask_boot</span><span class="p">):</span>
            <span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x_sc</span><span class="p">,</span><span class="n">y_sc</span><span class="p">)</span>
            <span class="n">lam</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>
            <span class="n">lam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">*</span><span class="n">v</span><span class="p">[:,</span><span class="mi">0</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

            <span class="n">pca_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_sc</span><span class="p">)</span>

            <span class="n">df1</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="n">df2</span> <span class="o">=</span> <span class="n">pca_samples</span> <span class="o">-</span> <span class="n">df1</span>
            <span class="n">F_val</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="n">F_alpha</span><span class="p">,</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">)</span>

            <span class="n">F_mult</span> <span class="o">=</span> <span class="n">F_val</span> <span class="o">*</span> <span class="n">df1</span><span class="o">*</span><span class="p">(</span><span class="n">pca_samples</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
            <span class="n">F_mult</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">F_mult</span><span class="p">)</span>
            <span class="n">ellipse_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_sc</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_sc</span><span class="p">)),</span>
                                <span class="n">width</span><span class="o">=</span><span class="n">lam</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">F_mult</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">lam</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">F_mult</span><span class="p">,</span>
                                <span class="n">angle</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">ell</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Ellipse</span><span class="p">(</span><span class="o">**</span><span class="n">ellipse_dict</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">boot_scatter</span><span class="p">:</span> <span class="n">ell</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">plsax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">group_tags</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">boot_group_ellipses</span><span class="p">:</span>
                <span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x_sc</span><span class="p">,</span><span class="n">y_sc</span><span class="p">)</span>
                <span class="n">lam</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>
                <span class="n">lam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">*</span><span class="n">v</span><span class="p">[:,</span><span class="mi">0</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">pca_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_sc</span><span class="p">)</span>
                <span class="n">df1</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="n">df2</span> <span class="o">=</span> <span class="n">pca_samples</span> <span class="o">-</span> <span class="n">df1</span>
                <span class="n">F_val</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="n">F_alpha</span><span class="p">,</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">)</span>
                <span class="n">F_mult</span> <span class="o">=</span> <span class="n">F_val</span> <span class="o">*</span> <span class="n">df1</span><span class="o">*</span><span class="p">(</span><span class="n">pca_samples</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
                <span class="n">F_mult</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">F_mult</span><span class="p">)</span>
            <span class="n">x_text_offset</span> <span class="o">=</span> <span class="n">lam</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">F_mult</span><span class="o">*-</span><span class="mf">1.1</span>
            <span class="n">y_text_offset</span> <span class="o">=</span> <span class="n">lam</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">F_mult</span><span class="o">*-</span><span class="mf">1.1</span>
            <span class="n">plsax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_sc</span><span class="o">+</span><span class="n">x_text_offset</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_sc</span><span class="o">+</span><span class="n">y_text_offset</span><span class="p">),</span>
                       <span class="n">class_names</span><span class="p">[</span><span class="n">class_num</span><span class="p">],</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                       <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">group_ellipses</span><span class="p">:</span>
            <span class="c1">#Calculate the covariance matrix for the bootstrap scores for this sample</span>
            <span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x_pl</span><span class="p">,</span><span class="n">y_pl</span><span class="p">)</span>
            <span class="c1">#Calculate the eigenvalues and eigenvectors of cov</span>
            <span class="n">lam</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>

            <span class="c1">#Calculate the size and orientation of the confidence ellipse</span>
            <span class="n">lam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">*</span><span class="n">v</span><span class="p">[:,</span><span class="mi">0</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

            <span class="n">df1</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="n">df2</span> <span class="o">=</span> <span class="n">num_samples</span> <span class="o">-</span> <span class="n">df1</span>

            <span class="n">F_val</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="n">F_alpha</span><span class="p">,</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">)</span>

            <span class="n">F_mult</span> <span class="o">=</span> <span class="n">F_val</span> <span class="o">*</span> <span class="n">df1</span><span class="o">*</span><span class="p">(</span><span class="n">num_samples</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
            <span class="n">F_mult</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">F_mult</span><span class="p">)</span>
            <span class="n">ellipse_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_pl</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_pl</span><span class="p">)),</span>
                                <span class="n">width</span><span class="o">=</span><span class="n">lam</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">F_mult</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">lam</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">F_mult</span><span class="p">,</span>
                                <span class="n">angle</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="n">ell</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Ellipse</span><span class="p">(</span><span class="o">**</span><span class="n">ellipse_dict</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">boot_scatter</span><span class="p">:</span> <span class="n">ell</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">plsax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>

    <span class="n">plsax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="n">patches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">class_name</span><span class="p">,</span><span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">class_names</span><span class="p">,</span><span class="n">series_colors</span><span class="p">):</span>
            <span class="n">patches</span> <span class="o">+=</span> <span class="p">[</span><span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">class_name</span><span class="p">)]</span>
        <span class="n">plsax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">patches</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">score_classes</span><span class="p">(</span><span class="n">plsax</span><span class="p">,</span>
                  <span class="n">series_colors</span><span class="p">,</span>
                  <span class="n">classes</span><span class="p">,</span>
                  <span class="n">scores</span><span class="p">,</span>
                  <span class="n">bootstrap_classes</span><span class="p">,</span>
                  <span class="n">bootstrap_scores</span><span class="p">,</span>
                  <span class="n">class_names</span><span class="o">=</span><span class="p">[],</span>
                  <span class="n">x_comp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">y_comp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">boot_scatter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">sample_ellipses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">boot_group_ellipses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">group_ellipses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">sample_bars</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">f_alphas</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">f_alphas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">f_alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
    <span class="c1">#print(f_alphas)</span>

    <span class="n">F_scores</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">class_num</span><span class="p">,</span><span class="n">color</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">series_colors</span><span class="p">):</span>
        <span class="c1">#Get the column that defines the samples as being in this class</span>
        <span class="n">sample_class</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[:,</span><span class="n">class_num</span><span class="p">]</span>
        <span class="c1">#Convert to a mask</span>
        <span class="n">class_mask</span> <span class="o">=</span> <span class="n">sample_class</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="c1">#PCA scores</span>
        <span class="n">x_pl</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="n">class_mask</span><span class="p">,</span><span class="n">x_comp</span><span class="p">]</span>
        <span class="n">y_pl</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="n">class_mask</span><span class="p">,</span><span class="n">y_comp</span><span class="p">]</span>
        <span class="c1">#plsax.scatter(x_pl,y_pl,c=color,edgecolors=&#39;k&#39;,s=30,zorder=5)</span>

        <span class="c1">#Number of samples in this class</span>
        <span class="n">num_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">class_mask</span><span class="p">)</span>

        <span class="c1">#Get the column that defines the samples as being in this class</span>
        <span class="n">sample_class</span> <span class="o">=</span> <span class="n">bootstrap_classes</span><span class="p">[:,</span><span class="n">class_num</span><span class="p">]</span>
        <span class="c1">#Change to a mask</span>
        <span class="n">class_mask_boot</span> <span class="o">=</span> <span class="n">sample_class</span> <span class="o">==</span> <span class="mi">1</span>

        <span class="c1">#Bootstrap scores for this class</span>
        <span class="n">x_sc</span> <span class="o">=</span> <span class="n">scores_boot</span><span class="p">[</span><span class="n">class_mask_boot</span><span class="p">,</span><span class="n">x_comp</span><span class="p">]</span>
        <span class="n">y_sc</span> <span class="o">=</span> <span class="n">scores_boot</span><span class="p">[</span><span class="n">class_mask_boot</span><span class="p">,</span><span class="n">y_comp</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">class_mask_boot</span><span class="p">):</span>
            <span class="c1">#Calculate the covariance matrix of the boot scores so that we can Hoetelling the samples</span>
            <span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x_sc</span><span class="p">,</span><span class="n">y_sc</span><span class="p">)</span>
            <span class="n">icov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>
            <span class="c1">#print(cov)</span>
            <span class="n">pca_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_sc</span><span class="p">)</span>
            <span class="n">lam</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>

            <span class="c1">#Calculate the size and orientation of the confidence ellipse</span>
            <span class="n">lam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">*</span><span class="n">v</span><span class="p">[:,</span><span class="mi">0</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

            <span class="n">df1</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="n">df2</span> <span class="o">=</span> <span class="n">pca_samples</span> <span class="o">-</span> <span class="n">df1</span>

            <span class="n">Hoetelling_mult</span> <span class="o">=</span> <span class="n">df1</span><span class="o">*</span><span class="p">(</span><span class="n">pca_samples</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

            <span class="n">xy_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_sc</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_sc</span><span class="p">))</span>

            <span class="n">T_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xy_tuple</span><span class="p">])</span>
            <span class="c1">#print(T_center.shape)</span>

            <span class="c1">#print(lam)</span>

            <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">f_alphas</span><span class="p">:</span>
                <span class="c1">#print(alpha)</span>
                <span class="n">F_val</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">)</span>
                <span class="n">F_mult</span> <span class="o">=</span> <span class="n">F_val</span> <span class="o">*</span> <span class="n">Hoetelling_mult</span>
                <span class="n">F_mult</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">F_mult</span><span class="p">)</span>
                <span class="c1">#print(F_mult)</span>

                <span class="n">ellipse_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="n">xy_tuple</span><span class="p">,</span>
                                    <span class="n">width</span><span class="o">=</span><span class="n">lam</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">F_mult</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">lam</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">F_mult</span><span class="p">,</span>
                                    <span class="n">angle</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
                <span class="n">ell</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Ellipse</span><span class="p">(</span><span class="o">**</span><span class="n">ellipse_dict</span><span class="p">)</span>
                <span class="n">plsax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>

            <span class="c1">#Iterate over the sample points and calculate the Hoetelling distance and the corresponding survival function</span>
            <span class="k">for</span> <span class="n">xp</span><span class="p">,</span><span class="n">yp</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_pl</span><span class="p">,</span><span class="n">y_pl</span><span class="p">):</span>
                <span class="n">sample_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">xp</span><span class="p">,</span><span class="n">yp</span><span class="p">]])</span>
                <span class="c1">#print(sample_point.shape)</span>

                <span class="n">t_rel</span> <span class="o">=</span> <span class="n">sample_point</span> <span class="o">-</span> <span class="n">T_center</span>
                <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">t_rel</span><span class="p">,</span><span class="n">t_rel</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
                <span class="c1">#print(dist)</span>

                <span class="n">t_right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">icov</span><span class="p">,</span><span class="n">t_rel</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
                <span class="c1">#print(t_right)</span>

                <span class="n">t2_distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">t_rel</span><span class="p">,</span><span class="n">t_right</span><span class="p">)</span>
                <span class="n">t2_F</span> <span class="o">=</span> <span class="n">t2_distance</span> <span class="o">/</span> <span class="n">Hoetelling_mult</span>
                <span class="n">F_score</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">t2_F</span><span class="p">,</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">)</span>
                <span class="n">F_scores</span> <span class="o">+=</span> <span class="p">[</span><span class="n">F_score</span><span class="p">]</span>

    <span class="n">F_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">F_scores</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">F_scores</span>
<span class="k">def</span> <span class="nf">plot_bootstrap_pls</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">test_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">y_test</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">axes_row</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">train_colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">test_colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="n">num_train</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
    <span class="n">num_test</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">test_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">num_test</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
    <span class="n">num_total</span> <span class="o">=</span> <span class="n">num_train</span> <span class="o">+</span> <span class="n">num_test</span>

    <span class="k">if</span> <span class="n">train_colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">train_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">num_train</span><span class="p">)</span>
        <span class="n">train_colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_colors</span><span class="p">)</span>
        <span class="n">train_colors</span><span class="p">[</span><span class="n">y_train</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span>
    <span class="k">if</span> <span class="n">test_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">test_colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">test_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">num_test</span><span class="p">)</span>
            <span class="n">test_colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_colors</span><span class="p">)</span>
            <span class="n">test_colors</span><span class="p">[</span><span class="n">y_test</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span>

    <span class="n">errbar_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">zorder</span><span class="o">=-</span><span class="mi">100</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#Get the median of the bootstrap data</span>
    <span class="n">train_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#Confidence limits and errorbar widths</span>
    <span class="n">ci_upper_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span><span class="mf">97.5</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ci_lower_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">error_train</span> <span class="o">=</span> <span class="p">(</span><span class="n">ci_upper_train</span> <span class="o">-</span> <span class="n">ci_lower_train</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>

    <span class="k">if</span> <span class="n">test_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">test_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ci_upper_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span><span class="mf">97.5</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ci_lower_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">error_test</span> <span class="o">=</span> <span class="p">(</span><span class="n">ci_upper_test</span> <span class="o">-</span> <span class="n">ci_lower_test</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>

    <span class="c1">#Class boundary value and line formatting</span>
    <span class="n">cv</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">estimate_class_boundary</span><span class="p">(</span><span class="n">train_predict</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
    <span class="n">class_boundary_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">zorder</span><span class="o">=-</span><span class="mi">100</span><span class="p">)</span>

    <span class="c1">#Pearson R value</span>
    <span class="c1">#Pearson R on the test data if available, otherwise on the training data</span>
    <span class="k">if</span> <span class="n">test_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">r</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">test_predict</span><span class="p">)</span>
        <span class="n">residual</span><span class="p">,</span><span class="n">err</span><span class="p">,</span><span class="n">mse</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">get_residual_stats</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">test_predict</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span><span class="n">train_predict</span><span class="p">)</span>
        <span class="n">residual</span><span class="p">,</span><span class="n">err</span><span class="p">,</span><span class="n">mse</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">get_residual_stats</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span><span class="n">train_predict</span><span class="p">)</span>

    <span class="n">r2</span> <span class="o">=</span> <span class="n">r</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">rstring</span> <span class="o">=</span> <span class="s1">&#39;$r^2$ = </span><span class="si">{: 5.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>

    <span class="c1">#Misclassification probabilities and training set confidences</span>
    <span class="n">prob_zero_train</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">get_probabilities</span><span class="p">(</span><span class="n">class_predicted</span><span class="o">=</span><span class="n">train_predict</span><span class="p">,</span><span class="n">data_error</span><span class="o">=</span><span class="n">error_train</span><span class="p">,</span><span class="n">class_value</span><span class="o">=</span><span class="n">cv</span><span class="p">)</span>
    <span class="n">train_assigned</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">train_predict</span><span class="p">)</span>
    <span class="n">train_assigned</span><span class="p">[</span><span class="n">train_predict</span> <span class="o">&gt;</span> <span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">misclass</span><span class="p">,</span><span class="n">misclass_mask_train</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">find_misclassified</span><span class="p">(</span><span class="n">true_class</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span><span class="n">assigned_class</span><span class="o">=</span><span class="n">train_assigned</span><span class="p">)</span>
    <span class="n">train_confidence</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">misclass_probability</span><span class="p">(</span><span class="n">prob_zero_train</span><span class="p">,</span><span class="n">misclass_mask_train</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">test_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">prob_zero</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">get_probabilities</span><span class="p">(</span><span class="n">class_predicted</span><span class="o">=</span><span class="n">test_predict</span><span class="p">,</span><span class="n">data_error</span><span class="o">=</span><span class="n">error_test</span><span class="p">,</span><span class="n">class_value</span><span class="o">=</span><span class="n">cv</span><span class="p">)</span>
        <span class="n">test_assigned</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">test_predict</span><span class="p">)</span>
        <span class="n">test_assigned</span><span class="p">[</span><span class="n">test_predict</span> <span class="o">&gt;</span> <span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">misclass_test</span><span class="p">,</span><span class="n">misclass_mask_test</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">find_misclassified</span><span class="p">(</span><span class="n">true_class</span><span class="o">=</span><span class="n">yt</span><span class="p">,</span><span class="n">assigned_class</span><span class="o">=</span><span class="n">test_assigned</span><span class="p">)</span>
        <span class="n">test_confidence</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">misclass_probability</span><span class="p">(</span><span class="n">prob_zero</span><span class="p">,</span><span class="n">misclass_mask_test</span><span class="p">)</span>

    <span class="n">train_order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">prob_zero_train</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">test_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">test_order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">prob_zero</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">group</span><span class="p">:</span>
        <span class="n">boot_all</span> <span class="o">=</span> <span class="n">train_data</span>
        <span class="n">class_predict</span> <span class="o">=</span> <span class="n">train_predict</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">train_colors</span>
        <span class="k">if</span> <span class="n">test_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">boot_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">boot_all</span><span class="p">,</span><span class="n">test_data</span><span class="p">))</span>
            <span class="n">class_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">class_predict</span><span class="p">,</span><span class="n">test_predict</span><span class="p">))</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">train_colors</span><span class="p">,</span><span class="n">test_colors</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">boot_all</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="n">train_order</span><span class="p">]</span>
        <span class="n">class_predict</span> <span class="o">=</span> <span class="n">train_predict</span><span class="p">[</span><span class="n">train_order</span><span class="p">]</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">train_colors</span><span class="p">[</span><span class="n">train_order</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">test_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">boot_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">boot_all</span><span class="p">,</span><span class="n">test_data</span><span class="p">[</span><span class="n">test_order</span><span class="p">]))</span>
            <span class="n">class_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">class_predict</span><span class="p">,</span><span class="n">test_predict</span><span class="p">[</span><span class="n">test_order</span><span class="p">]))</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">train_colors</span><span class="p">,</span><span class="n">test_colors</span><span class="p">[</span><span class="n">test_order</span><span class="p">]))</span>

    <span class="c1">#Confidence limits on the full set</span>
    <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">boot_all</span><span class="p">,</span><span class="mf">97.5</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ci_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">boot_all</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">error</span> <span class="o">=</span> <span class="p">(</span><span class="n">ci_upper</span> <span class="o">-</span> <span class="n">ci_lower</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>

    <span class="c1">#Split axes</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mcax</span> <span class="o">=</span> <span class="n">axes_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1">#Class value plot</span>

    <span class="c1">#Axis limits for the class value plot</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">num_total</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Predicted class, $XW^*Q^T$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample index (a.u.)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>

    <span class="c1">#Scatter plot and error bar plots for predicted class values</span>
    <span class="n">plsplot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_total</span><span class="p">),</span><span class="n">class_predict</span><span class="p">,</span>
                     <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span><span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

    <span class="n">plserr</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_total</span><span class="p">),</span><span class="n">class_predict</span><span class="p">,</span>
                         <span class="n">yerr</span><span class="o">=</span><span class="n">error</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">errbar_dict</span><span class="p">)</span>
    <span class="n">pls_class_boundaryy</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span><span class="o">**</span><span class="n">class_boundary_dict</span><span class="p">)</span>

    <span class="c1">#Misclassification probability plot</span>
    <span class="n">proby_centerline</span> <span class="o">=</span> <span class="n">mcax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="o">**</span><span class="n">class_boundary_dict</span><span class="p">)</span><span class="c1">#mcax.plot((0.5,0.5),(-1.5,2.5),&#39;k:&#39;)</span>
    <span class="n">class_centerline</span> <span class="o">=</span> <span class="n">mcax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span><span class="o">**</span><span class="n">class_boundary_dict</span><span class="p">)</span> <span class="c1">#mcax.plot((-1,2),(cv,cv),&#39;k:&#39;)</span>

    <span class="c1">#Misclassification probabilities</span>
    <span class="c1">#Training set correct classification</span>

    <span class="n">mcax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">train_confidence</span><span class="p">[</span><span class="o">~</span><span class="n">misclass_mask_train</span><span class="p">],</span>
        <span class="n">train_predict</span><span class="p">[</span><span class="o">~</span><span class="n">misclass_mask_train</span><span class="p">],</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Correct Train&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

    <span class="n">mcax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="mi">1</span><span class="o">-</span><span class="n">train_confidence</span><span class="p">[</span><span class="n">misclass_mask_train</span><span class="p">],</span>
        <span class="n">train_predict</span><span class="p">[</span><span class="n">misclass_mask_train</span><span class="p">],</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Incorrect Train&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">test_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mcax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">test_confidence</span><span class="p">[</span><span class="o">~</span><span class="n">misclass_mask_test</span><span class="p">],</span>
            <span class="n">test_predict</span><span class="p">[</span><span class="o">~</span><span class="n">misclass_mask_test</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Correct Test&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

        <span class="n">mcax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="mi">1</span><span class="o">-</span><span class="n">test_confidence</span><span class="p">[</span><span class="n">misclass_mask_test</span><span class="p">],</span>
            <span class="n">test_predict</span><span class="p">[</span><span class="n">misclass_mask_test</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Incorrect Test&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">mcax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">1.05</span><span class="p">)</span>
    <span class="c1">#mcax.set_ylim(-0.05,1.05)</span>
    <span class="n">mcax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1">#mcax.set_yticks([0,0.5,1])</span>
    <span class="n">mcax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="n">rstring</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">mcax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
    <span class="n">mcax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathsf</span><span class="si">{Pr}</span><span class="s1">_\mathsf</span><span class="si">{misclass}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">nmr_bootstrap_annotate</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
    <span class="c1">#Make the legend</span>
    <span class="n">blue_dot</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],[],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;#4444ff&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Control replicate&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">cyan_dot</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],[],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Control&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">red_dot</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],[],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exposed&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

    <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">blue_dot</span><span class="p">,</span><span class="n">cyan_dot</span><span class="p">,</span><span class="n">red_dot</span><span class="p">],</span><span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">leg</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

    <span class="c1">#Label the groups</span>
    <span class="n">good_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Labels</span><span class="p">)[</span><span class="n">outlier_mask</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">xpos</span><span class="p">,</span><span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">good_labels</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">xpos</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">numspecs</span><span class="p">,</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">xpos</span><span class="o">+</span><span class="mf">0.95</span><span class="p">)</span><span class="o">*</span><span class="n">numspecs</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">misclass_legend</span><span class="p">(</span><span class="n">mcax</span><span class="p">):</span>
    <span class="n">leg</span> <span class="o">=</span> <span class="n">mcax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">scatterpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">framealpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
    <span class="n">leg</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">make_grid_plot</span><span class="p">(</span><span class="n">numrows</span><span class="p">,</span><span class="n">numcols</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">plotsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">column_width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">row_height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                   <span class="n">label_buffers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">ylabel_buffer</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span><span class="n">xlabel_buffer</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                   <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">add_buffer</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">subplots_args</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">plotsize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">column_width</span><span class="p">,</span><span class="n">row_height</span> <span class="o">=</span> <span class="n">plotsize</span>

    <span class="k">if</span> <span class="n">label_buffers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xlabel_buffer</span><span class="p">,</span><span class="n">ylabel_buffer</span> <span class="o">=</span> <span class="n">label_buffers</span>

    <span class="n">full_width</span> <span class="o">=</span> <span class="n">numcols</span><span class="o">*</span><span class="n">column_width</span>
    <span class="n">full_height</span> <span class="o">=</span> <span class="n">numrows</span><span class="o">*</span><span class="n">row_height</span>
    <span class="k">if</span> <span class="n">add_buffer</span><span class="p">:</span>
        <span class="n">full_width</span> <span class="o">=</span> <span class="n">numcols</span><span class="o">*</span><span class="n">column_width</span> <span class="o">+</span> <span class="n">ylabel_buffer</span>
        <span class="n">full_height</span> <span class="o">=</span> <span class="n">numrows</span><span class="o">*</span><span class="n">row_height</span> <span class="o">+</span> <span class="n">xlabel_buffer</span>

    <span class="n">bottom_buffer</span> <span class="o">=</span> <span class="n">xlabel_buffer</span><span class="o">/</span><span class="n">full_height</span>
    <span class="n">left_buffer</span> <span class="o">=</span> <span class="n">ylabel_buffer</span><span class="o">/</span><span class="n">full_width</span>

    <span class="n">ylabel_pos</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">bottom_buffer</span><span class="p">)</span>
    <span class="n">xlabel_pos</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">left_buffer</span><span class="p">)</span>

    <span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="n">full_width</span><span class="p">,</span><span class="n">full_height</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="n">figsize</span>
    <span class="n">fig</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">numrows</span><span class="p">,</span><span class="n">numcols</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="o">**</span><span class="n">subplots_args</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">left_buffer</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="n">bottom_buffer</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ylabel</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ylabel_pos</span><span class="p">,</span><span class="n">ylabel</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xlabel</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xlabel_pos</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">xlabel</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">axes</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Consensus-analysis">
<h2>Consensus analysis<a class="headerlink" href="#Consensus-analysis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Metadata">
<h3>Metadata<a class="headerlink" href="#Metadata" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#X label data for the NMR spectrum</span>
<span class="n">peakPPM_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">9.9975</span><span class="p">,</span> <span class="mf">9.9925</span><span class="p">,</span> <span class="mf">9.9875</span><span class="p">,</span> <span class="mf">9.9825</span><span class="p">,</span> <span class="mf">9.9775</span><span class="p">,</span> <span class="mf">9.9725</span><span class="p">,</span> <span class="mf">9.9675</span><span class="p">,</span> <span class="mf">9.9625</span><span class="p">,</span> <span class="mf">9.9575</span><span class="p">,</span> <span class="mf">9.9525</span><span class="p">,</span> <span class="mf">9.9475</span><span class="p">,</span> <span class="mf">9.9425</span><span class="p">,</span> <span class="mf">9.9375</span><span class="p">,</span> <span class="mf">9.9325</span><span class="p">,</span> <span class="mf">9.9275</span><span class="p">,</span> <span class="mf">9.9225</span><span class="p">,</span> <span class="mf">9.9175</span><span class="p">,</span> <span class="mf">9.9125</span><span class="p">,</span> <span class="mf">9.9075</span><span class="p">,</span> <span class="mf">9.9025</span><span class="p">,</span> <span class="mf">9.8975</span><span class="p">,</span> <span class="mf">9.8925</span><span class="p">,</span> <span class="mf">9.8875</span><span class="p">,</span> <span class="mf">9.8825</span><span class="p">,</span> <span class="mf">9.8775</span><span class="p">,</span> <span class="mf">9.8725</span><span class="p">,</span> <span class="mf">9.8675</span><span class="p">,</span> <span class="mf">9.8625</span><span class="p">,</span> <span class="mf">9.8575</span><span class="p">,</span> <span class="mf">9.8525</span><span class="p">,</span> <span class="mf">9.8475</span><span class="p">,</span> <span class="mf">9.8425</span><span class="p">,</span> <span class="mf">9.8375</span><span class="p">,</span> <span class="mf">9.8325</span><span class="p">,</span> <span class="mf">9.8275</span><span class="p">,</span> <span class="mf">9.8225</span><span class="p">,</span> <span class="mf">9.8175</span><span class="p">,</span> <span class="mf">9.8125</span><span class="p">,</span> <span class="mf">9.8075</span><span class="p">,</span> <span class="mf">9.8025</span><span class="p">,</span> <span class="mf">9.7975</span><span class="p">,</span> <span class="mf">9.7925</span><span class="p">,</span> <span class="mf">9.7875</span><span class="p">,</span> <span class="mf">9.7825</span><span class="p">,</span> <span class="mf">9.7775</span><span class="p">,</span> <span class="mf">9.7725</span><span class="p">,</span> <span class="mf">9.7675</span><span class="p">,</span> <span class="mf">9.7625</span><span class="p">,</span> <span class="mf">9.7575</span><span class="p">,</span> <span class="mf">9.7525</span><span class="p">,</span> <span class="mf">9.7475</span><span class="p">,</span> <span class="mf">9.7425</span><span class="p">,</span> <span class="mf">9.7375</span><span class="p">,</span> <span class="mf">9.7325</span><span class="p">,</span> <span class="mf">9.7275</span><span class="p">,</span> <span class="mf">9.7225</span><span class="p">,</span> <span class="mf">9.7175</span><span class="p">,</span> <span class="mf">9.7125</span><span class="p">,</span> <span class="mf">9.7075</span><span class="p">,</span> <span class="mf">9.7025</span><span class="p">,</span> <span class="mf">9.6975</span><span class="p">,</span> <span class="mf">9.6925</span><span class="p">,</span> <span class="mf">9.6875</span><span class="p">,</span> <span class="mf">9.6825</span><span class="p">,</span> <span class="mf">9.6775</span><span class="p">,</span> <span class="mf">9.6725</span><span class="p">,</span> <span class="mf">9.6675</span><span class="p">,</span> <span class="mf">9.6625</span><span class="p">,</span> <span class="mf">9.6575</span><span class="p">,</span> <span class="mf">9.6525</span><span class="p">,</span> <span class="mf">9.6475</span><span class="p">,</span> <span class="mf">9.6425</span><span class="p">,</span> <span class="mf">9.6375</span><span class="p">,</span> <span class="mf">9.6325</span><span class="p">,</span> <span class="mf">9.6275</span><span class="p">,</span> <span class="mf">9.6225</span><span class="p">,</span> <span class="mf">9.6175</span><span class="p">,</span> <span class="mf">9.6125</span><span class="p">,</span> <span class="mf">9.6075</span><span class="p">,</span> <span class="mf">9.6025</span><span class="p">,</span> <span class="mf">9.5975</span><span class="p">,</span> <span class="mf">9.5925</span><span class="p">,</span> <span class="mf">9.5875</span><span class="p">,</span> <span class="mf">9.5825</span><span class="p">,</span> <span class="mf">9.5775</span><span class="p">,</span> <span class="mf">9.5725</span><span class="p">,</span> <span class="mf">9.5675</span><span class="p">,</span> <span class="mf">9.5625</span><span class="p">,</span> <span class="mf">9.5575</span><span class="p">,</span> <span class="mf">9.5525</span><span class="p">,</span> <span class="mf">9.5475</span><span class="p">,</span> <span class="mf">9.5425</span><span class="p">,</span> <span class="mf">9.5375</span><span class="p">,</span> <span class="mf">9.5325</span><span class="p">,</span> <span class="mf">9.5275</span><span class="p">,</span> <span class="mf">9.5225</span><span class="p">,</span> <span class="mf">9.5175</span><span class="p">,</span> <span class="mf">9.5125</span><span class="p">,</span> <span class="mf">9.5075</span><span class="p">,</span> <span class="mf">9.5025</span><span class="p">,</span> <span class="mf">9.4975</span><span class="p">,</span> <span class="mf">9.4925</span><span class="p">,</span> <span class="mf">9.4875</span><span class="p">,</span> <span class="mf">9.4825</span><span class="p">,</span> <span class="mf">9.4775</span><span class="p">,</span> <span class="mf">9.4725</span><span class="p">,</span> <span class="mf">9.4675</span><span class="p">,</span> <span class="mf">9.4625</span><span class="p">,</span> <span class="mf">9.4575</span><span class="p">,</span> <span class="mf">9.4525</span><span class="p">,</span> <span class="mf">9.4475</span><span class="p">,</span> <span class="mf">9.4425</span><span class="p">,</span> <span class="mf">9.4375</span><span class="p">,</span> <span class="mf">9.4325</span><span class="p">,</span> <span class="mf">9.4275</span><span class="p">,</span> <span class="mf">9.4225</span><span class="p">,</span> <span class="mf">9.4175</span><span class="p">,</span> <span class="mf">9.4125</span><span class="p">,</span> <span class="mf">9.4075</span><span class="p">,</span> <span class="mf">9.4025</span><span class="p">,</span> <span class="mf">9.3975</span><span class="p">,</span> <span class="mf">9.3925</span><span class="p">,</span> <span class="mf">9.3875</span><span class="p">,</span> <span class="mf">9.3825</span><span class="p">,</span> <span class="mf">9.3775</span><span class="p">,</span> <span class="mf">9.3725</span><span class="p">,</span> <span class="mf">9.3675</span><span class="p">,</span> <span class="mf">9.3625</span><span class="p">,</span> <span class="mf">9.3575</span><span class="p">,</span> <span class="mf">9.3525</span><span class="p">,</span> <span class="mf">9.3475</span><span class="p">,</span> <span class="mf">9.3425</span><span class="p">,</span> <span class="mf">9.3375</span><span class="p">,</span> <span class="mf">9.3325</span><span class="p">,</span> <span class="mf">9.3275</span><span class="p">,</span> <span class="mf">9.3225</span><span class="p">,</span> <span class="mf">9.3175</span><span class="p">,</span> <span class="mf">9.3125</span><span class="p">,</span> <span class="mf">9.3075</span><span class="p">,</span> <span class="mf">9.3025</span><span class="p">,</span> <span class="mf">9.2975</span><span class="p">,</span> <span class="mf">9.2925</span><span class="p">,</span> <span class="mf">9.2875</span><span class="p">,</span> <span class="mf">9.2825</span><span class="p">,</span> <span class="mf">9.2775</span><span class="p">,</span> <span class="mf">9.2725</span><span class="p">,</span> <span class="mf">9.2675</span><span class="p">,</span> <span class="mf">9.2625</span><span class="p">,</span> <span class="mf">9.2575</span><span class="p">,</span> <span class="mf">9.2525</span><span class="p">,</span> <span class="mf">9.2475</span><span class="p">,</span> <span class="mf">9.2425</span><span class="p">,</span> <span class="mf">9.2375</span><span class="p">,</span> <span class="mf">9.2325</span><span class="p">,</span> <span class="mf">9.2275</span><span class="p">,</span> <span class="mf">9.2225</span><span class="p">,</span> <span class="mf">9.2175</span><span class="p">,</span> <span class="mf">9.2125</span><span class="p">,</span> <span class="mf">9.2075</span><span class="p">,</span> <span class="mf">9.2025</span><span class="p">,</span> <span class="mf">9.1975</span><span class="p">,</span> <span class="mf">9.1925</span><span class="p">,</span> <span class="mf">9.1875</span><span class="p">,</span> <span class="mf">9.1825</span><span class="p">,</span> <span class="mf">9.1775</span><span class="p">,</span> <span class="mf">9.1725</span><span class="p">,</span> <span class="mf">9.1675</span><span class="p">,</span> <span class="mf">9.1625</span><span class="p">,</span> <span class="mf">9.1575</span><span class="p">,</span> <span class="mf">9.1525</span><span class="p">,</span> <span class="mf">9.1475</span><span class="p">,</span> <span class="mf">9.1425</span><span class="p">,</span> <span class="mf">9.1375</span><span class="p">,</span> <span class="mf">9.1325</span><span class="p">,</span> <span class="mf">9.1275</span><span class="p">,</span> <span class="mf">9.1225</span><span class="p">,</span> <span class="mf">9.1175</span><span class="p">,</span> <span class="mf">9.1125</span><span class="p">,</span> <span class="mf">9.1075</span><span class="p">,</span> <span class="mf">9.1025</span><span class="p">,</span> <span class="mf">9.0975</span><span class="p">,</span> <span class="mf">9.0925</span><span class="p">,</span> <span class="mf">9.0875</span><span class="p">,</span> <span class="mf">9.0825</span><span class="p">,</span> <span class="mf">9.0775</span><span class="p">,</span> <span class="mf">9.0725</span><span class="p">,</span> <span class="mf">9.0675</span><span class="p">,</span> <span class="mf">9.0625</span><span class="p">,</span> <span class="mf">9.0575</span><span class="p">,</span> <span class="mf">9.0525</span><span class="p">,</span> <span class="mf">9.0475</span><span class="p">,</span> <span class="mf">9.0425</span><span class="p">,</span> <span class="mf">9.0375</span><span class="p">,</span> <span class="mf">9.0325</span><span class="p">,</span> <span class="mf">9.0275</span><span class="p">,</span> <span class="mf">9.0225</span><span class="p">,</span> <span class="mf">9.0175</span><span class="p">,</span> <span class="mf">9.0125</span><span class="p">,</span> <span class="mf">9.0075</span><span class="p">,</span> <span class="mf">9.0025</span><span class="p">,</span> <span class="mf">8.9975</span><span class="p">,</span> <span class="mf">8.9925</span><span class="p">,</span> <span class="mf">8.9875</span><span class="p">,</span> <span class="mf">8.9825</span><span class="p">,</span> <span class="mf">8.9775</span><span class="p">,</span> <span class="mf">8.9725</span><span class="p">,</span> <span class="mf">8.9675</span><span class="p">,</span> <span class="mf">8.9625</span><span class="p">,</span> <span class="mf">8.9575</span><span class="p">,</span> <span class="mf">8.9525</span><span class="p">,</span> <span class="mf">8.9475</span><span class="p">,</span> <span class="mf">8.9425</span><span class="p">,</span> <span class="mf">8.9375</span><span class="p">,</span> <span class="mf">8.9325</span><span class="p">,</span> <span class="mf">8.9275</span><span class="p">,</span> <span class="mf">8.9225</span><span class="p">,</span> <span class="mf">8.9175</span><span class="p">,</span> <span class="mf">8.9125</span><span class="p">,</span> <span class="mf">8.9075</span><span class="p">,</span> <span class="mf">8.9025</span><span class="p">,</span> <span class="mf">8.8975</span><span class="p">,</span> <span class="mf">8.8925</span><span class="p">,</span> <span class="mf">8.8875</span><span class="p">,</span> <span class="mf">8.8825</span><span class="p">,</span> <span class="mf">8.8775</span><span class="p">,</span> <span class="mf">8.8725</span><span class="p">,</span> <span class="mf">8.8675</span><span class="p">,</span> <span class="mf">8.8625</span><span class="p">,</span> <span class="mf">8.8575</span><span class="p">,</span> <span class="mf">8.8525</span><span class="p">,</span> <span class="mf">8.8475</span><span class="p">,</span> <span class="mf">8.8425</span><span class="p">,</span> <span class="mf">8.8375</span><span class="p">,</span> <span class="mf">8.8325</span><span class="p">,</span> <span class="mf">8.8275</span><span class="p">,</span> <span class="mf">8.8225</span><span class="p">,</span> <span class="mf">8.8175</span><span class="p">,</span> <span class="mf">8.8125</span><span class="p">,</span> <span class="mf">8.8075</span><span class="p">,</span> <span class="mf">8.8025</span><span class="p">,</span> <span class="mf">8.7975</span><span class="p">,</span> <span class="mf">8.7925</span><span class="p">,</span> <span class="mf">8.7875</span><span class="p">,</span> <span class="mf">8.7825</span><span class="p">,</span> <span class="mf">8.7775</span><span class="p">,</span> <span class="mf">8.7725</span><span class="p">,</span> <span class="mf">8.7675</span><span class="p">,</span> <span class="mf">8.7625</span><span class="p">,</span> <span class="mf">8.7575</span><span class="p">,</span> <span class="mf">8.7525</span><span class="p">,</span> <span class="mf">8.7475</span><span class="p">,</span> <span class="mf">8.7425</span><span class="p">,</span> <span class="mf">8.7375</span><span class="p">,</span> <span class="mf">8.7325</span><span class="p">,</span> <span class="mf">8.7275</span><span class="p">,</span> <span class="mf">8.7225</span><span class="p">,</span> <span class="mf">8.7175</span><span class="p">,</span> <span class="mf">8.7125</span><span class="p">,</span> <span class="mf">8.7075</span><span class="p">,</span> <span class="mf">8.7025</span><span class="p">,</span> <span class="mf">8.6975</span><span class="p">,</span> <span class="mf">8.6925</span><span class="p">,</span> <span class="mf">8.6875</span><span class="p">,</span> <span class="mf">8.6825</span><span class="p">,</span> <span class="mf">8.6775</span><span class="p">,</span> <span class="mf">8.6725</span><span class="p">,</span> <span class="mf">8.6675</span><span class="p">,</span> <span class="mf">8.6625</span><span class="p">,</span> <span class="mf">8.6575</span><span class="p">,</span> <span class="mf">8.6525</span><span class="p">,</span> <span class="mf">8.6475</span><span class="p">,</span> <span class="mf">8.6425</span><span class="p">,</span> <span class="mf">8.6375</span><span class="p">,</span> <span class="mf">8.6325</span><span class="p">,</span> <span class="mf">8.6275</span><span class="p">,</span> <span class="mf">8.6225</span><span class="p">,</span> <span class="mf">8.6175</span><span class="p">,</span> <span class="mf">8.6125</span><span class="p">,</span> <span class="mf">8.6075</span><span class="p">,</span> <span class="mf">8.6025</span><span class="p">,</span> <span class="mf">8.5975</span><span class="p">,</span> <span class="mf">8.5925</span><span class="p">,</span> <span class="mf">8.5875</span><span class="p">,</span> <span class="mf">8.5825</span><span class="p">,</span> <span class="mf">8.5775</span><span class="p">,</span> <span class="mf">8.5725</span><span class="p">,</span> <span class="mf">8.5675</span><span class="p">,</span> <span class="mf">8.5625</span><span class="p">,</span> <span class="mf">8.5575</span><span class="p">,</span> <span class="mf">8.5525</span><span class="p">,</span> <span class="mf">8.5475</span><span class="p">,</span> <span class="mf">8.5425</span><span class="p">,</span> <span class="mf">8.5375</span><span class="p">,</span> <span class="mf">8.5325</span><span class="p">,</span> <span class="mf">8.5275</span><span class="p">,</span> <span class="mf">8.5225</span><span class="p">,</span> <span class="mf">8.5175</span><span class="p">,</span> <span class="mf">8.5125</span><span class="p">,</span> <span class="mf">8.5075</span><span class="p">,</span> <span class="mf">8.5025</span><span class="p">,</span> <span class="mf">8.4975</span><span class="p">,</span> <span class="mf">8.4925</span><span class="p">,</span> <span class="mf">8.4875</span><span class="p">,</span> <span class="mf">8.4825</span><span class="p">,</span> <span class="mf">8.4775</span><span class="p">,</span> <span class="mf">8.4725</span><span class="p">,</span> <span class="mf">8.4675</span><span class="p">,</span> <span class="mf">8.4625</span><span class="p">,</span> <span class="mf">8.4575</span><span class="p">,</span> <span class="mf">8.4525</span><span class="p">,</span> <span class="mf">8.4475</span><span class="p">,</span> <span class="mf">8.4425</span><span class="p">,</span> <span class="mf">8.4375</span><span class="p">,</span> <span class="mf">8.4325</span><span class="p">,</span> <span class="mf">8.4275</span><span class="p">,</span> <span class="mf">8.4225</span><span class="p">,</span> <span class="mf">8.4175</span><span class="p">,</span> <span class="mf">8.4125</span><span class="p">,</span> <span class="mf">8.4075</span><span class="p">,</span> <span class="mf">8.4025</span><span class="p">,</span> <span class="mf">8.3975</span><span class="p">,</span> <span class="mf">8.3925</span><span class="p">,</span> <span class="mf">8.3875</span><span class="p">,</span> <span class="mf">8.3825</span><span class="p">,</span> <span class="mf">8.3775</span><span class="p">,</span> <span class="mf">8.3725</span><span class="p">,</span> <span class="mf">8.3675</span><span class="p">,</span> <span class="mf">8.3625</span><span class="p">,</span> <span class="mf">8.3575</span><span class="p">,</span> <span class="mf">8.3525</span><span class="p">,</span> <span class="mf">8.3475</span><span class="p">,</span> <span class="mf">8.3425</span><span class="p">,</span> <span class="mf">8.3375</span><span class="p">,</span> <span class="mf">8.3325</span><span class="p">,</span> <span class="mf">8.3275</span><span class="p">,</span> <span class="mf">8.3225</span><span class="p">,</span> <span class="mf">8.3175</span><span class="p">,</span> <span class="mf">8.3125</span><span class="p">,</span> <span class="mf">8.3075</span><span class="p">,</span> <span class="mf">8.3025</span><span class="p">,</span> <span class="mf">8.2975</span><span class="p">,</span> <span class="mf">8.2925</span><span class="p">,</span> <span class="mf">8.2875</span><span class="p">,</span> <span class="mf">8.2825</span><span class="p">,</span> <span class="mf">8.2775</span><span class="p">,</span> <span class="mf">8.2725</span><span class="p">,</span> <span class="mf">8.2675</span><span class="p">,</span> <span class="mf">8.2625</span><span class="p">,</span> <span class="mf">8.2575</span><span class="p">,</span> <span class="mf">8.2525</span><span class="p">,</span> <span class="mf">8.2475</span><span class="p">,</span> <span class="mf">8.2425</span><span class="p">,</span> <span class="mf">8.2375</span><span class="p">,</span> <span class="mf">8.2325</span><span class="p">,</span> <span class="mf">8.2275</span><span class="p">,</span> <span class="mf">8.2225</span><span class="p">,</span> <span class="mf">8.2175</span><span class="p">,</span> <span class="mf">8.2125</span><span class="p">,</span> <span class="mf">8.2075</span><span class="p">,</span> <span class="mf">8.2025</span><span class="p">,</span> <span class="mf">8.1975</span><span class="p">,</span> <span class="mf">8.1925</span><span class="p">,</span> <span class="mf">8.1875</span><span class="p">,</span> <span class="mf">8.1825</span><span class="p">,</span> <span class="mf">8.1775</span><span class="p">,</span> <span class="mf">8.1725</span><span class="p">,</span> <span class="mf">8.1675</span><span class="p">,</span> <span class="mf">8.1625</span><span class="p">,</span> <span class="mf">8.1575</span><span class="p">,</span> <span class="mf">8.1525</span><span class="p">,</span> <span class="mf">8.1475</span><span class="p">,</span> <span class="mf">8.1425</span><span class="p">,</span> <span class="mf">8.1375</span><span class="p">,</span> <span class="mf">8.1325</span><span class="p">,</span> <span class="mf">8.1275</span><span class="p">,</span> <span class="mf">8.1225</span><span class="p">,</span> <span class="mf">8.1175</span><span class="p">,</span> <span class="mf">8.1125</span><span class="p">,</span> <span class="mf">8.1075</span><span class="p">,</span> <span class="mf">8.1025</span><span class="p">,</span> <span class="mf">8.0975</span><span class="p">,</span> <span class="mf">8.0925</span><span class="p">,</span> <span class="mf">8.0875</span><span class="p">,</span> <span class="mf">8.0825</span><span class="p">,</span> <span class="mf">8.0775</span><span class="p">,</span> <span class="mf">8.0725</span><span class="p">,</span> <span class="mf">8.0675</span><span class="p">,</span> <span class="mf">8.0625</span><span class="p">,</span> <span class="mf">8.0575</span><span class="p">,</span> <span class="mf">8.0525</span><span class="p">,</span> <span class="mf">8.0475</span><span class="p">,</span> <span class="mf">8.0425</span><span class="p">,</span> <span class="mf">8.0375</span><span class="p">,</span> <span class="mf">8.0325</span><span class="p">,</span> <span class="mf">8.0275</span><span class="p">,</span> <span class="mf">8.0225</span><span class="p">,</span> <span class="mf">8.0175</span><span class="p">,</span> <span class="mf">8.0125</span><span class="p">,</span> <span class="mf">8.0075</span><span class="p">,</span> <span class="mf">8.0025</span><span class="p">,</span> <span class="mf">7.9975</span><span class="p">,</span> <span class="mf">7.9925</span><span class="p">,</span> <span class="mf">7.9875</span><span class="p">,</span> <span class="mf">7.9825</span><span class="p">,</span> <span class="mf">7.9775</span><span class="p">,</span> <span class="mf">7.9725</span><span class="p">,</span> <span class="mf">7.9675</span><span class="p">,</span> <span class="mf">7.9625</span><span class="p">,</span> <span class="mf">7.9575</span><span class="p">,</span> <span class="mf">7.9525</span><span class="p">,</span> <span class="mf">7.9475</span><span class="p">,</span> <span class="mf">7.9425</span><span class="p">,</span> <span class="mf">7.9375</span><span class="p">,</span> <span class="mf">7.9325</span><span class="p">,</span> <span class="mf">7.9275</span><span class="p">,</span> <span class="mf">7.9225</span><span class="p">,</span> <span class="mf">7.9175</span><span class="p">,</span> <span class="mf">7.9125</span><span class="p">,</span> <span class="mf">7.9075</span><span class="p">,</span> <span class="mf">7.9025</span><span class="p">,</span> <span class="mf">7.8975</span><span class="p">,</span> <span class="mf">7.8925</span><span class="p">,</span> <span class="mf">7.8875</span><span class="p">,</span> <span class="mf">7.8825</span><span class="p">,</span> <span class="mf">7.8775</span><span class="p">,</span> <span class="mf">7.8725</span><span class="p">,</span> <span class="mf">7.8675</span><span class="p">,</span> <span class="mf">7.8625</span><span class="p">,</span> <span class="mf">7.8575</span><span class="p">,</span> <span class="mf">7.8525</span><span class="p">,</span> <span class="mf">7.8475</span><span class="p">,</span> <span class="mf">7.8425</span><span class="p">,</span> <span class="mf">7.8375</span><span class="p">,</span> <span class="mf">7.8325</span><span class="p">,</span> <span class="mf">7.8275</span><span class="p">,</span> <span class="mf">7.8225</span><span class="p">,</span> <span class="mf">7.8175</span><span class="p">,</span> <span class="mf">7.8125</span><span class="p">,</span> <span class="mf">7.8075</span><span class="p">,</span> <span class="mf">7.8025</span><span class="p">,</span> <span class="mf">7.7975</span><span class="p">,</span> <span class="mf">7.7925</span><span class="p">,</span> <span class="mf">7.7875</span><span class="p">,</span> <span class="mf">7.7825</span><span class="p">,</span> <span class="mf">7.7775</span><span class="p">,</span> <span class="mf">7.7725</span><span class="p">,</span> <span class="mf">7.7675</span><span class="p">,</span> <span class="mf">7.7625</span><span class="p">,</span> <span class="mf">7.7575</span><span class="p">,</span> <span class="mf">7.7525</span><span class="p">,</span> <span class="mf">7.7475</span><span class="p">,</span> <span class="mf">7.7425</span><span class="p">,</span> <span class="mf">7.7375</span><span class="p">,</span> <span class="mf">7.7325</span><span class="p">,</span> <span class="mf">7.7275</span><span class="p">,</span> <span class="mf">7.7225</span><span class="p">,</span> <span class="mf">7.7175</span><span class="p">,</span> <span class="mf">7.7125</span><span class="p">,</span> <span class="mf">7.7075</span><span class="p">,</span> <span class="mf">7.7025</span><span class="p">,</span> <span class="mf">7.6975</span><span class="p">,</span> <span class="mf">7.6925</span><span class="p">,</span> <span class="mf">7.6875</span><span class="p">,</span> <span class="mf">7.6825</span><span class="p">,</span> <span class="mf">7.6775</span><span class="p">,</span> <span class="mf">7.6725</span><span class="p">,</span> <span class="mf">7.6675</span><span class="p">,</span> <span class="mf">7.6625</span><span class="p">,</span> <span class="mf">7.6575</span><span class="p">,</span> <span class="mf">7.6525</span><span class="p">,</span> <span class="mf">7.6475</span><span class="p">,</span> <span class="mf">7.6425</span><span class="p">,</span> <span class="mf">7.6375</span><span class="p">,</span> <span class="mf">7.6325</span><span class="p">,</span> <span class="mf">7.6275</span><span class="p">,</span> <span class="mf">7.6225</span><span class="p">,</span> <span class="mf">7.6175</span><span class="p">,</span> <span class="mf">7.6125</span><span class="p">,</span> <span class="mf">7.6075</span><span class="p">,</span> <span class="mf">7.6025</span><span class="p">,</span> <span class="mf">7.5975</span><span class="p">,</span> <span class="mf">7.5925</span><span class="p">,</span> <span class="mf">7.5875</span><span class="p">,</span> <span class="mf">7.5825</span><span class="p">,</span> <span class="mf">7.5775</span><span class="p">,</span> <span class="mf">7.5725</span><span class="p">,</span> <span class="mf">7.5675</span><span class="p">,</span> <span class="mf">7.5625</span><span class="p">,</span> <span class="mf">7.5575</span><span class="p">,</span> <span class="mf">7.5525</span><span class="p">,</span> <span class="mf">7.5475</span><span class="p">,</span> <span class="mf">7.5425</span><span class="p">,</span> <span class="mf">7.5375</span><span class="p">,</span> <span class="mf">7.5325</span><span class="p">,</span> <span class="mf">7.5275</span><span class="p">,</span> <span class="mf">7.5225</span><span class="p">,</span> <span class="mf">7.5175</span><span class="p">,</span> <span class="mf">7.5125</span><span class="p">,</span> <span class="mf">7.5075</span><span class="p">,</span> <span class="mf">7.5025</span><span class="p">,</span> <span class="mf">7.4975</span><span class="p">,</span> <span class="mf">7.4925</span><span class="p">,</span> <span class="mf">7.4875</span><span class="p">,</span> <span class="mf">7.4825</span><span class="p">,</span> <span class="mf">7.4775</span><span class="p">,</span> <span class="mf">7.4725</span><span class="p">,</span> <span class="mf">7.4675</span><span class="p">,</span> <span class="mf">7.4625</span><span class="p">,</span> <span class="mf">7.4575</span><span class="p">,</span> <span class="mf">7.4525</span><span class="p">,</span> <span class="mf">7.4475</span><span class="p">,</span> <span class="mf">7.4425</span><span class="p">,</span> <span class="mf">7.4375</span><span class="p">,</span> <span class="mf">7.4325</span><span class="p">,</span> <span class="mf">7.4275</span><span class="p">,</span> <span class="mf">7.4225</span><span class="p">,</span> <span class="mf">7.4175</span><span class="p">,</span> <span class="mf">7.4125</span><span class="p">,</span> <span class="mf">7.4075</span><span class="p">,</span> <span class="mf">7.4025</span><span class="p">,</span> <span class="mf">7.3975</span><span class="p">,</span> <span class="mf">7.3925</span><span class="p">,</span> <span class="mf">7.3875</span><span class="p">,</span> <span class="mf">7.3825</span><span class="p">,</span> <span class="mf">7.3775</span><span class="p">,</span> <span class="mf">7.3725</span><span class="p">,</span> <span class="mf">7.3675</span><span class="p">,</span> <span class="mf">7.3625</span><span class="p">,</span> <span class="mf">7.3575</span><span class="p">,</span> <span class="mf">7.3525</span><span class="p">,</span> <span class="mf">7.3475</span><span class="p">,</span> <span class="mf">7.3425</span><span class="p">,</span> <span class="mf">7.3375</span><span class="p">,</span> <span class="mf">7.3325</span><span class="p">,</span> <span class="mf">7.3275</span><span class="p">,</span> <span class="mf">7.3225</span><span class="p">,</span> <span class="mf">7.3175</span><span class="p">,</span> <span class="mf">7.3125</span><span class="p">,</span> <span class="mf">7.3075</span><span class="p">,</span> <span class="mf">7.3025</span><span class="p">,</span> <span class="mf">7.2975</span><span class="p">,</span> <span class="mf">7.2925</span><span class="p">,</span> <span class="mf">7.2875</span><span class="p">,</span> <span class="mf">7.2825</span><span class="p">,</span> <span class="mf">7.2775</span><span class="p">,</span> <span class="mf">7.2725</span><span class="p">,</span> <span class="mf">7.2675</span><span class="p">,</span> <span class="mf">7.2625</span><span class="p">,</span> <span class="mf">7.2575</span><span class="p">,</span> <span class="mf">7.2525</span><span class="p">,</span> <span class="mf">7.2475</span><span class="p">,</span> <span class="mf">7.2425</span><span class="p">,</span> <span class="mf">7.2375</span><span class="p">,</span> <span class="mf">7.2325</span><span class="p">,</span> <span class="mf">7.2275</span><span class="p">,</span> <span class="mf">7.2225</span><span class="p">,</span> <span class="mf">7.2175</span><span class="p">,</span> <span class="mf">7.2125</span><span class="p">,</span> <span class="mf">7.2075</span><span class="p">,</span> <span class="mf">7.2025</span><span class="p">,</span> <span class="mf">7.1975</span><span class="p">,</span> <span class="mf">7.1925</span><span class="p">,</span> <span class="mf">7.1875</span><span class="p">,</span> <span class="mf">7.1825</span><span class="p">,</span> <span class="mf">7.1775</span><span class="p">,</span> <span class="mf">7.1725</span><span class="p">,</span> <span class="mf">7.1675</span><span class="p">,</span> <span class="mf">7.1625</span><span class="p">,</span> <span class="mf">7.1575</span><span class="p">,</span> <span class="mf">7.1525</span><span class="p">,</span> <span class="mf">7.1475</span><span class="p">,</span> <span class="mf">7.1425</span><span class="p">,</span> <span class="mf">7.1375</span><span class="p">,</span> <span class="mf">7.1325</span><span class="p">,</span> <span class="mf">7.1275</span><span class="p">,</span> <span class="mf">7.1225</span><span class="p">,</span> <span class="mf">7.1175</span><span class="p">,</span> <span class="mf">7.1125</span><span class="p">,</span> <span class="mf">7.1075</span><span class="p">,</span> <span class="mf">7.1025</span><span class="p">,</span> <span class="mf">7.0975</span><span class="p">,</span> <span class="mf">7.0925</span><span class="p">,</span> <span class="mf">7.0875</span><span class="p">,</span> <span class="mf">7.0825</span><span class="p">,</span> <span class="mf">7.0775</span><span class="p">,</span> <span class="mf">7.0725</span><span class="p">,</span> <span class="mf">7.0675</span><span class="p">,</span> <span class="mf">7.0625</span><span class="p">,</span> <span class="mf">7.0575</span><span class="p">,</span> <span class="mf">7.0525</span><span class="p">,</span> <span class="mf">7.0475</span><span class="p">,</span> <span class="mf">7.0425</span><span class="p">,</span> <span class="mf">7.0375</span><span class="p">,</span> <span class="mf">7.0325</span><span class="p">,</span> <span class="mf">7.0275</span><span class="p">,</span> <span class="mf">7.0225</span><span class="p">,</span> <span class="mf">7.0175</span><span class="p">,</span> <span class="mf">7.0125</span><span class="p">,</span> <span class="mf">7.0075</span><span class="p">,</span> <span class="mf">7.0025</span><span class="p">,</span> <span class="mf">6.9975</span><span class="p">,</span> <span class="mf">6.9925</span><span class="p">,</span> <span class="mf">6.9875</span><span class="p">,</span> <span class="mf">6.9825</span><span class="p">,</span> <span class="mf">6.9775</span><span class="p">,</span> <span class="mf">6.9725</span><span class="p">,</span> <span class="mf">6.9675</span><span class="p">,</span> <span class="mf">6.9625</span><span class="p">,</span> <span class="mf">6.9575</span><span class="p">,</span> <span class="mf">6.9525</span><span class="p">,</span> <span class="mf">6.9475</span><span class="p">,</span> <span class="mf">6.9425</span><span class="p">,</span> <span class="mf">6.9375</span><span class="p">,</span> <span class="mf">6.9325</span><span class="p">,</span> <span class="mf">6.9275</span><span class="p">,</span> <span class="mf">6.9225</span><span class="p">,</span> <span class="mf">6.9175</span><span class="p">,</span> <span class="mf">6.9125</span><span class="p">,</span> <span class="mf">6.9075</span><span class="p">,</span> <span class="mf">6.9025</span><span class="p">,</span> <span class="mf">6.8975</span><span class="p">,</span> <span class="mf">6.8925</span><span class="p">,</span> <span class="mf">6.8875</span><span class="p">,</span> <span class="mf">6.8825</span><span class="p">,</span> <span class="mf">6.8775</span><span class="p">,</span> <span class="mf">6.8725</span><span class="p">,</span> <span class="mf">6.8675</span><span class="p">,</span> <span class="mf">6.8625</span><span class="p">,</span> <span class="mf">6.8575</span><span class="p">,</span> <span class="mf">6.8525</span><span class="p">,</span> <span class="mf">6.8475</span><span class="p">,</span> <span class="mf">6.8425</span><span class="p">,</span> <span class="mf">6.8375</span><span class="p">,</span> <span class="mf">6.8325</span><span class="p">,</span> <span class="mf">6.8275</span><span class="p">,</span> <span class="mf">6.8225</span><span class="p">,</span> <span class="mf">6.8175</span><span class="p">,</span> <span class="mf">6.8125</span><span class="p">,</span> <span class="mf">6.8075</span><span class="p">,</span> <span class="mf">6.8025</span><span class="p">,</span> <span class="mf">6.7975</span><span class="p">,</span> <span class="mf">6.7925</span><span class="p">,</span> <span class="mf">6.7875</span><span class="p">,</span> <span class="mf">6.7825</span><span class="p">,</span> <span class="mf">6.7775</span><span class="p">,</span> <span class="mf">6.7725</span><span class="p">,</span> <span class="mf">6.7675</span><span class="p">,</span> <span class="mf">6.7625</span><span class="p">,</span> <span class="mf">6.7575</span><span class="p">,</span> <span class="mf">6.7525</span><span class="p">,</span> <span class="mf">6.7475</span><span class="p">,</span> <span class="mf">6.7425</span><span class="p">,</span> <span class="mf">6.7375</span><span class="p">,</span> <span class="mf">6.7325</span><span class="p">,</span> <span class="mf">6.7275</span><span class="p">,</span> <span class="mf">6.7225</span><span class="p">,</span> <span class="mf">6.7175</span><span class="p">,</span> <span class="mf">6.7125</span><span class="p">,</span> <span class="mf">6.7075</span><span class="p">,</span> <span class="mf">6.7025</span><span class="p">,</span> <span class="mf">6.6975</span><span class="p">,</span> <span class="mf">6.6925</span><span class="p">,</span> <span class="mf">6.6875</span><span class="p">,</span> <span class="mf">6.6825</span><span class="p">,</span> <span class="mf">6.6775</span><span class="p">,</span> <span class="mf">6.6725</span><span class="p">,</span> <span class="mf">6.6675</span><span class="p">,</span> <span class="mf">6.6625</span><span class="p">,</span> <span class="mf">6.6575</span><span class="p">,</span> <span class="mf">6.6525</span><span class="p">,</span> <span class="mf">6.6475</span><span class="p">,</span> <span class="mf">6.6425</span><span class="p">,</span> <span class="mf">6.6375</span><span class="p">,</span> <span class="mf">6.6325</span><span class="p">,</span> <span class="mf">6.6275</span><span class="p">,</span> <span class="mf">6.6225</span><span class="p">,</span> <span class="mf">6.6175</span><span class="p">,</span> <span class="mf">6.6125</span><span class="p">,</span> <span class="mf">6.6075</span><span class="p">,</span> <span class="mf">6.6025</span><span class="p">,</span> <span class="mf">6.5975</span><span class="p">,</span> <span class="mf">6.5925</span><span class="p">,</span> <span class="mf">6.5875</span><span class="p">,</span> <span class="mf">6.5825</span><span class="p">,</span> <span class="mf">6.5775</span><span class="p">,</span> <span class="mf">6.5725</span><span class="p">,</span> <span class="mf">6.5675</span><span class="p">,</span> <span class="mf">6.5625</span><span class="p">,</span> <span class="mf">6.5575</span><span class="p">,</span> <span class="mf">6.5525</span><span class="p">,</span> <span class="mf">6.5475</span><span class="p">,</span> <span class="mf">6.5425</span><span class="p">,</span> <span class="mf">6.5375</span><span class="p">,</span> <span class="mf">6.5325</span><span class="p">,</span> <span class="mf">6.5275</span><span class="p">,</span> <span class="mf">6.5225</span><span class="p">,</span> <span class="mf">6.5175</span><span class="p">,</span> <span class="mf">6.5125</span><span class="p">,</span> <span class="mf">6.5075</span><span class="p">,</span> <span class="mf">6.5025</span><span class="p">,</span> <span class="mf">6.4975</span><span class="p">,</span> <span class="mf">6.4925</span><span class="p">,</span> <span class="mf">6.4875</span><span class="p">,</span> <span class="mf">6.4825</span><span class="p">,</span> <span class="mf">6.4775</span><span class="p">,</span> <span class="mf">6.4725</span><span class="p">,</span> <span class="mf">6.4675</span><span class="p">,</span> <span class="mf">6.4625</span><span class="p">,</span> <span class="mf">6.4575</span><span class="p">,</span> <span class="mf">6.4525</span><span class="p">,</span> <span class="mf">6.4475</span><span class="p">,</span> <span class="mf">6.4425</span><span class="p">,</span> <span class="mf">6.4375</span><span class="p">,</span> <span class="mf">6.4325</span><span class="p">,</span> <span class="mf">6.4275</span><span class="p">,</span> <span class="mf">6.4225</span><span class="p">,</span> <span class="mf">6.4175</span><span class="p">,</span> <span class="mf">6.4125</span><span class="p">,</span> <span class="mf">6.4075</span><span class="p">,</span> <span class="mf">6.4025</span><span class="p">,</span> <span class="mf">6.3975</span><span class="p">,</span> <span class="mf">6.3925</span><span class="p">,</span> <span class="mf">6.3875</span><span class="p">,</span> <span class="mf">6.3825</span><span class="p">,</span> <span class="mf">6.3775</span><span class="p">,</span> <span class="mf">6.3725</span><span class="p">,</span> <span class="mf">6.3675</span><span class="p">,</span> <span class="mf">6.3625</span><span class="p">,</span> <span class="mf">6.3575</span><span class="p">,</span> <span class="mf">6.3525</span><span class="p">,</span> <span class="mf">6.3475</span><span class="p">,</span> <span class="mf">6.3425</span><span class="p">,</span> <span class="mf">6.3375</span><span class="p">,</span> <span class="mf">6.3325</span><span class="p">,</span> <span class="mf">6.3275</span><span class="p">,</span> <span class="mf">6.3225</span><span class="p">,</span> <span class="mf">6.3175</span><span class="p">,</span> <span class="mf">6.3125</span><span class="p">,</span> <span class="mf">6.3075</span><span class="p">,</span> <span class="mf">6.3025</span><span class="p">,</span> <span class="mf">6.2975</span><span class="p">,</span> <span class="mf">6.2925</span><span class="p">,</span> <span class="mf">6.2875</span><span class="p">,</span> <span class="mf">6.2825</span><span class="p">,</span> <span class="mf">6.2775</span><span class="p">,</span> <span class="mf">6.2725</span><span class="p">,</span> <span class="mf">6.2675</span><span class="p">,</span> <span class="mf">6.2625</span><span class="p">,</span> <span class="mf">6.2575</span><span class="p">,</span> <span class="mf">6.2525</span><span class="p">,</span> <span class="mf">6.2475</span><span class="p">,</span> <span class="mf">6.2425</span><span class="p">,</span> <span class="mf">6.2375</span><span class="p">,</span> <span class="mf">6.2325</span><span class="p">,</span> <span class="mf">6.2275</span><span class="p">,</span> <span class="mf">6.2225</span><span class="p">,</span> <span class="mf">6.2175</span><span class="p">,</span> <span class="mf">6.2125</span><span class="p">,</span> <span class="mf">6.2075</span><span class="p">,</span> <span class="mf">6.2025</span><span class="p">,</span> <span class="mf">6.1975</span><span class="p">,</span> <span class="mf">6.1925</span><span class="p">,</span> <span class="mf">6.1875</span><span class="p">,</span> <span class="mf">6.1825</span><span class="p">,</span> <span class="mf">6.1775</span><span class="p">,</span> <span class="mf">6.1725</span><span class="p">,</span> <span class="mf">6.1675</span><span class="p">,</span> <span class="mf">6.1625</span><span class="p">,</span> <span class="mf">6.1575</span><span class="p">,</span> <span class="mf">6.1525</span><span class="p">,</span> <span class="mf">6.1475</span><span class="p">,</span> <span class="mf">6.1425</span><span class="p">,</span> <span class="mf">6.1375</span><span class="p">,</span> <span class="mf">6.1325</span><span class="p">,</span> <span class="mf">6.1275</span><span class="p">,</span> <span class="mf">6.1225</span><span class="p">,</span> <span class="mf">6.1175</span><span class="p">,</span> <span class="mf">6.1125</span><span class="p">,</span> <span class="mf">6.1075</span><span class="p">,</span> <span class="mf">6.1025</span><span class="p">,</span> <span class="mf">6.0975</span><span class="p">,</span> <span class="mf">6.0925</span><span class="p">,</span> <span class="mf">6.0875</span><span class="p">,</span> <span class="mf">6.0825</span><span class="p">,</span> <span class="mf">6.0775</span><span class="p">,</span> <span class="mf">6.0725</span><span class="p">,</span> <span class="mf">6.0675</span><span class="p">,</span> <span class="mf">6.0625</span><span class="p">,</span> <span class="mf">6.0575</span><span class="p">,</span> <span class="mf">6.0525</span><span class="p">,</span> <span class="mf">6.0475</span><span class="p">,</span> <span class="mf">6.0425</span><span class="p">,</span> <span class="mf">6.0375</span><span class="p">,</span> <span class="mf">6.0325</span><span class="p">,</span> <span class="mf">6.0275</span><span class="p">,</span> <span class="mf">6.0225</span><span class="p">,</span> <span class="mf">6.0175</span><span class="p">,</span> <span class="mf">6.0125</span><span class="p">,</span> <span class="mf">6.0075</span><span class="p">,</span> <span class="mf">6.0025</span><span class="p">,</span> <span class="mf">5.9975</span><span class="p">,</span> <span class="mf">5.9925</span><span class="p">,</span> <span class="mf">5.9875</span><span class="p">,</span> <span class="mf">5.9825</span><span class="p">,</span> <span class="mf">5.9775</span><span class="p">,</span> <span class="mf">5.9725</span><span class="p">,</span> <span class="mf">5.9675</span><span class="p">,</span> <span class="mf">5.9625</span><span class="p">,</span> <span class="mf">5.9575</span><span class="p">,</span> <span class="mf">5.9525</span><span class="p">,</span> <span class="mf">5.9475</span><span class="p">,</span> <span class="mf">5.9425</span><span class="p">,</span> <span class="mf">5.9375</span><span class="p">,</span> <span class="mf">5.9325</span><span class="p">,</span> <span class="mf">5.9275</span><span class="p">,</span> <span class="mf">5.9225</span><span class="p">,</span> <span class="mf">5.9175</span><span class="p">,</span> <span class="mf">5.9125</span><span class="p">,</span> <span class="mf">5.9075</span><span class="p">,</span> <span class="mf">5.9025</span><span class="p">,</span> <span class="mf">5.8975</span><span class="p">,</span> <span class="mf">5.8925</span><span class="p">,</span> <span class="mf">5.8875</span><span class="p">,</span> <span class="mf">5.8825</span><span class="p">,</span> <span class="mf">5.8775</span><span class="p">,</span> <span class="mf">5.8725</span><span class="p">,</span> <span class="mf">5.8675</span><span class="p">,</span> <span class="mf">5.8625</span><span class="p">,</span> <span class="mf">5.8575</span><span class="p">,</span> <span class="mf">5.8525</span><span class="p">,</span> <span class="mf">5.8475</span><span class="p">,</span> <span class="mf">5.8425</span><span class="p">,</span> <span class="mf">5.8375</span><span class="p">,</span> <span class="mf">5.8325</span><span class="p">,</span> <span class="mf">5.8275</span><span class="p">,</span> <span class="mf">5.8225</span><span class="p">,</span> <span class="mf">5.8175</span><span class="p">,</span> <span class="mf">5.8125</span><span class="p">,</span> <span class="mf">5.8075</span><span class="p">,</span> <span class="mf">5.8025</span><span class="p">,</span> <span class="mf">5.7975</span><span class="p">,</span> <span class="mf">5.7925</span><span class="p">,</span> <span class="mf">5.7875</span><span class="p">,</span> <span class="mf">5.7825</span><span class="p">,</span> <span class="mf">5.7775</span><span class="p">,</span> <span class="mf">5.7725</span><span class="p">,</span> <span class="mf">5.7675</span><span class="p">,</span> <span class="mf">5.7625</span><span class="p">,</span> <span class="mf">5.7575</span><span class="p">,</span> <span class="mf">5.7525</span><span class="p">,</span> <span class="mf">5.7475</span><span class="p">,</span> <span class="mf">5.7425</span><span class="p">,</span> <span class="mf">5.7375</span><span class="p">,</span> <span class="mf">5.7325</span><span class="p">,</span> <span class="mf">5.7275</span><span class="p">,</span> <span class="mf">5.7225</span><span class="p">,</span> <span class="mf">5.7175</span><span class="p">,</span> <span class="mf">5.7125</span><span class="p">,</span> <span class="mf">5.7075</span><span class="p">,</span> <span class="mf">5.7025</span><span class="p">,</span> <span class="mf">5.6975</span><span class="p">,</span> <span class="mf">5.6925</span><span class="p">,</span> <span class="mf">5.6875</span><span class="p">,</span> <span class="mf">5.6825</span><span class="p">,</span> <span class="mf">5.6775</span><span class="p">,</span> <span class="mf">5.6725</span><span class="p">,</span> <span class="mf">5.6675</span><span class="p">,</span> <span class="mf">5.6625</span><span class="p">,</span> <span class="mf">5.6575</span><span class="p">,</span> <span class="mf">5.6525</span><span class="p">,</span> <span class="mf">5.6475</span><span class="p">,</span> <span class="mf">5.6425</span><span class="p">,</span> <span class="mf">5.6375</span><span class="p">,</span> <span class="mf">5.6325</span><span class="p">,</span> <span class="mf">5.6275</span><span class="p">,</span> <span class="mf">5.6225</span><span class="p">,</span> <span class="mf">5.6175</span><span class="p">,</span> <span class="mf">5.6125</span><span class="p">,</span> <span class="mf">5.6075</span><span class="p">,</span> <span class="mf">5.6025</span><span class="p">,</span> <span class="mf">5.5975</span><span class="p">,</span> <span class="mf">5.5925</span><span class="p">,</span> <span class="mf">5.5875</span><span class="p">,</span> <span class="mf">5.5825</span><span class="p">,</span> <span class="mf">5.5775</span><span class="p">,</span> <span class="mf">5.5725</span><span class="p">,</span> <span class="mf">5.5675</span><span class="p">,</span> <span class="mf">5.5625</span><span class="p">,</span> <span class="mf">5.5575</span><span class="p">,</span> <span class="mf">5.5525</span><span class="p">,</span> <span class="mf">5.5475</span><span class="p">,</span> <span class="mf">5.5425</span><span class="p">,</span> <span class="mf">5.5375</span><span class="p">,</span> <span class="mf">5.5325</span><span class="p">,</span> <span class="mf">5.5275</span><span class="p">,</span> <span class="mf">5.5225</span><span class="p">,</span> <span class="mf">5.5175</span><span class="p">,</span> <span class="mf">5.5125</span><span class="p">,</span> <span class="mf">5.5075</span><span class="p">,</span> <span class="mf">5.5025</span><span class="p">,</span> <span class="mf">5.4975</span><span class="p">,</span> <span class="mf">5.4925</span><span class="p">,</span> <span class="mf">5.4875</span><span class="p">,</span> <span class="mf">5.4825</span><span class="p">,</span> <span class="mf">5.4775</span><span class="p">,</span> <span class="mf">5.4725</span><span class="p">,</span> <span class="mf">5.4675</span><span class="p">,</span> <span class="mf">5.4625</span><span class="p">,</span> <span class="mf">5.4575</span><span class="p">,</span> <span class="mf">5.4525</span><span class="p">,</span> <span class="mf">5.4475</span><span class="p">,</span> <span class="mf">5.4425</span><span class="p">,</span> <span class="mf">5.4375</span><span class="p">,</span> <span class="mf">5.4325</span><span class="p">,</span> <span class="mf">5.4275</span><span class="p">,</span> <span class="mf">5.4225</span><span class="p">,</span> <span class="mf">5.4175</span><span class="p">,</span> <span class="mf">5.4125</span><span class="p">,</span> <span class="mf">5.4075</span><span class="p">,</span> <span class="mf">5.4025</span><span class="p">,</span> <span class="mf">5.3975</span><span class="p">,</span> <span class="mf">5.3925</span><span class="p">,</span> <span class="mf">5.3875</span><span class="p">,</span> <span class="mf">5.3825</span><span class="p">,</span> <span class="mf">5.3775</span><span class="p">,</span> <span class="mf">5.3725</span><span class="p">,</span> <span class="mf">5.3675</span><span class="p">,</span> <span class="mf">5.3625</span><span class="p">,</span> <span class="mf">5.3575</span><span class="p">,</span> <span class="mf">5.3525</span><span class="p">,</span> <span class="mf">5.3475</span><span class="p">,</span> <span class="mf">5.3425</span><span class="p">,</span> <span class="mf">5.3375</span><span class="p">,</span> <span class="mf">5.3325</span><span class="p">,</span> <span class="mf">5.3275</span><span class="p">,</span> <span class="mf">5.3225</span><span class="p">,</span> <span class="mf">5.3175</span><span class="p">,</span> <span class="mf">5.3125</span><span class="p">,</span> <span class="mf">5.3075</span><span class="p">,</span> <span class="mf">5.3025</span><span class="p">,</span> <span class="mf">5.2975</span><span class="p">,</span> <span class="mf">5.2925</span><span class="p">,</span> <span class="mf">5.2875</span><span class="p">,</span> <span class="mf">5.2825</span><span class="p">,</span> <span class="mf">5.2775</span><span class="p">,</span> <span class="mf">5.2725</span><span class="p">,</span> <span class="mf">5.2675</span><span class="p">,</span> <span class="mf">5.2625</span><span class="p">,</span> <span class="mf">5.2575</span><span class="p">,</span> <span class="mf">5.2525</span><span class="p">,</span> <span class="mf">5.2475</span><span class="p">,</span> <span class="mf">5.2425</span><span class="p">,</span> <span class="mf">5.2375</span><span class="p">,</span> <span class="mf">5.2325</span><span class="p">,</span> <span class="mf">5.2275</span><span class="p">,</span> <span class="mf">5.2225</span><span class="p">,</span> <span class="mf">5.2175</span><span class="p">,</span> <span class="mf">5.2125</span><span class="p">,</span> <span class="mf">5.2075</span><span class="p">,</span> <span class="mf">5.2025</span><span class="p">,</span> <span class="mf">4.6975</span><span class="p">,</span> <span class="mf">4.6925</span><span class="p">,</span> <span class="mf">4.6875</span><span class="p">,</span> <span class="mf">4.6825</span><span class="p">,</span> <span class="mf">4.6775</span><span class="p">,</span> <span class="mf">4.6725</span><span class="p">,</span> <span class="mf">4.6675</span><span class="p">,</span> <span class="mf">4.6625</span><span class="p">,</span> <span class="mf">4.6575</span><span class="p">,</span> <span class="mf">4.6525</span><span class="p">,</span> <span class="mf">4.6475</span><span class="p">,</span> <span class="mf">4.6425</span><span class="p">,</span> <span class="mf">4.6375</span><span class="p">,</span> <span class="mf">4.6325</span><span class="p">,</span> <span class="mf">4.6275</span><span class="p">,</span> <span class="mf">4.6225</span><span class="p">,</span> <span class="mf">4.6175</span><span class="p">,</span> <span class="mf">4.6125</span><span class="p">,</span> <span class="mf">4.6075</span><span class="p">,</span> <span class="mf">4.6025</span><span class="p">,</span> <span class="mf">4.5975</span><span class="p">,</span> <span class="mf">4.5925</span><span class="p">,</span> <span class="mf">4.5875</span><span class="p">,</span> <span class="mf">4.5825</span><span class="p">,</span> <span class="mf">4.5775</span><span class="p">,</span> <span class="mf">4.5725</span><span class="p">,</span> <span class="mf">4.5675</span><span class="p">,</span> <span class="mf">4.5625</span><span class="p">,</span> <span class="mf">4.5575</span><span class="p">,</span> <span class="mf">4.5525</span><span class="p">,</span> <span class="mf">4.5475</span><span class="p">,</span> <span class="mf">4.5425</span><span class="p">,</span> <span class="mf">4.5375</span><span class="p">,</span> <span class="mf">4.5325</span><span class="p">,</span> <span class="mf">4.5275</span><span class="p">,</span> <span class="mf">4.5225</span><span class="p">,</span> <span class="mf">4.5175</span><span class="p">,</span> <span class="mf">4.5125</span><span class="p">,</span> <span class="mf">4.5075</span><span class="p">,</span> <span class="mf">4.5025</span><span class="p">,</span> <span class="mf">4.4975</span><span class="p">,</span> <span class="mf">4.4925</span><span class="p">,</span> <span class="mf">4.4875</span><span class="p">,</span> <span class="mf">4.4825</span><span class="p">,</span> <span class="mf">4.4775</span><span class="p">,</span> <span class="mf">4.4725</span><span class="p">,</span> <span class="mf">4.4675</span><span class="p">,</span> <span class="mf">4.4625</span><span class="p">,</span> <span class="mf">4.4575</span><span class="p">,</span> <span class="mf">4.4525</span><span class="p">,</span> <span class="mf">4.4475</span><span class="p">,</span> <span class="mf">4.4425</span><span class="p">,</span> <span class="mf">4.4375</span><span class="p">,</span> <span class="mf">4.4325</span><span class="p">,</span> <span class="mf">4.4275</span><span class="p">,</span> <span class="mf">4.4225</span><span class="p">,</span> <span class="mf">4.4175</span><span class="p">,</span> <span class="mf">4.4125</span><span class="p">,</span> <span class="mf">4.4075</span><span class="p">,</span> <span class="mf">4.4025</span><span class="p">,</span> <span class="mf">4.3975</span><span class="p">,</span> <span class="mf">4.3925</span><span class="p">,</span> <span class="mf">4.3875</span><span class="p">,</span> <span class="mf">4.3825</span><span class="p">,</span> <span class="mf">4.3775</span><span class="p">,</span> <span class="mf">4.3725</span><span class="p">,</span> <span class="mf">4.3675</span><span class="p">,</span> <span class="mf">4.3625</span><span class="p">,</span> <span class="mf">4.3575</span><span class="p">,</span> <span class="mf">4.3525</span><span class="p">,</span> <span class="mf">4.3475</span><span class="p">,</span> <span class="mf">4.3425</span><span class="p">,</span> <span class="mf">4.3375</span><span class="p">,</span> <span class="mf">4.3325</span><span class="p">,</span> <span class="mf">4.3275</span><span class="p">,</span> <span class="mf">4.3225</span><span class="p">,</span> <span class="mf">4.3175</span><span class="p">,</span> <span class="mf">4.3125</span><span class="p">,</span> <span class="mf">4.3075</span><span class="p">,</span> <span class="mf">4.3025</span><span class="p">,</span> <span class="mf">4.2975</span><span class="p">,</span> <span class="mf">4.2925</span><span class="p">,</span> <span class="mf">4.2875</span><span class="p">,</span> <span class="mf">4.2825</span><span class="p">,</span> <span class="mf">4.2775</span><span class="p">,</span> <span class="mf">4.2725</span><span class="p">,</span> <span class="mf">4.2675</span><span class="p">,</span> <span class="mf">4.2625</span><span class="p">,</span> <span class="mf">4.2575</span><span class="p">,</span> <span class="mf">4.2525</span><span class="p">,</span> <span class="mf">4.2475</span><span class="p">,</span> <span class="mf">4.2425</span><span class="p">,</span> <span class="mf">4.2375</span><span class="p">,</span> <span class="mf">4.2325</span><span class="p">,</span> <span class="mf">4.2275</span><span class="p">,</span> <span class="mf">4.2225</span><span class="p">,</span> <span class="mf">4.2175</span><span class="p">,</span> <span class="mf">4.2125</span><span class="p">,</span> <span class="mf">4.2075</span><span class="p">,</span> <span class="mf">4.2025</span><span class="p">,</span> <span class="mf">4.1975</span><span class="p">,</span> <span class="mf">4.1925</span><span class="p">,</span> <span class="mf">4.1875</span><span class="p">,</span> <span class="mf">4.1825</span><span class="p">,</span> <span class="mf">4.1775</span><span class="p">,</span> <span class="mf">4.1725</span><span class="p">,</span> <span class="mf">4.1675</span><span class="p">,</span> <span class="mf">4.1625</span><span class="p">,</span> <span class="mf">4.1575</span><span class="p">,</span> <span class="mf">4.1525</span><span class="p">,</span> <span class="mf">4.1475</span><span class="p">,</span> <span class="mf">4.1425</span><span class="p">,</span> <span class="mf">4.1375</span><span class="p">,</span> <span class="mf">4.1325</span><span class="p">,</span> <span class="mf">4.1275</span><span class="p">,</span> <span class="mf">4.1225</span><span class="p">,</span> <span class="mf">4.1175</span><span class="p">,</span> <span class="mf">4.1125</span><span class="p">,</span> <span class="mf">4.1075</span><span class="p">,</span> <span class="mf">4.1025</span><span class="p">,</span> <span class="mf">4.0975</span><span class="p">,</span> <span class="mf">4.0925</span><span class="p">,</span> <span class="mf">4.0875</span><span class="p">,</span> <span class="mf">4.0825</span><span class="p">,</span> <span class="mf">4.0775</span><span class="p">,</span> <span class="mf">4.0725</span><span class="p">,</span> <span class="mf">4.0675</span><span class="p">,</span> <span class="mf">4.0625</span><span class="p">,</span> <span class="mf">4.0575</span><span class="p">,</span> <span class="mf">4.0525</span><span class="p">,</span> <span class="mf">4.0475</span><span class="p">,</span> <span class="mf">4.0425</span><span class="p">,</span> <span class="mf">4.0375</span><span class="p">,</span> <span class="mf">4.0325</span><span class="p">,</span> <span class="mf">4.0275</span><span class="p">,</span> <span class="mf">4.0225</span><span class="p">,</span> <span class="mf">4.0175</span><span class="p">,</span> <span class="mf">4.0125</span><span class="p">,</span> <span class="mf">4.0075</span><span class="p">,</span> <span class="mf">4.0025</span><span class="p">,</span> <span class="mf">3.9975</span><span class="p">,</span> <span class="mf">3.9925</span><span class="p">,</span> <span class="mf">3.9875</span><span class="p">,</span> <span class="mf">3.9825</span><span class="p">,</span> <span class="mf">3.9775</span><span class="p">,</span> <span class="mf">3.9725</span><span class="p">,</span> <span class="mf">3.9675</span><span class="p">,</span> <span class="mf">3.9625</span><span class="p">,</span> <span class="mf">3.9575</span><span class="p">,</span> <span class="mf">3.9525</span><span class="p">,</span> <span class="mf">3.9475</span><span class="p">,</span> <span class="mf">3.9425</span><span class="p">,</span> <span class="mf">3.9375</span><span class="p">,</span> <span class="mf">3.9325</span><span class="p">,</span> <span class="mf">3.9275</span><span class="p">,</span> <span class="mf">3.9225</span><span class="p">,</span> <span class="mf">3.9175</span><span class="p">,</span> <span class="mf">3.9125</span><span class="p">,</span> <span class="mf">3.9075</span><span class="p">,</span> <span class="mf">3.9025</span><span class="p">,</span> <span class="mf">3.8975</span><span class="p">,</span> <span class="mf">3.8925</span><span class="p">,</span> <span class="mf">3.8875</span><span class="p">,</span> <span class="mf">3.8825</span><span class="p">,</span> <span class="mf">3.8775</span><span class="p">,</span> <span class="mf">3.8725</span><span class="p">,</span> <span class="mf">3.8675</span><span class="p">,</span> <span class="mf">3.8625</span><span class="p">,</span> <span class="mf">3.8575</span><span class="p">,</span> <span class="mf">3.8525</span><span class="p">,</span> <span class="mf">3.8475</span><span class="p">,</span> <span class="mf">3.8425</span><span class="p">,</span> <span class="mf">3.8375</span><span class="p">,</span> <span class="mf">3.8325</span><span class="p">,</span> <span class="mf">3.8275</span><span class="p">,</span> <span class="mf">3.8225</span><span class="p">,</span> <span class="mf">3.8175</span><span class="p">,</span> <span class="mf">3.8125</span><span class="p">,</span> <span class="mf">3.8075</span><span class="p">,</span> <span class="mf">3.8025</span><span class="p">,</span> <span class="mf">3.7975</span><span class="p">,</span> <span class="mf">3.7925</span><span class="p">,</span> <span class="mf">3.7875</span><span class="p">,</span> <span class="mf">3.7825</span><span class="p">,</span> <span class="mf">3.7775</span><span class="p">,</span> <span class="mf">3.7725</span><span class="p">,</span> <span class="mf">3.7675</span><span class="p">,</span> <span class="mf">3.7625</span><span class="p">,</span> <span class="mf">3.7575</span><span class="p">,</span> <span class="mf">3.7525</span><span class="p">,</span> <span class="mf">3.7475</span><span class="p">,</span> <span class="mf">3.7425</span><span class="p">,</span> <span class="mf">3.7375</span><span class="p">,</span> <span class="mf">3.7325</span><span class="p">,</span> <span class="mf">3.7275</span><span class="p">,</span> <span class="mf">3.7225</span><span class="p">,</span> <span class="mf">3.7175</span><span class="p">,</span> <span class="mf">3.7125</span><span class="p">,</span> <span class="mf">3.7075</span><span class="p">,</span> <span class="mf">3.7025</span><span class="p">,</span> <span class="mf">3.6975</span><span class="p">,</span> <span class="mf">3.6925</span><span class="p">,</span> <span class="mf">3.6875</span><span class="p">,</span> <span class="mf">3.6825</span><span class="p">,</span> <span class="mf">3.6775</span><span class="p">,</span> <span class="mf">3.6725</span><span class="p">,</span> <span class="mf">3.6675</span><span class="p">,</span> <span class="mf">3.6625</span><span class="p">,</span> <span class="mf">3.6575</span><span class="p">,</span> <span class="mf">3.6525</span><span class="p">,</span> <span class="mf">3.6475</span><span class="p">,</span> <span class="mf">3.6425</span><span class="p">,</span> <span class="mf">3.6375</span><span class="p">,</span> <span class="mf">3.6325</span><span class="p">,</span> <span class="mf">3.6275</span><span class="p">,</span> <span class="mf">3.6225</span><span class="p">,</span> <span class="mf">3.6175</span><span class="p">,</span> <span class="mf">3.6125</span><span class="p">,</span> <span class="mf">3.6075</span><span class="p">,</span> <span class="mf">3.6025</span><span class="p">,</span> <span class="mf">3.5975</span><span class="p">,</span> <span class="mf">3.5925</span><span class="p">,</span> <span class="mf">3.5875</span><span class="p">,</span> <span class="mf">3.5825</span><span class="p">,</span> <span class="mf">3.5775</span><span class="p">,</span> <span class="mf">3.5725</span><span class="p">,</span> <span class="mf">3.5675</span><span class="p">,</span> <span class="mf">3.5625</span><span class="p">,</span> <span class="mf">3.5575</span><span class="p">,</span> <span class="mf">3.5525</span><span class="p">,</span> <span class="mf">3.5475</span><span class="p">,</span> <span class="mf">3.5425</span><span class="p">,</span> <span class="mf">3.5375</span><span class="p">,</span> <span class="mf">3.5325</span><span class="p">,</span> <span class="mf">3.5275</span><span class="p">,</span> <span class="mf">3.5225</span><span class="p">,</span> <span class="mf">3.5175</span><span class="p">,</span> <span class="mf">3.5125</span><span class="p">,</span> <span class="mf">3.5075</span><span class="p">,</span> <span class="mf">3.5025</span><span class="p">,</span> <span class="mf">3.4975</span><span class="p">,</span> <span class="mf">3.4925</span><span class="p">,</span> <span class="mf">3.4875</span><span class="p">,</span> <span class="mf">3.4825</span><span class="p">,</span> <span class="mf">3.4775</span><span class="p">,</span> <span class="mf">3.4725</span><span class="p">,</span> <span class="mf">3.4675</span><span class="p">,</span> <span class="mf">3.4625</span><span class="p">,</span> <span class="mf">3.4575</span><span class="p">,</span> <span class="mf">3.4525</span><span class="p">,</span> <span class="mf">3.4475</span><span class="p">,</span> <span class="mf">3.4425</span><span class="p">,</span> <span class="mf">3.4375</span><span class="p">,</span> <span class="mf">3.4325</span><span class="p">,</span> <span class="mf">3.4275</span><span class="p">,</span> <span class="mf">3.4225</span><span class="p">,</span> <span class="mf">3.4175</span><span class="p">,</span> <span class="mf">3.4125</span><span class="p">,</span> <span class="mf">3.4075</span><span class="p">,</span> <span class="mf">3.4025</span><span class="p">,</span> <span class="mf">3.3975</span><span class="p">,</span> <span class="mf">3.3925</span><span class="p">,</span> <span class="mf">3.3875</span><span class="p">,</span> <span class="mf">3.3825</span><span class="p">,</span> <span class="mf">3.3775</span><span class="p">,</span> <span class="mf">3.3725</span><span class="p">,</span> <span class="mf">3.3675</span><span class="p">,</span> <span class="mf">3.3625</span><span class="p">,</span> <span class="mf">3.3575</span><span class="p">,</span> <span class="mf">3.3525</span><span class="p">,</span> <span class="mf">3.3475</span><span class="p">,</span> <span class="mf">3.3425</span><span class="p">,</span> <span class="mf">3.3375</span><span class="p">,</span> <span class="mf">3.3325</span><span class="p">,</span> <span class="mf">3.3275</span><span class="p">,</span> <span class="mf">3.3225</span><span class="p">,</span> <span class="mf">3.3175</span><span class="p">,</span> <span class="mf">3.3125</span><span class="p">,</span> <span class="mf">3.3075</span><span class="p">,</span> <span class="mf">3.3025</span><span class="p">,</span> <span class="mf">3.2975</span><span class="p">,</span> <span class="mf">3.2925</span><span class="p">,</span> <span class="mf">3.2875</span><span class="p">,</span> <span class="mf">3.2825</span><span class="p">,</span> <span class="mf">3.2775</span><span class="p">,</span> <span class="mf">3.2725</span><span class="p">,</span> <span class="mf">3.2675</span><span class="p">,</span> <span class="mf">3.2625</span><span class="p">,</span> <span class="mf">3.2575</span><span class="p">,</span> <span class="mf">3.2525</span><span class="p">,</span> <span class="mf">3.2475</span><span class="p">,</span> <span class="mf">3.2425</span><span class="p">,</span> <span class="mf">3.2375</span><span class="p">,</span> <span class="mf">3.2325</span><span class="p">,</span> <span class="mf">3.2275</span><span class="p">,</span> <span class="mf">3.2225</span><span class="p">,</span> <span class="mf">3.2175</span><span class="p">,</span> <span class="mf">3.2125</span><span class="p">,</span> <span class="mf">3.2075</span><span class="p">,</span> <span class="mf">3.2025</span><span class="p">,</span> <span class="mf">3.1975</span><span class="p">,</span> <span class="mf">3.1925</span><span class="p">,</span> <span class="mf">3.1875</span><span class="p">,</span> <span class="mf">3.1825</span><span class="p">,</span> <span class="mf">3.1775</span><span class="p">,</span> <span class="mf">3.1725</span><span class="p">,</span> <span class="mf">3.1675</span><span class="p">,</span> <span class="mf">3.1625</span><span class="p">,</span> <span class="mf">3.1575</span><span class="p">,</span> <span class="mf">3.1525</span><span class="p">,</span> <span class="mf">3.1475</span><span class="p">,</span> <span class="mf">3.1425</span><span class="p">,</span> <span class="mf">3.1375</span><span class="p">,</span> <span class="mf">3.1325</span><span class="p">,</span> <span class="mf">3.1275</span><span class="p">,</span> <span class="mf">3.1225</span><span class="p">,</span> <span class="mf">3.1175</span><span class="p">,</span> <span class="mf">3.1125</span><span class="p">,</span> <span class="mf">3.1075</span><span class="p">,</span> <span class="mf">3.1025</span><span class="p">,</span> <span class="mf">3.0975</span><span class="p">,</span> <span class="mf">3.0925</span><span class="p">,</span> <span class="mf">3.0875</span><span class="p">,</span> <span class="mf">3.0825</span><span class="p">,</span> <span class="mf">3.0775</span><span class="p">,</span> <span class="mf">3.0725</span><span class="p">,</span> <span class="mf">3.0675</span><span class="p">,</span> <span class="mf">3.0625</span><span class="p">,</span> <span class="mf">3.0575</span><span class="p">,</span> <span class="mf">3.0525</span><span class="p">,</span> <span class="mf">3.0475</span><span class="p">,</span> <span class="mf">3.0425</span><span class="p">,</span> <span class="mf">3.0375</span><span class="p">,</span> <span class="mf">3.0325</span><span class="p">,</span> <span class="mf">3.0275</span><span class="p">,</span> <span class="mf">3.0225</span><span class="p">,</span> <span class="mf">3.0175</span><span class="p">,</span> <span class="mf">3.0125</span><span class="p">,</span> <span class="mf">3.0075</span><span class="p">,</span> <span class="mf">3.0025</span><span class="p">,</span> <span class="mf">2.9975</span><span class="p">,</span> <span class="mf">2.9925</span><span class="p">,</span> <span class="mf">2.9875</span><span class="p">,</span> <span class="mf">2.9825</span><span class="p">,</span> <span class="mf">2.9775</span><span class="p">,</span> <span class="mf">2.9725</span><span class="p">,</span> <span class="mf">2.9675</span><span class="p">,</span> <span class="mf">2.9625</span><span class="p">,</span> <span class="mf">2.9575</span><span class="p">,</span> <span class="mf">2.9525</span><span class="p">,</span> <span class="mf">2.9475</span><span class="p">,</span> <span class="mf">2.9425</span><span class="p">,</span> <span class="mf">2.9375</span><span class="p">,</span> <span class="mf">2.9325</span><span class="p">,</span> <span class="mf">2.9275</span><span class="p">,</span> <span class="mf">2.9225</span><span class="p">,</span> <span class="mf">2.9175</span><span class="p">,</span> <span class="mf">2.9125</span><span class="p">,</span> <span class="mf">2.9075</span><span class="p">,</span> <span class="mf">2.9025</span><span class="p">,</span> <span class="mf">2.8975</span><span class="p">,</span> <span class="mf">2.8925</span><span class="p">,</span> <span class="mf">2.8875</span><span class="p">,</span> <span class="mf">2.8825</span><span class="p">,</span> <span class="mf">2.8775</span><span class="p">,</span> <span class="mf">2.8725</span><span class="p">,</span> <span class="mf">2.8675</span><span class="p">,</span> <span class="mf">2.8625</span><span class="p">,</span> <span class="mf">2.8575</span><span class="p">,</span> <span class="mf">2.8525</span><span class="p">,</span> <span class="mf">2.8475</span><span class="p">,</span> <span class="mf">2.8425</span><span class="p">,</span> <span class="mf">2.8375</span><span class="p">,</span> <span class="mf">2.8325</span><span class="p">,</span> <span class="mf">2.8275</span><span class="p">,</span> <span class="mf">2.8225</span><span class="p">,</span> <span class="mf">2.8175</span><span class="p">,</span> <span class="mf">2.8125</span><span class="p">,</span> <span class="mf">2.8075</span><span class="p">,</span> <span class="mf">2.8025</span><span class="p">,</span> <span class="mf">2.7975</span><span class="p">,</span> <span class="mf">2.7925</span><span class="p">,</span> <span class="mf">2.7875</span><span class="p">,</span> <span class="mf">2.7825</span><span class="p">,</span> <span class="mf">2.7775</span><span class="p">,</span> <span class="mf">2.7725</span><span class="p">,</span> <span class="mf">2.7675</span><span class="p">,</span> <span class="mf">2.7625</span><span class="p">,</span> <span class="mf">2.7575</span><span class="p">,</span> <span class="mf">2.7525</span><span class="p">,</span> <span class="mf">2.7475</span><span class="p">,</span> <span class="mf">2.7425</span><span class="p">,</span> <span class="mf">2.7375</span><span class="p">,</span> <span class="mf">2.7325</span><span class="p">,</span> <span class="mf">2.7275</span><span class="p">,</span> <span class="mf">2.7225</span><span class="p">,</span> <span class="mf">2.7175</span><span class="p">,</span> <span class="mf">2.7125</span><span class="p">,</span> <span class="mf">2.7075</span><span class="p">,</span> <span class="mf">2.7025</span><span class="p">,</span> <span class="mf">2.6975</span><span class="p">,</span> <span class="mf">2.6925</span><span class="p">,</span> <span class="mf">2.6875</span><span class="p">,</span> <span class="mf">2.6825</span><span class="p">,</span> <span class="mf">2.6775</span><span class="p">,</span> <span class="mf">2.6725</span><span class="p">,</span> <span class="mf">2.6675</span><span class="p">,</span> <span class="mf">2.6625</span><span class="p">,</span> <span class="mf">2.6575</span><span class="p">,</span> <span class="mf">2.6525</span><span class="p">,</span> <span class="mf">2.6475</span><span class="p">,</span> <span class="mf">2.6425</span><span class="p">,</span> <span class="mf">2.6375</span><span class="p">,</span> <span class="mf">2.6325</span><span class="p">,</span> <span class="mf">2.6275</span><span class="p">,</span> <span class="mf">2.6225</span><span class="p">,</span> <span class="mf">2.6175</span><span class="p">,</span> <span class="mf">2.6125</span><span class="p">,</span> <span class="mf">2.6075</span><span class="p">,</span> <span class="mf">2.6025</span><span class="p">,</span> <span class="mf">2.5975</span><span class="p">,</span> <span class="mf">2.5925</span><span class="p">,</span> <span class="mf">2.5875</span><span class="p">,</span> <span class="mf">2.5825</span><span class="p">,</span> <span class="mf">2.5775</span><span class="p">,</span> <span class="mf">2.5725</span><span class="p">,</span> <span class="mf">2.5675</span><span class="p">,</span> <span class="mf">2.5625</span><span class="p">,</span> <span class="mf">2.5575</span><span class="p">,</span> <span class="mf">2.5525</span><span class="p">,</span> <span class="mf">2.5475</span><span class="p">,</span> <span class="mf">2.5425</span><span class="p">,</span> <span class="mf">2.5375</span><span class="p">,</span> <span class="mf">2.5325</span><span class="p">,</span> <span class="mf">2.5275</span><span class="p">,</span> <span class="mf">2.5225</span><span class="p">,</span> <span class="mf">2.5175</span><span class="p">,</span> <span class="mf">2.5125</span><span class="p">,</span> <span class="mf">2.5075</span><span class="p">,</span> <span class="mf">2.5025</span><span class="p">,</span> <span class="mf">2.4975</span><span class="p">,</span> <span class="mf">2.4925</span><span class="p">,</span> <span class="mf">2.4875</span><span class="p">,</span> <span class="mf">2.4825</span><span class="p">,</span> <span class="mf">2.4775</span><span class="p">,</span> <span class="mf">2.4725</span><span class="p">,</span> <span class="mf">2.4675</span><span class="p">,</span> <span class="mf">2.4625</span><span class="p">,</span> <span class="mf">2.4575</span><span class="p">,</span> <span class="mf">2.4525</span><span class="p">,</span> <span class="mf">2.4475</span><span class="p">,</span> <span class="mf">2.4425</span><span class="p">,</span> <span class="mf">2.4375</span><span class="p">,</span> <span class="mf">2.4325</span><span class="p">,</span> <span class="mf">2.4275</span><span class="p">,</span> <span class="mf">2.4225</span><span class="p">,</span> <span class="mf">2.4175</span><span class="p">,</span> <span class="mf">2.4125</span><span class="p">,</span> <span class="mf">2.4075</span><span class="p">,</span> <span class="mf">2.4025</span><span class="p">,</span> <span class="mf">2.3975</span><span class="p">,</span> <span class="mf">2.3925</span><span class="p">,</span> <span class="mf">2.3875</span><span class="p">,</span> <span class="mf">2.3825</span><span class="p">,</span> <span class="mf">2.3775</span><span class="p">,</span> <span class="mf">2.3725</span><span class="p">,</span> <span class="mf">2.3675</span><span class="p">,</span> <span class="mf">2.3625</span><span class="p">,</span> <span class="mf">2.3575</span><span class="p">,</span> <span class="mf">2.3525</span><span class="p">,</span> <span class="mf">2.3475</span><span class="p">,</span> <span class="mf">2.3425</span><span class="p">,</span> <span class="mf">2.3375</span><span class="p">,</span> <span class="mf">2.3325</span><span class="p">,</span> <span class="mf">2.3275</span><span class="p">,</span> <span class="mf">2.3225</span><span class="p">,</span> <span class="mf">2.3175</span><span class="p">,</span> <span class="mf">2.3125</span><span class="p">,</span> <span class="mf">2.3075</span><span class="p">,</span> <span class="mf">2.3025</span><span class="p">,</span> <span class="mf">2.2975</span><span class="p">,</span> <span class="mf">2.2925</span><span class="p">,</span> <span class="mf">2.2875</span><span class="p">,</span> <span class="mf">2.2825</span><span class="p">,</span> <span class="mf">2.2775</span><span class="p">,</span> <span class="mf">2.2725</span><span class="p">,</span> <span class="mf">2.2675</span><span class="p">,</span> <span class="mf">2.2625</span><span class="p">,</span> <span class="mf">2.2575</span><span class="p">,</span> <span class="mf">2.2525</span><span class="p">,</span> <span class="mf">2.2475</span><span class="p">,</span> <span class="mf">2.2425</span><span class="p">,</span> <span class="mf">2.2375</span><span class="p">,</span> <span class="mf">2.2325</span><span class="p">,</span> <span class="mf">2.2275</span><span class="p">,</span> <span class="mf">2.2225</span><span class="p">,</span> <span class="mf">2.2175</span><span class="p">,</span> <span class="mf">2.2125</span><span class="p">,</span> <span class="mf">2.2075</span><span class="p">,</span> <span class="mf">2.2025</span><span class="p">,</span> <span class="mf">2.1975</span><span class="p">,</span> <span class="mf">2.1925</span><span class="p">,</span> <span class="mf">2.1875</span><span class="p">,</span> <span class="mf">2.1825</span><span class="p">,</span> <span class="mf">2.1775</span><span class="p">,</span> <span class="mf">2.1725</span><span class="p">,</span> <span class="mf">2.1675</span><span class="p">,</span> <span class="mf">2.1625</span><span class="p">,</span> <span class="mf">2.1575</span><span class="p">,</span> <span class="mf">2.1525</span><span class="p">,</span> <span class="mf">2.1475</span><span class="p">,</span> <span class="mf">2.1425</span><span class="p">,</span> <span class="mf">2.1375</span><span class="p">,</span> <span class="mf">2.1325</span><span class="p">,</span> <span class="mf">2.1275</span><span class="p">,</span> <span class="mf">2.1225</span><span class="p">,</span> <span class="mf">2.1175</span><span class="p">,</span> <span class="mf">2.1125</span><span class="p">,</span> <span class="mf">2.1075</span><span class="p">,</span> <span class="mf">2.1025</span><span class="p">,</span> <span class="mf">2.0975</span><span class="p">,</span> <span class="mf">2.0925</span><span class="p">,</span> <span class="mf">2.0875</span><span class="p">,</span> <span class="mf">2.0825</span><span class="p">,</span> <span class="mf">2.0775</span><span class="p">,</span> <span class="mf">2.0725</span><span class="p">,</span> <span class="mf">2.0675</span><span class="p">,</span> <span class="mf">2.0625</span><span class="p">,</span> <span class="mf">2.0575</span><span class="p">,</span> <span class="mf">2.0525</span><span class="p">,</span> <span class="mf">2.0475</span><span class="p">,</span> <span class="mf">2.0425</span><span class="p">,</span> <span class="mf">2.0375</span><span class="p">,</span> <span class="mf">2.0325</span><span class="p">,</span> <span class="mf">2.0275</span><span class="p">,</span> <span class="mf">2.0225</span><span class="p">,</span> <span class="mf">2.0175</span><span class="p">,</span> <span class="mf">2.0125</span><span class="p">,</span> <span class="mf">2.0075</span><span class="p">,</span> <span class="mf">2.0025</span><span class="p">,</span> <span class="mf">1.9975</span><span class="p">,</span> <span class="mf">1.9925</span><span class="p">,</span> <span class="mf">1.9875</span><span class="p">,</span> <span class="mf">1.9825</span><span class="p">,</span> <span class="mf">1.9775</span><span class="p">,</span> <span class="mf">1.9725</span><span class="p">,</span> <span class="mf">1.9675</span><span class="p">,</span> <span class="mf">1.9625</span><span class="p">,</span> <span class="mf">1.9575</span><span class="p">,</span> <span class="mf">1.9525</span><span class="p">,</span> <span class="mf">1.9475</span><span class="p">,</span> <span class="mf">1.9425</span><span class="p">,</span> <span class="mf">1.9375</span><span class="p">,</span> <span class="mf">1.9325</span><span class="p">,</span> <span class="mf">1.9275</span><span class="p">,</span> <span class="mf">1.9225</span><span class="p">,</span> <span class="mf">1.9175</span><span class="p">,</span> <span class="mf">1.9125</span><span class="p">,</span> <span class="mf">1.9075</span><span class="p">,</span> <span class="mf">1.9025</span><span class="p">,</span> <span class="mf">1.8975</span><span class="p">,</span> <span class="mf">1.8925</span><span class="p">,</span> <span class="mf">1.8875</span><span class="p">,</span> <span class="mf">1.8825</span><span class="p">,</span> <span class="mf">1.8775</span><span class="p">,</span> <span class="mf">1.8725</span><span class="p">,</span> <span class="mf">1.8675</span><span class="p">,</span> <span class="mf">1.8625</span><span class="p">,</span> <span class="mf">1.8575</span><span class="p">,</span> <span class="mf">1.8525</span><span class="p">,</span> <span class="mf">1.8475</span><span class="p">,</span> <span class="mf">1.8425</span><span class="p">,</span> <span class="mf">1.8375</span><span class="p">,</span> <span class="mf">1.8325</span><span class="p">,</span> <span class="mf">1.8275</span><span class="p">,</span> <span class="mf">1.8225</span><span class="p">,</span> <span class="mf">1.8175</span><span class="p">,</span> <span class="mf">1.8125</span><span class="p">,</span> <span class="mf">1.8075</span><span class="p">,</span> <span class="mf">1.8025</span><span class="p">,</span> <span class="mf">1.7975</span><span class="p">,</span> <span class="mf">1.7925</span><span class="p">,</span> <span class="mf">1.7875</span><span class="p">,</span> <span class="mf">1.7825</span><span class="p">,</span> <span class="mf">1.7775</span><span class="p">,</span> <span class="mf">1.7725</span><span class="p">,</span> <span class="mf">1.7675</span><span class="p">,</span> <span class="mf">1.7625</span><span class="p">,</span> <span class="mf">1.7575</span><span class="p">,</span> <span class="mf">1.7525</span><span class="p">,</span> <span class="mf">1.7475</span><span class="p">,</span> <span class="mf">1.7425</span><span class="p">,</span> <span class="mf">1.7375</span><span class="p">,</span> <span class="mf">1.7325</span><span class="p">,</span> <span class="mf">1.7275</span><span class="p">,</span> <span class="mf">1.7225</span><span class="p">,</span> <span class="mf">1.7175</span><span class="p">,</span> <span class="mf">1.7125</span><span class="p">,</span> <span class="mf">1.7075</span><span class="p">,</span> <span class="mf">1.7025</span><span class="p">,</span> <span class="mf">1.6975</span><span class="p">,</span> <span class="mf">1.6925</span><span class="p">,</span> <span class="mf">1.6875</span><span class="p">,</span> <span class="mf">1.6825</span><span class="p">,</span> <span class="mf">1.6775</span><span class="p">,</span> <span class="mf">1.6725</span><span class="p">,</span> <span class="mf">1.6675</span><span class="p">,</span> <span class="mf">1.6625</span><span class="p">,</span> <span class="mf">1.6575</span><span class="p">,</span> <span class="mf">1.6525</span><span class="p">,</span> <span class="mf">1.6475</span><span class="p">,</span> <span class="mf">1.6425</span><span class="p">,</span> <span class="mf">1.6375</span><span class="p">,</span> <span class="mf">1.6325</span><span class="p">,</span> <span class="mf">1.6275</span><span class="p">,</span> <span class="mf">1.6225</span><span class="p">,</span> <span class="mf">1.6175</span><span class="p">,</span> <span class="mf">1.6125</span><span class="p">,</span> <span class="mf">1.6075</span><span class="p">,</span> <span class="mf">1.6025</span><span class="p">,</span> <span class="mf">1.5975</span><span class="p">,</span> <span class="mf">1.5925</span><span class="p">,</span> <span class="mf">1.5875</span><span class="p">,</span> <span class="mf">1.5825</span><span class="p">,</span> <span class="mf">1.5775</span><span class="p">,</span> <span class="mf">1.5725</span><span class="p">,</span> <span class="mf">1.5675</span><span class="p">,</span> <span class="mf">1.5625</span><span class="p">,</span> <span class="mf">1.5575</span><span class="p">,</span> <span class="mf">1.5525</span><span class="p">,</span> <span class="mf">1.5475</span><span class="p">,</span> <span class="mf">1.5425</span><span class="p">,</span> <span class="mf">1.5375</span><span class="p">,</span> <span class="mf">1.5325</span><span class="p">,</span> <span class="mf">1.5275</span><span class="p">,</span> <span class="mf">1.5225</span><span class="p">,</span> <span class="mf">1.5175</span><span class="p">,</span> <span class="mf">1.5125</span><span class="p">,</span> <span class="mf">1.5075</span><span class="p">,</span> <span class="mf">1.5025</span><span class="p">,</span> <span class="mf">1.4975</span><span class="p">,</span> <span class="mf">1.4925</span><span class="p">,</span> <span class="mf">1.4875</span><span class="p">,</span> <span class="mf">1.4825</span><span class="p">,</span> <span class="mf">1.4775</span><span class="p">,</span> <span class="mf">1.4725</span><span class="p">,</span> <span class="mf">1.4675</span><span class="p">,</span> <span class="mf">1.4625</span><span class="p">,</span> <span class="mf">1.4575</span><span class="p">,</span> <span class="mf">1.4525</span><span class="p">,</span> <span class="mf">1.4475</span><span class="p">,</span> <span class="mf">1.4425</span><span class="p">,</span> <span class="mf">1.4375</span><span class="p">,</span> <span class="mf">1.4325</span><span class="p">,</span> <span class="mf">1.4275</span><span class="p">,</span> <span class="mf">1.4225</span><span class="p">,</span> <span class="mf">1.4175</span><span class="p">,</span> <span class="mf">1.4125</span><span class="p">,</span> <span class="mf">1.4075</span><span class="p">,</span> <span class="mf">1.4025</span><span class="p">,</span> <span class="mf">1.3975</span><span class="p">,</span> <span class="mf">1.3925</span><span class="p">,</span> <span class="mf">1.3875</span><span class="p">,</span> <span class="mf">1.3825</span><span class="p">,</span> <span class="mf">1.3775</span><span class="p">,</span> <span class="mf">1.3725</span><span class="p">,</span> <span class="mf">1.3675</span><span class="p">,</span> <span class="mf">1.3625</span><span class="p">,</span> <span class="mf">1.3575</span><span class="p">,</span> <span class="mf">1.3525</span><span class="p">,</span> <span class="mf">1.3475</span><span class="p">,</span> <span class="mf">1.3425</span><span class="p">,</span> <span class="mf">1.3375</span><span class="p">,</span> <span class="mf">1.3325</span><span class="p">,</span> <span class="mf">1.3275</span><span class="p">,</span> <span class="mf">1.3225</span><span class="p">,</span> <span class="mf">1.3175</span><span class="p">,</span> <span class="mf">1.3125</span><span class="p">,</span> <span class="mf">1.3075</span><span class="p">,</span> <span class="mf">1.3025</span><span class="p">,</span> <span class="mf">1.2975</span><span class="p">,</span> <span class="mf">1.2925</span><span class="p">,</span> <span class="mf">1.2875</span><span class="p">,</span> <span class="mf">1.2825</span><span class="p">,</span> <span class="mf">1.2775</span><span class="p">,</span> <span class="mf">1.2725</span><span class="p">,</span> <span class="mf">1.2675</span><span class="p">,</span> <span class="mf">1.2625</span><span class="p">,</span> <span class="mf">1.2575</span><span class="p">,</span> <span class="mf">1.2525</span><span class="p">,</span> <span class="mf">1.2475</span><span class="p">,</span> <span class="mf">1.2425</span><span class="p">,</span> <span class="mf">1.2375</span><span class="p">,</span> <span class="mf">1.2325</span><span class="p">,</span> <span class="mf">1.2275</span><span class="p">,</span> <span class="mf">1.2225</span><span class="p">,</span> <span class="mf">1.2175</span><span class="p">,</span> <span class="mf">1.2125</span><span class="p">,</span> <span class="mf">1.2075</span><span class="p">,</span> <span class="mf">1.2025</span><span class="p">,</span> <span class="mf">1.1975</span><span class="p">,</span> <span class="mf">1.1925</span><span class="p">,</span> <span class="mf">1.1875</span><span class="p">,</span> <span class="mf">1.1825</span><span class="p">,</span> <span class="mf">1.1775</span><span class="p">,</span> <span class="mf">1.1725</span><span class="p">,</span> <span class="mf">1.1675</span><span class="p">,</span> <span class="mf">1.1625</span><span class="p">,</span> <span class="mf">1.1575</span><span class="p">,</span> <span class="mf">1.1525</span><span class="p">,</span> <span class="mf">1.1475</span><span class="p">,</span> <span class="mf">1.1425</span><span class="p">,</span> <span class="mf">1.1375</span><span class="p">,</span> <span class="mf">1.1325</span><span class="p">,</span> <span class="mf">1.1275</span><span class="p">,</span> <span class="mf">1.1225</span><span class="p">,</span> <span class="mf">1.1175</span><span class="p">,</span> <span class="mf">1.1125</span><span class="p">,</span> <span class="mf">1.1075</span><span class="p">,</span> <span class="mf">1.1025</span><span class="p">,</span> <span class="mf">1.0975</span><span class="p">,</span> <span class="mf">1.0925</span><span class="p">,</span> <span class="mf">1.0875</span><span class="p">,</span> <span class="mf">1.0825</span><span class="p">,</span> <span class="mf">1.0775</span><span class="p">,</span> <span class="mf">1.0725</span><span class="p">,</span> <span class="mf">1.0675</span><span class="p">,</span> <span class="mf">1.0625</span><span class="p">,</span> <span class="mf">1.0575</span><span class="p">,</span> <span class="mf">1.0525</span><span class="p">,</span> <span class="mf">1.0475</span><span class="p">,</span> <span class="mf">1.0425</span><span class="p">,</span> <span class="mf">1.0375</span><span class="p">,</span> <span class="mf">1.0325</span><span class="p">,</span> <span class="mf">1.0275</span><span class="p">,</span> <span class="mf">1.0225</span><span class="p">,</span> <span class="mf">1.0175</span><span class="p">,</span> <span class="mf">1.0125</span><span class="p">,</span> <span class="mf">1.0075</span><span class="p">,</span> <span class="mf">1.0025</span><span class="p">,</span> <span class="mf">0.9975</span><span class="p">,</span> <span class="mf">0.9925</span><span class="p">,</span> <span class="mf">0.9875</span><span class="p">,</span> <span class="mf">0.9825</span><span class="p">,</span> <span class="mf">0.9775</span><span class="p">,</span> <span class="mf">0.9725</span><span class="p">,</span> <span class="mf">0.9675</span><span class="p">,</span> <span class="mf">0.9625</span><span class="p">,</span> <span class="mf">0.9575</span><span class="p">,</span> <span class="mf">0.9525</span><span class="p">,</span> <span class="mf">0.9475</span><span class="p">,</span> <span class="mf">0.9425</span><span class="p">,</span> <span class="mf">0.9375</span><span class="p">,</span> <span class="mf">0.9325</span><span class="p">,</span> <span class="mf">0.9275</span><span class="p">,</span> <span class="mf">0.9225</span><span class="p">,</span> <span class="mf">0.9175</span><span class="p">,</span> <span class="mf">0.9125</span><span class="p">,</span> <span class="mf">0.9075</span><span class="p">,</span> <span class="mf">0.9025</span><span class="p">,</span> <span class="mf">0.8975</span><span class="p">,</span> <span class="mf">0.8925</span><span class="p">,</span> <span class="mf">0.8875</span><span class="p">,</span> <span class="mf">0.8825</span><span class="p">,</span> <span class="mf">0.8775</span><span class="p">,</span> <span class="mf">0.8725</span><span class="p">,</span> <span class="mf">0.8675</span><span class="p">,</span> <span class="mf">0.8625</span><span class="p">,</span> <span class="mf">0.8575</span><span class="p">,</span> <span class="mf">0.8525</span><span class="p">,</span> <span class="mf">0.8475</span><span class="p">,</span> <span class="mf">0.8425</span><span class="p">,</span> <span class="mf">0.8375</span><span class="p">,</span> <span class="mf">0.8325</span><span class="p">,</span> <span class="mf">0.8275</span><span class="p">,</span> <span class="mf">0.8225</span><span class="p">,</span> <span class="mf">0.8175</span><span class="p">,</span> <span class="mf">0.8125</span><span class="p">,</span> <span class="mf">0.8075</span><span class="p">,</span> <span class="mf">0.8025</span><span class="p">,</span> <span class="mf">0.7975</span><span class="p">,</span> <span class="mf">0.7925</span><span class="p">,</span> <span class="mf">0.7875</span><span class="p">,</span> <span class="mf">0.7825</span><span class="p">,</span> <span class="mf">0.7775</span><span class="p">,</span> <span class="mf">0.7725</span><span class="p">,</span> <span class="mf">0.7675</span><span class="p">,</span> <span class="mf">0.7625</span><span class="p">,</span> <span class="mf">0.7575</span><span class="p">,</span> <span class="mf">0.7525</span><span class="p">,</span> <span class="mf">0.7475</span><span class="p">,</span> <span class="mf">0.7425</span><span class="p">,</span> <span class="mf">0.7375</span><span class="p">,</span> <span class="mf">0.7325</span><span class="p">,</span> <span class="mf">0.7275</span><span class="p">,</span> <span class="mf">0.7225</span><span class="p">,</span> <span class="mf">0.7175</span><span class="p">,</span> <span class="mf">0.7125</span><span class="p">,</span> <span class="mf">0.7075</span><span class="p">,</span> <span class="mf">0.7025</span><span class="p">,</span> <span class="mf">0.6975</span><span class="p">,</span> <span class="mf">0.6925</span><span class="p">,</span> <span class="mf">0.6875</span><span class="p">,</span> <span class="mf">0.6825</span><span class="p">,</span> <span class="mf">0.6775</span><span class="p">,</span> <span class="mf">0.6725</span><span class="p">,</span> <span class="mf">0.6675</span><span class="p">,</span> <span class="mf">0.6625</span><span class="p">,</span> <span class="mf">0.6575</span><span class="p">,</span> <span class="mf">0.6525</span><span class="p">,</span> <span class="mf">0.6475</span><span class="p">,</span> <span class="mf">0.6425</span><span class="p">,</span> <span class="mf">0.6375</span><span class="p">,</span> <span class="mf">0.6325</span><span class="p">,</span> <span class="mf">0.6275</span><span class="p">,</span> <span class="mf">0.6225</span><span class="p">,</span> <span class="mf">0.6175</span><span class="p">,</span> <span class="mf">0.6125</span><span class="p">,</span> <span class="mf">0.6075</span><span class="p">,</span> <span class="mf">0.6025</span><span class="p">,</span> <span class="mf">0.5975</span><span class="p">,</span> <span class="mf">0.5925</span><span class="p">,</span> <span class="mf">0.5875</span><span class="p">,</span> <span class="mf">0.5825</span><span class="p">,</span> <span class="mf">0.5775</span><span class="p">,</span> <span class="mf">0.5725</span><span class="p">,</span> <span class="mf">0.5675</span><span class="p">,</span> <span class="mf">0.5625</span><span class="p">,</span> <span class="mf">0.5575</span><span class="p">,</span> <span class="mf">0.5525</span><span class="p">,</span> <span class="mf">0.5475</span><span class="p">,</span> <span class="mf">0.5425</span><span class="p">,</span> <span class="mf">0.5375</span><span class="p">,</span> <span class="mf">0.5325</span><span class="p">,</span> <span class="mf">0.5275</span><span class="p">,</span> <span class="mf">0.5225</span><span class="p">,</span> <span class="mf">0.5175</span><span class="p">,</span> <span class="mf">0.5125</span><span class="p">,</span> <span class="mf">0.5075</span><span class="p">,</span> <span class="mf">0.5025</span><span class="p">,</span> <span class="mf">0.4975</span><span class="p">,</span> <span class="mf">0.4925</span><span class="p">,</span> <span class="mf">0.4875</span><span class="p">,</span> <span class="mf">0.4825</span><span class="p">,</span> <span class="mf">0.4775</span><span class="p">,</span> <span class="mf">0.4725</span><span class="p">,</span> <span class="mf">0.4675</span><span class="p">,</span> <span class="mf">0.4625</span><span class="p">,</span> <span class="mf">0.4575</span><span class="p">,</span> <span class="mf">0.4525</span><span class="p">,</span> <span class="mf">0.4475</span><span class="p">,</span> <span class="mf">0.4425</span><span class="p">,</span> <span class="mf">0.4375</span><span class="p">,</span> <span class="mf">0.4325</span><span class="p">,</span> <span class="mf">0.4275</span><span class="p">,</span> <span class="mf">0.4225</span><span class="p">,</span> <span class="mf">0.4175</span><span class="p">,</span> <span class="mf">0.4125</span><span class="p">,</span> <span class="mf">0.4075</span><span class="p">,</span> <span class="mf">0.4025</span><span class="p">,</span> <span class="mf">0.3975</span><span class="p">,</span> <span class="mf">0.3925</span><span class="p">,</span> <span class="mf">0.3875</span><span class="p">,</span> <span class="mf">0.3825</span><span class="p">,</span> <span class="mf">0.3775</span><span class="p">,</span> <span class="mf">0.3725</span><span class="p">,</span> <span class="mf">0.3675</span><span class="p">,</span> <span class="mf">0.3625</span><span class="p">,</span> <span class="mf">0.3575</span><span class="p">,</span> <span class="mf">0.3525</span><span class="p">,</span> <span class="mf">0.3475</span><span class="p">,</span> <span class="mf">0.3425</span><span class="p">,</span> <span class="mf">0.3375</span><span class="p">,</span> <span class="mf">0.3325</span><span class="p">,</span> <span class="mf">0.3275</span><span class="p">,</span> <span class="mf">0.3225</span><span class="p">,</span> <span class="mf">0.3175</span><span class="p">,</span> <span class="mf">0.3125</span><span class="p">,</span> <span class="mf">0.3075</span><span class="p">,</span> <span class="mf">0.3025</span><span class="p">,</span> <span class="mf">0.2975</span><span class="p">,</span> <span class="mf">0.2925</span><span class="p">,</span> <span class="mf">0.2875</span><span class="p">,</span> <span class="mf">0.2825</span><span class="p">,</span> <span class="mf">0.2775</span><span class="p">,</span> <span class="mf">0.2725</span><span class="p">,</span> <span class="mf">0.2675</span><span class="p">,</span> <span class="mf">0.2625</span><span class="p">,</span> <span class="mf">0.2575</span><span class="p">,</span> <span class="mf">0.2525</span><span class="p">,</span> <span class="mf">0.2475</span><span class="p">,</span> <span class="mf">0.2425</span><span class="p">,</span> <span class="mf">0.2375</span><span class="p">,</span> <span class="mf">0.2325</span><span class="p">,</span> <span class="mf">0.2275</span><span class="p">,</span> <span class="mf">0.2225</span><span class="p">,</span> <span class="mf">0.2175</span><span class="p">,</span> <span class="mf">0.2125</span><span class="p">,</span> <span class="mf">0.2075</span><span class="p">,</span> <span class="mf">0.2025</span><span class="p">])</span>

<span class="c1">#Synthetic sample names for the interlaboratory comparison</span>
<span class="n">Spectrum_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;S1a&#39;</span><span class="p">,</span> <span class="s1">&#39;S1b&#39;</span><span class="p">,</span> <span class="s1">&#39;S1c&#39;</span><span class="p">,</span> <span class="s1">&#39;S1d&#39;</span><span class="p">,</span> <span class="s1">&#39;S1e&#39;</span><span class="p">,</span> <span class="s1">&#39;S1f&#39;</span><span class="p">,</span> <span class="s1">&#39;S2&#39;</span><span class="p">,</span> <span class="s1">&#39;S3&#39;</span><span class="p">,</span> <span class="s1">&#39;S4&#39;</span><span class="p">,</span> <span class="s1">&#39;S5&#39;</span><span class="p">,</span> <span class="s1">&#39;S6&#39;</span> <span class="p">]</span>

<span class="c1">#Biological sample names</span>
<span class="n">Bio_Spectrum_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C1a&#39;</span><span class="p">,</span> <span class="s1">&#39;C1b&#39;</span><span class="p">,</span> <span class="s1">&#39;C1c&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;C5&#39;</span><span class="p">,</span> <span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="s1">&#39;E1&#39;</span><span class="p">,</span> <span class="s1">&#39;E2&#39;</span><span class="p">,</span> <span class="s1">&#39;E3&#39;</span><span class="p">,</span> <span class="s1">&#39;E4&#39;</span><span class="p">,</span> <span class="s1">&#39;E5&#39;</span><span class="p">,</span> <span class="s1">&#39;E6&#39;</span><span class="p">]</span>

<span class="c1">#laboratory identifiers</span>
<span class="n">Labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">u</span><span class="s1">&#39;0115 </span><span class="se">\n</span><span class="s1"> 600 MHz&#39;</span><span class="p">,</span>
          <span class="sa">u</span><span class="s1">&#39;0122 </span><span class="se">\n</span><span class="s1"> 500 MHz&#39;</span><span class="p">,</span>
          <span class="sa">u</span><span class="s1">&#39;0258 </span><span class="se">\n</span><span class="s1"> 600 MHz&#39;</span><span class="p">,</span>
          <span class="sa">u</span><span class="s1">&#39;0333 </span><span class="se">\n</span><span class="s1"> 500 MHz&#39;</span><span class="p">,</span>
          <span class="sa">u</span><span class="s1">&#39;0711 </span><span class="se">\n</span><span class="s1"> 600 MHz&#39;</span><span class="p">,</span>
          <span class="sa">u</span><span class="s1">&#39;0714 </span><span class="se">\n</span><span class="s1"> 800 MHz&#39;</span><span class="p">,</span>
          <span class="sa">u</span><span class="s1">&#39;2861 </span><span class="se">\n</span><span class="s1"> 500 MHz&#39;</span><span class="p">,</span>
          <span class="sa">u</span><span class="s1">&#39;7042 </span><span class="se">\n</span><span class="s1"> 800 MHz&#39;</span><span class="p">,</span>
          <span class="sa">u</span><span class="s1">&#39;8865 </span><span class="se">\n</span><span class="s1"> 500 MHz&#39;</span><span class="p">,</span>
          <span class="sa">u</span><span class="s1">&#39;9541 </span><span class="se">\n</span><span class="s1"> 600 MHz&#39;</span><span class="p">]</span>

<span class="c1">#File containing the raw NMR data</span>
<span class="n">data_file_name</span> <span class="o">=</span> <span class="s2">&quot;mann.test&quot;</span>
<span class="n">bio_data_file_name</span> <span class="o">=</span> <span class="s2">&quot;bio.test&quot;</span>

<span class="c1">#The range of the data that will actually be used (remove anything anywhere near the water signal)</span>
<span class="n">range_to_use</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">959</span><span class="p">))</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1058</span><span class="p">,</span><span class="mi">1860</span><span class="p">))</span>
<span class="n">bio_range_to_use</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">959</span><span class="p">))</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1058</span><span class="p">,</span><span class="mi">1860</span><span class="p">))</span>
<span class="c1">#range_to_use = None</span>

<span class="c1">#Number of bins for the histogram</span>
<span class="n">num_bins</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c1">#Distance metrics</span>
<span class="n">jeffries</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;Symmetric Kullback-Liebler&#39;</span>
<span class="n">jensen</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;Jensen-Shannon&#39;</span>
<span class="n">hellinger</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;Hellinger&#39;</span>
<span class="n">mahalanobis</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;Mahalanobis&#39;</span>
<span class="n">nmr_distance_metrics</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Mahalanobis&#39;</span><span class="p">,</span><span class="n">function</span><span class="o">=</span><span class="s1">&#39;mahalanobis&#39;</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Hellinger&#39;</span><span class="p">,</span><span class="n">function</span><span class="o">=</span><span class="n">qmet</span><span class="o">.</span><span class="n">hellinger_hyp</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Symmetric Kullback-Liebler&#39;</span><span class="p">,</span><span class="n">function</span><span class="o">=</span><span class="n">qmet</span><span class="o">.</span><span class="n">jeffries</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Jensen-Shannon&#39;</span><span class="p">,</span><span class="n">function</span><span class="o">=</span><span class="n">qmet</span><span class="o">.</span><span class="n">jensen_hyp</span><span class="p">)</span>
    <span class="p">]</span>

<span class="n">figure_save_keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Laboratory-outlier-and-consensus-analysis">
<h3>Laboratory-outlier and consensus analysis<a class="headerlink" href="#Laboratory-outlier-and-consensus-analysis" title="Permalink to this headline">¶</a></h3>
<div class="section" id="Synthetic-sample-data">
<h4>Synthetic sample data<a class="headerlink" href="#Synthetic-sample-data" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Create the synthetic data project</span>
<span class="n">synthetic_samples_project</span> <span class="o">=</span> <span class="n">qmet</span><span class="o">.</span><span class="n">Project</span><span class="p">(</span><span class="n">x_data_list</span><span class="o">=</span><span class="n">peakPPM_full</span><span class="p">,</span>
                                    <span class="n">Sample_names</span><span class="o">=</span><span class="n">Spectrum_names</span><span class="p">,</span>
                                    <span class="n">Data_set_names</span><span class="o">=</span><span class="n">Labels</span><span class="p">,</span>
                                    <span class="n">distance_metric_dict</span><span class="o">=</span><span class="n">nmr_distance_metrics</span><span class="p">,</span>
                                    <span class="n">range_to_use</span><span class="o">=</span><span class="n">range_to_use</span>
                                   <span class="p">)</span>
<span class="n">numsets</span> <span class="o">=</span> <span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">_positional_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">numspecs</span> <span class="o">=</span> <span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">_positional_array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data_file_name</span>

<span class="c1">#Do outlier detection on the synthetic samples</span>
<span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">process_mahalanobis</span><span class="p">()</span>
<span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">set_distances</span><span class="p">()</span>
<span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">set_zscores</span><span class="p">()</span>
<span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">set_zscore_principal_components</span><span class="p">()</span>
<span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">find_all_outliers</span><span class="p">()</span>

<span class="c1">#Get the outlier mask that we will use from the bio samples project</span>
<span class="n">outlier_mask</span> <span class="o">=</span> <span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">outlier_mask</span><span class="p">[</span><span class="n">jensen</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
mann.test
</pre></div></div>
</div>
</div>
<div class="section" id="Representative-synthetic-sample-data">
<h4>Representative synthetic sample data<a class="headerlink" href="#Representative-synthetic-sample-data" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">figure4</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">2.5</span><span class="p">))</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>

<span class="c1">#print train_data_scale[labels].shape</span>
<span class="k">for</span> <span class="n">num</span><span class="p">,</span><span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">labels</span><span class="p">]):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">_x_data</span><span class="p">,(</span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="o">*-</span><span class="mi">35</span><span class="p">)</span><span class="o">+</span><span class="n">num</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="o">-</span><span class="mf">0.8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)))</span>
<span class="c1">#ax.yaxis.tick_right()</span>

<span class="k">for</span> <span class="n">num</span><span class="p">,</span><span class="n">tx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Spectrum_names</span><span class="p">)[</span><span class="n">labels</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">9.7</span><span class="p">,</span><span class="n">num</span> <span class="o">-</span> <span class="mf">0.3</span><span class="p">,</span><span class="n">tx</span><span class="p">)</span>

<span class="c1">#ax.set_yticklabels(np.array(names)[[1,6,7]])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity (a.u.)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency shift / 10$^{-6}$ (ppm)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="c1">#ax.text(-0.7,1,&#39;Sample label&#39;,size=15,rotation=&#39;-90&#39;,va=&#39;top&#39;,ha=&#39;center&#39;)</span>

<span class="n">figure4</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figure4.png&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">figure_save_keys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_13_0.png" src="_images/run_environmental_pls-Copy1_13_0.png" />
</div>
</div>
<p>Figure 4</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="Uncertainty-analysis-on-unsupervised-classification">
<h2>Uncertainty analysis on unsupervised classification<a class="headerlink" href="#Uncertainty-analysis-on-unsupervised-classification" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Preparation-for-machine-learning">
<h3>Preparation for machine learning<a class="headerlink" href="#Preparation-for-machine-learning" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Extract the consensus data set and mean-center it</span>
<span class="n">Pos_good</span> <span class="o">=</span> <span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">_positional_array</span><span class="p">[</span><span class="n">outlier_mask</span><span class="p">]</span>
<span class="n">good_data_range</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">data_range</span> <span class="ow">in</span> <span class="n">Pos_good</span><span class="p">:</span>
    <span class="n">good_data_range</span> <span class="o">+=</span> <span class="nb">range</span><span class="p">(</span><span class="n">data_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">data_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">train_data</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">good_data_range</span><span class="p">])</span>

<span class="n">scaling_mean</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">train_data_scale</span> <span class="o">=</span> <span class="p">(</span><span class="n">train_data</span> <span class="o">-</span> <span class="n">scaling_mean</span><span class="p">)</span>

<span class="c1">#Get number of samples in the data set</span>
<span class="n">num_train</span> <span class="o">=</span> <span class="n">train_data_scale</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Create cross-validation objects for testing</span>
<span class="n">lcv</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">LeaveOneOut</span><span class="p">()</span>
<span class="n">kcv</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">pcv</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">leave_one</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">LeaveOneGroupOut</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Labels</span>
<span class="n">names</span> <span class="o">=</span> <span class="n">Spectrum_names</span>
<span class="n">names_unique</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;S1&#39;</span><span class="p">,</span> <span class="s1">&#39;S2&#39;</span><span class="p">,</span> <span class="s1">&#39;S3&#39;</span><span class="p">,</span> <span class="s1">&#39;S4&#39;</span><span class="p">,</span> <span class="s1">&#39;S5&#39;</span><span class="p">,</span> <span class="s1">&#39;S6&#39;</span> <span class="p">]</span>
<span class="n">num_unique</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Identify class data from experiment names</span>
<span class="n">class_names</span> <span class="o">=</span> <span class="n">names</span> <span class="o">*</span> <span class="n">numsets</span><span class="c1">#Spectrum_names * numsets</span>
<span class="n">class_y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_train</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>



<span class="k">for</span> <span class="n">sample_num</span><span class="p">,</span><span class="n">class_string</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_train</span><span class="p">),</span><span class="n">class_names</span><span class="p">):</span>
    <span class="n">class_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">class_string</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">class_y_train</span><span class="p">[</span><span class="n">sample_num</span><span class="p">,</span><span class="n">class_num</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">groups_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">numsets</span><span class="p">),</span><span class="n">num_unique</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Principal-components-analysis-bootstrap">
<h3>Principal components analysis bootstrap<a class="headerlink" href="#Principal-components-analysis-bootstrap" title="Permalink to this headline">¶</a></h3>
<div class="section" id="PCA-fitting">
<h4>PCA fitting<a class="headerlink" href="#PCA-fitting" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Fit the PCA model</span>
<span class="n">nco</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">PCA_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">nco</span><span class="p">,</span><span class="n">whiten</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">svd_solver</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>

<span class="n">PCA2</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">decomposition</span><span class="o">.</span><span class="n">PCA</span><span class="p">(</span><span class="o">**</span><span class="n">PCA_dict</span><span class="p">)</span>
<span class="n">PCA2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data_scale</span><span class="p">)</span>

<span class="c1">#Bootstrap</span>
<span class="n">pca_samples</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">scores</span><span class="p">,</span><span class="n">scores_boot</span><span class="p">,</span><span class="n">class_boot</span><span class="p">,</span><span class="n">comps_boot</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">pca_bootstrap</span><span class="p">(</span>
    <span class="n">xdata</span><span class="o">=</span><span class="n">train_data_scale</span><span class="p">,</span><span class="n">ydata</span><span class="o">=</span><span class="n">class_y_train</span><span class="p">,</span><span class="n">cv_object</span><span class="o">=</span><span class="n">kcv</span><span class="p">,</span><span class="n">PCA_kw</span><span class="o">=</span><span class="n">PCA_dict</span><span class="p">,</span><span class="n">samples</span><span class="o">=</span><span class="n">pca_samples</span><span class="p">,</span><span class="n">tq</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="PCA-scores-and-uncertainty">
<h4>PCA scores and uncertainty<a class="headerlink" href="#PCA-scores-and-uncertainty" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#ff8888&#39;</span><span class="p">,</span><span class="s1">&#39;#8888ff&#39;</span><span class="p">,</span><span class="s1">&#39;0.6&#39;</span><span class="p">,</span><span class="s1">&#39;#88ff88&#39;</span><span class="p">,</span><span class="s1">&#39;#ff88ff&#39;</span><span class="p">,</span><span class="s1">&#39;#88ffff&#39;</span><span class="p">]</span>

<span class="n">x_comp</span><span class="o">=</span><span class="mi">0</span>
<span class="n">y_comp</span><span class="o">=</span><span class="mi">1</span>
<span class="n">figure5</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">pca_uncertainty_plot</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">colors</span><span class="p">,</span><span class="n">class_y_train</span><span class="p">,</span><span class="n">scores</span><span class="p">,</span><span class="n">class_boot</span><span class="p">,</span><span class="n">scores_boot</span><span class="p">,</span>
                     <span class="c1">#boot_scatter=True,</span>
                     <span class="c1">#boot_group_ellipses=True,</span>
                     <span class="n">group_ellipses</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">class_names</span><span class="o">=</span><span class="n">names_unique</span><span class="p">,</span>
                     <span class="n">group_tags</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="p">)</span>
<span class="n">pca_uncertainty_plot</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">colors</span><span class="p">,</span><span class="n">class_y_train</span><span class="p">,</span><span class="n">scores</span><span class="p">,</span><span class="n">class_boot</span><span class="p">,</span><span class="n">scores_boot</span><span class="p">,</span>
                     <span class="c1">#sample_ellipses=True,</span>
                     <span class="n">boot_scatter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">boot_group_ellipses</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">group_ellipses</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">class_names</span><span class="o">=</span><span class="n">names_unique</span><span class="p">,</span>
                     <span class="n">group_tags</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="c1">#legend=True</span>
                    <span class="p">)</span>

<span class="n">xlims</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
<span class="n">ylims</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlims</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">)</span>

<span class="n">textstring</span> <span class="o">=</span> <span class="s1">&#39;Scores on Component </span><span class="si">{}</span><span class="s1">: </span><span class="si">{:5.2f}</span><span class="s1"> %&#39;</span>
<span class="n">figure5</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.03</span><span class="p">,</span><span class="n">textstring</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_comp</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PCA2</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="n">x_comp</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">figure5</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="n">textstring</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y_comp</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PCA2</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="n">y_comp</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span>
            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="s1">&#39;a)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="s1">&#39;b)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

<span class="n">figure5</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figure5.png&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">figure_save_keys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_25_0.png" src="_images/run_environmental_pls-Copy1_25_0.png" />
</div>
</div>
<p>Figure 5</p>
</div>
<hr class="docutils" />
<div class="section" id="PCA-loadings-and-uncertainty">
<h4>PCA loadings and uncertainty<a class="headerlink" href="#PCA-loadings-and-uncertainty" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#figure3,axes = plt.subplots(2,3,sharey=True,figsize=(12,5),gridspec_kw=gs_kw)</span>
<span class="n">figure6</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">make_grid_plot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">column_width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">row_height</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
                              <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">xlabel_buffer</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ylabel_buffer</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                              <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency shift / $10^{-6}$ (ppm)&#39;</span><span class="p">,</span>
                              <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Loading intensity and uncertainty (a.u.)&#39;</span><span class="p">,</span>
                              <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">)</span>

<span class="c1">#axes.flatten()[0].set_ylabel(&#39;95 % confidence\nlimit (a.u.)&#39;,size=15)</span>
<span class="c1">#figure3.text(-0.02,0.5,&#39;Loading intensity and uncertainty (a.u.)&#39;,size=15,rotation=&#39;vertical&#39;,va=&#39;center&#39;)</span>
<span class="c1">#figure3.text(0.5,0.0,&#39;Frequency shift / $10^{-6}$ (ppm)&#39;,ha=&quot;center&quot;,va=&quot;center&quot;,size=15)</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span><span class="n">component</span><span class="p">,</span><span class="n">comp_num</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">PCA2</span><span class="o">.</span><span class="n">components_</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]):</span>

    <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">comps_boot</span><span class="p">[</span><span class="n">comp_num</span><span class="p">::</span><span class="n">nco</span><span class="p">],</span><span class="mf">97.5</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ci_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">comps_boot</span><span class="p">[</span><span class="n">comp_num</span><span class="p">::</span><span class="n">nco</span><span class="p">],</span><span class="mf">2.5</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">_x_data</span><span class="p">,</span><span class="n">component</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">_x_data</span><span class="p">,(</span><span class="n">ci_upper</span> <span class="o">-</span> <span class="n">ci_lower</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,(</span><span class="n">ci_lower</span> <span class="o">-</span> <span class="n">ci_upper</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1">#p = ax.plot(synthetic_samples_project._x_data,(ci_upper - ci_lower)/2,color=&#39;r&#39;)</span>
    <span class="c1">#p = ax.plot(synthetic_samples_project._x_data,(ci_lower - ci_upper)/2,color=&#39;r&#39;)</span>
    <span class="c1">#p = ax.plot(synthetic_samples_project._x_data,ci_lower - component)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="k">for</span> <span class="n">num</span><span class="p">,</span><span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.65</span><span class="p">,</span><span class="s1">&#39;PC&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">9.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="s1">&#39;Nic. Acid&#39;</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">6.7</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="s1">&#39;Fumarate&#39;</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">5.4</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="s1">&#39;Glucose&#39;</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="s1">&#39;Citrate&#39;</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">2.2</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="s1">&#39;Glutamine&#39;</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.55</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="s1">&#39;Alanine&#39;</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">)</span>
<span class="c1">#axes.flatten()[0].text(0.3,0.22,&#39;PC1&#39;,ha=&#39;right&#39;)</span>
<span class="c1">#axes.flatten()[1].text(0.3,0.22,&#39;PC2&#39;,ha=&#39;right&#39;)</span>
<span class="c1">#figure3.tight_layout()</span>
<span class="n">figure6</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figure6.png&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">figure_save_keys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_28_0.png" src="_images/run_environmental_pls-Copy1_28_0.png" />
</div>
</div>
<p>Figure 6</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="Uncertainty-analysis-on-supervised-learning">
<h2>Uncertainty analysis on supervised learning<a class="headerlink" href="#Uncertainty-analysis-on-supervised-learning" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Biological-sample-data">
<h3>Biological sample data<a class="headerlink" href="#Biological-sample-data" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bio_samples_project</span> <span class="o">=</span> <span class="n">qmet</span><span class="o">.</span><span class="n">Project</span><span class="p">(</span><span class="n">x_data_list</span><span class="o">=</span><span class="n">peakPPM_full</span><span class="p">,</span>
                                    <span class="n">Sample_names</span><span class="o">=</span><span class="n">Bio_Spectrum_names</span><span class="p">,</span>
                                    <span class="n">Data_set_names</span><span class="o">=</span><span class="n">Labels</span><span class="p">,</span>
                                    <span class="n">distance_metric_dict</span><span class="o">=</span><span class="n">nmr_distance_metrics</span><span class="p">,</span>
                                    <span class="n">range_to_use</span><span class="o">=</span><span class="n">bio_range_to_use</span>
                                   <span class="p">)</span>
<span class="n">numsets</span> <span class="o">=</span> <span class="n">bio_samples_project</span><span class="o">.</span><span class="n">_positional_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">numspecs</span> <span class="o">=</span> <span class="n">bio_samples_project</span><span class="o">.</span><span class="n">_positional_array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">bio_samples_project</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">bio_data_file_name</span>
<span class="n">names</span> <span class="o">=</span> <span class="n">Bio_Spectrum_names</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
bio.test
</pre></div></div>
</div>
<div class="section" id="Split-out-the-consensus-laboratories">
<h4>Split out the consensus laboratories<a class="headerlink" href="#Split-out-the-consensus-laboratories" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Pos_good</span> <span class="o">=</span> <span class="n">bio_samples_project</span><span class="o">.</span><span class="n">_positional_array</span><span class="p">[</span><span class="n">outlier_mask</span><span class="p">]</span>
<span class="n">good_data_range</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">data_range</span> <span class="ow">in</span> <span class="n">Pos_good</span><span class="p">:</span>
    <span class="n">good_data_range</span> <span class="o">+=</span> <span class="nb">range</span><span class="p">(</span><span class="n">data_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">data_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">bio_samples_project</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">good_data_range</span><span class="p">])</span>

<span class="n">scaling_mean</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#scaling_std = complete_data.std(axis=0)</span>

<span class="n">train_data_scale</span> <span class="o">=</span> <span class="p">(</span><span class="n">train_data</span> <span class="o">-</span> <span class="n">scaling_mean</span><span class="p">)</span>

<span class="n">num_train</span> <span class="o">=</span> <span class="n">train_data_scale</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">groups_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">outlier_mask</span><span class="p">)),</span><span class="nb">len</span><span class="p">(</span><span class="n">Bio_Spectrum_names</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">class_names</span> <span class="o">=</span> <span class="n">Bio_Spectrum_names</span> <span class="o">*</span> <span class="n">numsets</span>
<span class="n">class_y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_train</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>

<span class="k">for</span> <span class="n">sample_num</span><span class="p">,</span><span class="n">class_string</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_train</span><span class="p">),</span><span class="n">class_names</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">class_string</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;E&#39;</span><span class="p">:</span>
        <span class="n">class_y_train</span><span class="p">[</span><span class="n">sample_num</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">control_mask</span> <span class="o">=</span> <span class="n">class_y_train</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">exposed_mask</span> <span class="o">=</span> <span class="n">class_y_train</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Representative-data">
<h4>Representative data<a class="headerlink" href="#Representative-data" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">figure7</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">2.5</span><span class="p">))</span>

<span class="n">labels</span> <span class="o">=</span>  <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>

<span class="nb">print</span> <span class="p">(</span><span class="n">train_data_scale</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">for</span> <span class="n">num</span><span class="p">,</span><span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="n">labels</span><span class="p">]):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bio_samples_project</span><span class="o">.</span><span class="n">_x_data</span><span class="p">,(</span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="o">*-</span><span class="mi">35</span><span class="p">)</span><span class="o">+</span><span class="n">num</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="o">-</span><span class="mf">0.8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)))</span>
<span class="c1">#ax.yaxis.tick_right()</span>

<span class="k">for</span> <span class="n">num</span><span class="p">,</span><span class="n">tx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">names</span><span class="p">)[</span><span class="n">labels</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">9.7</span><span class="p">,</span><span class="n">num</span> <span class="o">-</span> <span class="mf">0.3</span><span class="p">,</span><span class="n">tx</span><span class="p">)</span>

<span class="c1">#ax.set_yticklabels(np.array(names)[[1,6,7]])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity (a.u.)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency shift / 10$^{-6}$ (ppm)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="n">figure7</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figure7.png&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">figure_save_keys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(4, 1761)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_38_1.png" src="_images/run_environmental_pls-Copy1_38_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">figure7</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">2.5</span><span class="p">))</span>

<span class="n">labels</span> <span class="o">=</span>  <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>

<span class="nb">print</span> <span class="p">(</span><span class="n">train_data_scale</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">for</span> <span class="n">num</span><span class="p">,</span><span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="n">labels</span><span class="p">]):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bio_samples_project</span><span class="o">.</span><span class="n">_x_data</span><span class="p">,(</span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="o">*-</span><span class="mi">35</span><span class="p">)</span><span class="o">+</span><span class="n">num</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="o">-</span><span class="mf">0.8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)))</span>
<span class="c1">#ax.yaxis.tick_right()</span>

<span class="k">for</span> <span class="n">num</span><span class="p">,</span><span class="n">tx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">names</span><span class="p">)[</span><span class="n">labels</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">4.7</span><span class="p">,</span><span class="n">num</span> <span class="o">-</span> <span class="mf">0.3</span><span class="p">,</span><span class="n">tx</span><span class="p">)</span>

<span class="c1">#ax.set_yticklabels(np.array(names)[[1,6,7]])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity (a.u.)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency shift / 10$^{-6}$ (ppm)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="n">figure7</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figure7.png&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">figure_save_keys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(4, 1761)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_39_1.png" src="_images/run_environmental_pls-Copy1_39_1.png" />
</div>
</div>
<p>Figure 7</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="Partial-least-squares">
<h3>Partial least squares<a class="headerlink" href="#Partial-least-squares" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Fit the PLS model with no uncertainty</span>
<span class="n">pls_components</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">PLS_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">pls_components</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1500</span><span class="p">)</span>
<span class="n">this_PLS</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">cross_decomposition</span><span class="o">.</span><span class="n">PLSRegression</span><span class="p">(</span><span class="o">**</span><span class="n">PLS_dict</span><span class="p">)</span>
<span class="n">tpls</span> <span class="o">=</span> <span class="n">this_PLS</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data_scale</span><span class="p">,</span><span class="n">class_y_train</span><span class="p">)</span>

<span class="n">predicted_class</span> <span class="o">=</span> <span class="n">this_PLS</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">train_data_scale</span><span class="p">)</span>

<span class="n">T_train</span> <span class="o">=</span> <span class="n">this_PLS</span><span class="o">.</span><span class="n">x_scores_</span>
<span class="n">U_train</span> <span class="o">=</span> <span class="n">this_PLS</span><span class="o">.</span><span class="n">y_scores_</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">this_PLS</span><span class="o">.</span><span class="n">x_loadings_</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">this_PLS</span><span class="o">.</span><span class="n">y_loadings_</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">this_PLS</span><span class="o">.</span><span class="n">x_weights_</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">this_PLS</span><span class="o">.</span><span class="n">y_weights_</span>

<span class="n">class_predicted_train</span> <span class="o">=</span> <span class="n">this_PLS</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">train_data_scale</span><span class="p">)</span>
<span class="n">class_value</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">estimate_class_boundary</span><span class="p">(</span><span class="n">class_predicted_train</span><span class="p">,</span><span class="n">class_y_train</span><span class="p">)</span>
<span class="n">names</span> <span class="o">=</span> <span class="n">Bio_Spectrum_names</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Partial-least-squares-bootstrap">
<h3>Partial least squares bootstrap<a class="headerlink" href="#Partial-least-squares-bootstrap" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">nsamples</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># lbu_out = plu.bootstrap_unc(xdata=train_data_scale,ydata=class_y_train,</span>
<span class="c1">#                     cv_object=lcv,samples=nsamples,</span>
<span class="c1">#                     PLS_kw=PLS_dict,return_scores=True,tq=False)</span>

<span class="n">bio_bootstrap</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">bootstrap_estimator</span><span class="p">(</span><span class="n">samples</span><span class="o">=</span><span class="n">nsamples</span><span class="p">,</span>
                                        <span class="n">estimator</span><span class="o">=</span><span class="n">sklearn</span><span class="o">.</span><span class="n">cross_decomposition</span><span class="o">.</span><span class="n">PLSRegression</span><span class="p">,</span>
                                        <span class="n">estimator_kw</span><span class="o">=</span><span class="n">PLS_dict</span><span class="p">,</span>
                                        <span class="n">X</span><span class="o">=</span><span class="n">train_data_scale</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">class_y_train</span><span class="p">,</span>
                                        <span class="n">cv</span><span class="o">=</span><span class="n">lcv</span><span class="p">,</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bio_bootstrap</span><span class="o">.</span><span class="n">bootstrap</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bio_bootstrap</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ypred</span><span class="p">,</span><span class="n">ypboot</span><span class="p">,</span><span class="n">bounds</span><span class="p">,</span><span class="n">error</span><span class="p">,</span> <span class="o">=</span> <span class="n">bio_bootstrap</span><span class="o">.</span><span class="n">bootstrap_uncertainty_bounds</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">class_val</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">estimate_class_boundary</span><span class="p">(</span><span class="n">ypred</span><span class="p">,</span><span class="n">class_y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vals_boot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ypboot</span><span class="p">,(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">98</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="n">vals_boot</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(98, 1000)
</pre></div>
</div>
</div>
ci,vals_boot,scores_full = lbu_out<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Base colors array</span>
<span class="n">Variable_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#4444ff&#39;</span><span class="p">,</span> <span class="s1">&#39;#4444ff&#39;</span><span class="p">,</span> <span class="s1">&#39;#4444ff&#39;</span><span class="p">,</span> <span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Colors array</span>
<span class="n">fullcolors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Variable_colors</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">outlier_mask</span><span class="p">))</span>

<span class="c1">#Make the figure</span>
<span class="n">fs1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">gridspec_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">figure8</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">fs1</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gridspec_kw</span><span class="p">)</span>

<span class="n">plot_bootstrap_pls</span><span class="p">(</span><span class="n">vals_boot</span><span class="p">,</span><span class="n">class_y_train</span><span class="p">,</span><span class="n">axes_row</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span><span class="n">train_colors</span><span class="o">=</span><span class="n">fullcolors</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#nmr_bootstrap_annotate(axes[0])</span>
<span class="n">figure8</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_53_1.png" src="_images/run_environmental_pls-Copy1_53_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Colors array</span>
<span class="n">fullcolors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Variable_colors</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">outlier_mask</span><span class="p">))</span>

<span class="c1">#Make the figure</span>
<span class="n">fs1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">gridspec_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">figure8</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">fs1</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gridspec_kw</span><span class="p">)</span>

<span class="n">plot_bootstrap_pls</span><span class="p">(</span><span class="n">vals_boot</span><span class="p">,</span><span class="n">class_y_train</span><span class="p">,</span><span class="n">axes_row</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span><span class="n">train_colors</span><span class="o">=</span><span class="n">fullcolors</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">nmr_bootstrap_annotate</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">figure8</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">figure8</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figure8.png&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">figure_save_keys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_54_0.png" src="_images/run_environmental_pls-Copy1_54_0.png" />
</div>
</div>
<p>Figure 8</p>
</div>
<hr class="docutils" />
<div class="section" id="Cross-validation">
<h3>Cross-validation<a class="headerlink" href="#Cross-validation" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Cross-validation</span>
<span class="c1">#Build the cross-validation object</span>
<span class="n">test_cv</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">GroupShuffleSplit</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span><span class="n">group</span><span class="o">=</span><span class="kc">True</span>

<span class="c1">#Splits</span>
<span class="k">if</span> <span class="n">group</span><span class="p">:</span>
    <span class="n">cv_split</span> <span class="o">=</span> <span class="n">test_cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">train_data_scale</span><span class="p">,</span><span class="n">class_y_train</span><span class="p">,</span><span class="n">groups</span><span class="o">=</span><span class="n">groups_list</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">cv_split</span> <span class="o">=</span> <span class="n">test_cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">train_data_scale</span><span class="p">,</span><span class="n">class_y_train</span><span class="p">,</span><span class="n">groups</span><span class="o">=</span><span class="n">class_y_train</span><span class="p">)</span>

<span class="c1">#Get the number of plots we&#39;re going to need</span>
<span class="n">numplots</span> <span class="o">=</span> <span class="n">test_cv</span><span class="o">.</span><span class="n">n_splits</span>
<span class="n">numcols</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">numrows</span> <span class="o">=</span> <span class="n">numplots</span> <span class="o">//</span> <span class="n">numcols</span>

<span class="c1">#Build the figures</span>
<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">numrows</span><span class="p">)</span>
<span class="n">fs1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ps</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">gridspec_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">figure10</span><span class="p">,</span><span class="n">axes1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">fs1</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gridspec_kw</span><span class="p">)</span>

<span class="n">gridspec_kw</span><span class="p">[</span><span class="s1">&#39;hspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">gridspec_kw</span><span class="p">[</span><span class="s1">&#39;wspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">figureS1</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">make_grid_plot</span><span class="p">(</span><span class="n">numrows</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">plotsize</span><span class="o">=</span><span class="n">ps</span><span class="p">,</span><span class="n">xlabel_buffer</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">ylabel_buffer</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                               <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gridspec_kw</span><span class="p">,</span>
                               <span class="n">add_buffer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">figureS1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="s1">&#39;Predicted class, $XW^*Q^T$&#39;</span><span class="p">,</span>
              <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">figureS1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\mathsf</span><span class="si">{Pr}</span><span class="s1">_\mathsf</span><span class="si">{misclass}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">figureS1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="s1">&#39;Sample index (a.u.)&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,(</span><span class="n">train</span><span class="p">,</span><span class="n">test</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cv_split</span><span class="p">):</span>

    <span class="n">ntr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>

    <span class="n">xd</span> <span class="o">=</span> <span class="n">train_data_scale</span><span class="p">[</span><span class="n">train</span><span class="p">]</span>
    <span class="n">yd</span> <span class="o">=</span> <span class="n">class_y_train</span><span class="p">[</span><span class="n">train</span><span class="p">]</span>
    <span class="n">xt</span> <span class="o">=</span> <span class="n">train_data_scale</span><span class="p">[</span><span class="n">test</span><span class="p">]</span>
    <span class="n">yt</span> <span class="o">=</span> <span class="n">class_y_train</span><span class="p">[</span><span class="n">test</span><span class="p">]</span>

    <span class="n">traincolor</span> <span class="o">=</span> <span class="n">fullcolors</span><span class="p">[</span><span class="n">train</span><span class="p">]</span>
    <span class="n">testcolor</span> <span class="o">=</span> <span class="n">fullcolors</span><span class="p">[</span><span class="n">test</span><span class="p">]</span>

    <span class="n">this_boot</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">bootstrap_estimator</span><span class="p">(</span><span class="n">nsamples</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span>
                                        <span class="n">estimator</span><span class="o">=</span><span class="n">sklearn</span><span class="o">.</span><span class="n">cross_decomposition</span><span class="o">.</span><span class="n">PLSRegression</span><span class="p">,</span>
                                        <span class="n">estimator_kw</span><span class="o">=</span><span class="n">PLS_dict</span><span class="p">,</span>
                                        <span class="n">X</span><span class="o">=</span><span class="n">xd</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">yd</span><span class="p">,</span>
                                        <span class="n">cv</span><span class="o">=</span><span class="n">lcv</span><span class="p">,</span>
                                       <span class="p">)</span>
    <span class="n">this_boot</span><span class="o">.</span><span class="n">bootstrap</span><span class="p">()</span>
    <span class="n">this_boot</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="n">this_boot</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">with_boot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">train_predict</span><span class="p">,</span><span class="n">boot_train</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">e</span><span class="p">,</span> <span class="o">=</span> <span class="n">this_boot</span><span class="o">.</span><span class="n">bootstrap_uncertainty_bounds</span><span class="p">()</span>
    <span class="n">test_predict</span><span class="p">,</span><span class="n">boot_test</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">e</span> <span class="o">=</span> <span class="n">this_boot</span><span class="o">.</span><span class="n">bootstrap_uncertainty_bounds</span><span class="p">(</span><span class="n">xt</span><span class="p">)</span>

    <span class="n">boot_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">boot_train</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">boot_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">boot_test</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

    <span class="n">plot_bootstrap_pls</span><span class="p">(</span><span class="n">boot_train</span><span class="p">,</span>
                       <span class="n">yd</span><span class="p">,</span><span class="n">test_data</span><span class="o">=</span><span class="n">boot_test</span><span class="p">,</span>
                       <span class="n">y_test</span><span class="o">=</span><span class="n">yt</span><span class="p">,</span><span class="n">train_colors</span><span class="o">=</span><span class="n">fullcolors</span><span class="p">,</span><span class="n">axes_row</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">],</span><span class="n">group</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">mcax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">mcax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="n">test_boundary</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ntr</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="c1">#ax.legend_.remove()</span>
    <span class="c1">#ax.text(5,1.7,&quot;Cross-validation training&quot;,size=12,bbox=dict(edgecolor=&#39;white&#39;,facecolor=&#39;white&#39;, alpha=1))</span>
    <span class="c1">#ax.text(ntr+5,1.7,&quot;Cross-validation test&quot;,size=12,bbox=dict(edgecolor=&#39;white&#39;,facecolor=&#39;white&#39;, alpha=1))</span>

    <span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plot_bootstrap_pls</span><span class="p">(</span><span class="n">boot_train</span><span class="p">,</span><span class="n">yd</span><span class="p">,</span><span class="n">test_data</span><span class="o">=</span><span class="n">boot_test</span><span class="p">,</span>
                           <span class="n">y_test</span><span class="o">=</span><span class="n">yt</span><span class="p">,</span><span class="n">train_colors</span><span class="o">=</span><span class="n">fullcolors</span><span class="p">,</span><span class="n">axes_row</span><span class="o">=</span><span class="n">axes1</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">nmr_bootstrap_annotate</span><span class="p">(</span><span class="n">axes1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">misclass_legend</span><span class="p">(</span><span class="n">axes1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="n">test_boundary</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ntr</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.7</span><span class="p">,</span><span class="s2">&quot;Cross-validation training&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">ntr</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.7</span><span class="p">,</span><span class="s2">&quot;Cross-validation test&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#break</span>
        <span class="k">pass</span>
<span class="n">figure10</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_57_0.png" src="_images/run_environmental_pls-Copy1_57_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_57_1.png" src="_images/run_environmental_pls-Copy1_57_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Cross-validation</span>
<span class="c1">#Build the cross-validation object</span>
<span class="n">test_cv</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">GroupShuffleSplit</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span><span class="n">group</span><span class="o">=</span><span class="kc">True</span>

<span class="c1">#Splits</span>
<span class="k">if</span> <span class="n">group</span><span class="p">:</span>
    <span class="n">cv_split</span> <span class="o">=</span> <span class="n">test_cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">train_data_scale</span><span class="p">,</span><span class="n">class_y_train</span><span class="p">,</span><span class="n">groups</span><span class="o">=</span><span class="n">groups_list</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">cv_split</span> <span class="o">=</span> <span class="n">test_cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">train_data_scale</span><span class="p">,</span><span class="n">class_y_train</span><span class="p">,</span><span class="n">groups</span><span class="o">=</span><span class="n">class_y_train</span><span class="p">)</span>

<span class="c1">#Get the number of plots we&#39;re going to need</span>
<span class="n">numplots</span> <span class="o">=</span> <span class="n">test_cv</span><span class="o">.</span><span class="n">n_splits</span>
<span class="n">numcols</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">numrows</span> <span class="o">=</span> <span class="n">numplots</span> <span class="o">//</span> <span class="n">numcols</span>

<span class="c1">#Build the figures</span>
<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">numrows</span><span class="p">)</span>
<span class="n">fs1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ps</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">gridspec_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">figure10</span><span class="p">,</span><span class="n">axes1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">fs1</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gridspec_kw</span><span class="p">)</span>

<span class="n">gridspec_kw</span><span class="p">[</span><span class="s1">&#39;hspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">gridspec_kw</span><span class="p">[</span><span class="s1">&#39;wspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">figureS1</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">make_grid_plot</span><span class="p">(</span><span class="n">numrows</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">plotsize</span><span class="o">=</span><span class="n">ps</span><span class="p">,</span><span class="n">xlabel_buffer</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">ylabel_buffer</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                               <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gridspec_kw</span><span class="p">,</span>
                               <span class="n">add_buffer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">figureS1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="s1">&#39;Predicted class, $XW^*Q^T$&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">figureS1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\mathsf</span><span class="si">{Pr}</span><span class="s1">_\mathsf</span><span class="si">{misclass}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">figureS1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="s1">&#39;Sample index (a.u.)&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>


<span class="c1"># if group:</span>
<span class="c1">#     cv_split = test_cv.split(train_data_scale,class_y_train,groups=groups_list)</span>
<span class="c1"># else:</span>
<span class="c1">#     cv_split = test_cv.split(train_data_scale,class_y_train,groups=class_y_train)</span>

<span class="c1">#Iterate over the splits in the cross-validator</span>
<span class="k">for</span> <span class="n">row</span><span class="p">,(</span><span class="n">train</span><span class="p">,</span><span class="n">test</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cv_split</span><span class="p">):</span>

    <span class="n">tpls</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">cross_decomposition</span><span class="o">.</span><span class="n">PLSRegression</span><span class="p">(</span><span class="o">**</span><span class="n">PLS_dict</span><span class="p">)</span>

    <span class="n">ntr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>

    <span class="c1">#Break into test and training sets</span>
    <span class="n">xd</span> <span class="o">=</span> <span class="n">train_data_scale</span><span class="p">[</span><span class="n">train</span><span class="p">]</span>
    <span class="n">yd</span> <span class="o">=</span> <span class="n">class_y_train</span><span class="p">[</span><span class="n">train</span><span class="p">]</span>
    <span class="n">xt</span> <span class="o">=</span> <span class="n">train_data_scale</span><span class="p">[</span><span class="n">test</span><span class="p">]</span>
    <span class="n">yt</span> <span class="o">=</span> <span class="n">class_y_train</span><span class="p">[</span><span class="n">test</span><span class="p">]</span>

    <span class="n">traincolor</span> <span class="o">=</span> <span class="n">fullcolors</span><span class="p">[</span><span class="n">train</span><span class="p">]</span>
    <span class="n">testcolor</span> <span class="o">=</span> <span class="n">fullcolors</span><span class="p">[</span><span class="n">test</span><span class="p">]</span>


    <span class="c1">#Bootstrap on the training set, get uncertainties in the test set</span>
    <span class="n">lbt_out</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">bootstrap</span><span class="p">(</span><span class="n">xdata</span><span class="o">=</span><span class="n">xd</span><span class="p">,</span><span class="n">ydata</span><span class="o">=</span><span class="n">yd</span><span class="p">,</span><span class="n">validdata</span><span class="o">=</span><span class="n">xt</span><span class="p">,</span><span class="n">PLS_kw</span><span class="o">=</span><span class="n">PLS_dict</span><span class="p">,</span><span class="n">samples</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span><span class="n">tq</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">rcv</span><span class="p">,</span><span class="n">ecv</span><span class="p">,</span><span class="n">msecv</span><span class="p">,</span><span class="n">boot_train</span><span class="p">,</span><span class="n">train_predict</span><span class="p">,</span><span class="n">boot_test</span> <span class="o">=</span> <span class="n">lbt_out</span>

    <span class="c1">#Call the bootstrap generation function</span>
    <span class="n">plot_bootstrap_pls</span><span class="p">(</span><span class="n">boot_train</span><span class="p">,</span><span class="n">yd</span><span class="p">,</span><span class="n">test_data</span><span class="o">=</span><span class="n">boot_test</span><span class="p">,</span><span class="n">y_test</span><span class="o">=</span><span class="n">yt</span><span class="p">,</span><span class="n">train_colors</span><span class="o">=</span><span class="n">fullcolors</span><span class="p">,</span><span class="n">axes_row</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">],</span><span class="n">group</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1">#Change the default labels and y limits</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">mcax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">mcax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="n">test_boundary</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ntr</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="c1">#ax.legend_.remove()</span>
    <span class="c1">#ax.text(5,1.7,&quot;Cross-validation training&quot;,size=12,bbox=dict(edgecolor=&#39;white&#39;,facecolor=&#39;white&#39;, alpha=1))</span>
    <span class="c1">#ax.text(ntr+5,1.7,&quot;Cross-validation test&quot;,size=12,bbox=dict(edgecolor=&#39;white&#39;,facecolor=&#39;white&#39;, alpha=1))</span>

    <span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plot_bootstrap_pls</span><span class="p">(</span><span class="n">boot_train</span><span class="p">,</span><span class="n">yd</span><span class="p">,</span><span class="n">test_data</span><span class="o">=</span><span class="n">boot_test</span><span class="p">,</span>
                           <span class="n">y_test</span><span class="o">=</span><span class="n">yt</span><span class="p">,</span><span class="n">train_colors</span><span class="o">=</span><span class="n">fullcolors</span><span class="p">,</span><span class="n">axes_row</span><span class="o">=</span><span class="n">axes1</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">nmr_bootstrap_annotate</span><span class="p">(</span><span class="n">axes1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">misclass_legend</span><span class="p">(</span><span class="n">axes1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="n">test_boundary</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ntr</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.7</span><span class="p">,</span><span class="s2">&quot;Cross-validation training&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">ntr</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.7</span><span class="p">,</span><span class="s2">&quot;Cross-validation test&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#break</span>
        <span class="k">pass</span>
<span class="n">figure10</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">figureS1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figureS1.png&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">figure_save_keys</span><span class="p">)</span>
<span class="n">figure10</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figure10.png&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">figure_save_keys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_58_0.png" src="_images/run_environmental_pls-Copy1_58_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_58_1.png" src="_images/run_environmental_pls-Copy1_58_1.png" />
</div>
</div>
<p>Figure 7 &amp; Figure S1</p>
<hr class="docutils" />
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Redo uncertainty analysis and save it for the Fig 9 plot</span>
<span class="n">lb9_out</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">bootstrap</span><span class="p">(</span><span class="n">xdata</span><span class="o">=</span><span class="n">train_data_scale</span><span class="p">,</span><span class="n">ydata</span><span class="o">=</span><span class="n">class_y_train</span><span class="p">,</span>
                          <span class="n">PLS_kw</span><span class="o">=</span><span class="n">PLS_dict</span><span class="p">,</span><span class="n">return_scores</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">return_loadings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span><span class="n">tq</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="PLS-uncertainty-without-consensus-analysis">
<h3>PLS uncertainty without consensus analysis<a class="headerlink" href="#PLS-uncertainty-without-consensus-analysis" title="Permalink to this headline">¶</a></h3>
<div class="section" id="Partial-least-squares">
<h4>Partial least squares<a class="headerlink" href="#Partial-least-squares" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Set the outlier mask to be all True</span>
<span class="n">outlier_mask</span><span class="p">[</span><span class="o">~</span><span class="n">outlier_mask</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1">#Split out the outlier laboratories. There actually aren&#39;t any, but keep this step for completeness</span>
<span class="n">Pos_good</span> <span class="o">=</span> <span class="n">bio_samples_project</span><span class="o">.</span><span class="n">_positional_array</span><span class="p">[</span><span class="n">outlier_mask</span><span class="p">]</span>
<span class="n">good_data_range</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">data_range</span> <span class="ow">in</span> <span class="n">Pos_good</span><span class="p">:</span>
    <span class="n">good_data_range</span> <span class="o">+=</span> <span class="nb">range</span><span class="p">(</span><span class="n">data_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">data_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">train_data</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">bio_samples_project</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">good_data_range</span><span class="p">])</span>

<span class="n">scaling_mean</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#scaling_std = complete_data.std(axis=0)</span>

<span class="n">train_data_scale</span> <span class="o">=</span> <span class="p">(</span><span class="n">train_data</span> <span class="o">-</span> <span class="n">scaling_mean</span><span class="p">)</span>

<span class="n">num_train</span> <span class="o">=</span> <span class="n">train_data_scale</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">groups_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">outlier_mask</span><span class="p">)),</span><span class="nb">len</span><span class="p">(</span><span class="n">Bio_Spectrum_names</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">class_names</span> <span class="o">=</span> <span class="n">Bio_Spectrum_names</span> <span class="o">*</span> <span class="n">numsets</span>
<span class="n">class_y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_train</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>

<span class="k">for</span> <span class="n">sample_num</span><span class="p">,</span><span class="n">class_string</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_train</span><span class="p">),</span><span class="n">class_names</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">class_string</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;E&#39;</span><span class="p">:</span>
        <span class="n">class_y_train</span><span class="p">[</span><span class="n">sample_num</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">control_mask</span> <span class="o">=</span> <span class="n">class_y_train</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">exposed_mask</span> <span class="o">=</span> <span class="n">class_y_train</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pls_components</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">PLS_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">pls_components</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1500</span><span class="p">)</span>
<span class="n">this_PLS</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">cross_decomposition</span><span class="o">.</span><span class="n">PLSRegression</span><span class="p">(</span><span class="o">**</span><span class="n">PLS_dict</span><span class="p">)</span>
<span class="n">tpls</span> <span class="o">=</span> <span class="n">this_PLS</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data_scale</span><span class="p">,</span><span class="n">class_y_train</span><span class="p">)</span>

<span class="n">class_predicted_train</span> <span class="o">=</span> <span class="n">this_PLS</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">train_data_scale</span><span class="p">)</span>
<span class="n">class_value</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">estimate_class_boundary</span><span class="p">(</span><span class="n">class_predicted_train</span><span class="p">,</span><span class="n">class_y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Partial-least-squares-bootstrap">
<h4>Partial least squares bootstrap<a class="headerlink" href="#Partial-least-squares-bootstrap" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">nsamples</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># lbu_out = plu.bootstrap_unc(xdata=train_data_scale,ydata=class_y_train,</span>
<span class="c1">#                     cv_object=lcv,samples=nsamples,</span>
<span class="c1">#                     PLS_kw=PLS_dict,return_scores=True,tq=False)</span>

<span class="n">bio_bootstrap_no_consensus</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">bootstrap_estimator</span><span class="p">(</span><span class="n">samples</span><span class="o">=</span><span class="n">nsamples</span><span class="p">,</span>
                                        <span class="n">estimator</span><span class="o">=</span><span class="n">sklearn</span><span class="o">.</span><span class="n">cross_decomposition</span><span class="o">.</span><span class="n">PLSRegression</span><span class="p">,</span>
                                        <span class="n">estimator_kw</span><span class="o">=</span><span class="n">PLS_dict</span><span class="p">,</span>
                                        <span class="n">X</span><span class="o">=</span><span class="n">train_data_scale</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">class_y_train</span><span class="p">,</span>
                                        <span class="n">cv</span><span class="o">=</span><span class="n">lcv</span><span class="p">,</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bio_bootstrap_no_consensus</span><span class="o">.</span><span class="n">bootstrap</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bio_bootstrap_no_consensus</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ypred</span><span class="p">,</span><span class="n">ypboot</span><span class="p">,</span><span class="n">bounds</span><span class="p">,</span><span class="n">error</span><span class="p">,</span> <span class="o">=</span> <span class="n">bio_bootstrap_no_consensus</span><span class="o">.</span><span class="n">bootstrap_uncertainty_bounds</span><span class="p">()</span>
</pre></div>
</div>
</div>
lbc_out = plu.bootstrap_unc(xdata=train_data_scale,ydata=class_y_train,
                    cv_object=lcv,samples=nsamples,
                    PLS_kw=PLS_dict,return_scores=True,tq=False)<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vals_boot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">ypboot</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">vals_boot</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(140, 1000)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#ci,vals_boot,scores_full = lbc_out</span>
<span class="c1">#Colors array</span>
<span class="n">fullcolors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Variable_colors</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">outlier_mask</span><span class="p">))</span>

<span class="c1">#Make the figure</span>
<span class="n">fs1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">gridspec_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">figure9</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">fs1</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gridspec_kw</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">class_y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vals_boot</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_data_scale</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">plot_bootstrap_pls</span><span class="p">(</span><span class="n">vals_boot</span><span class="p">,</span><span class="n">class_y_train</span><span class="p">,</span><span class="n">axes_row</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span><span class="n">train_colors</span><span class="o">=</span><span class="n">fullcolors</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">nmr_bootstrap_annotate</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">figure9</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">figure9</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figure9.png&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">figure_save_keys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(140,)
(140, 1000)
(140, 1761)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_75_1.png" src="_images/run_environmental_pls-Copy1_75_1.png" />
</div>
</div>
<p>Figure 9</p>
</div>
<hr class="docutils" />
<div class="section" id="Cross-validation">
<h4>Cross-validation<a class="headerlink" href="#Cross-validation" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Cross-validation</span>
<span class="c1">#Build the cross-validation object</span>
<span class="n">test_cv</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">GroupShuffleSplit</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span><span class="n">group</span><span class="o">=</span><span class="kc">True</span>

<span class="c1">#Splits</span>
<span class="k">if</span> <span class="n">group</span><span class="p">:</span>
    <span class="n">cv_split</span> <span class="o">=</span> <span class="n">test_cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">train_data_scale</span><span class="p">,</span><span class="n">class_y_train</span><span class="p">,</span><span class="n">groups</span><span class="o">=</span><span class="n">groups_list</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">cv_split</span> <span class="o">=</span> <span class="n">test_cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">train_data_scale</span><span class="p">,</span><span class="n">class_y_train</span><span class="p">,</span><span class="n">groups</span><span class="o">=</span><span class="n">class_y_train</span><span class="p">)</span>

<span class="c1">#Get the number of plots we&#39;re going to need</span>
<span class="n">numplots</span> <span class="o">=</span> <span class="n">test_cv</span><span class="o">.</span><span class="n">n_splits</span>
<span class="n">numcols</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">numrows</span> <span class="o">=</span> <span class="n">numplots</span> <span class="o">//</span> <span class="n">numcols</span>

<span class="c1">#Build the figures</span>
<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">numrows</span><span class="p">)</span>
<span class="n">fs1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ps</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">gridspec_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">figure11</span><span class="p">,</span><span class="n">axes1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">fs1</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gridspec_kw</span><span class="p">)</span>

<span class="n">gridspec_kw</span><span class="p">[</span><span class="s1">&#39;hspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">gridspec_kw</span><span class="p">[</span><span class="s1">&#39;wspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">figureS2</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">make_grid_plot</span><span class="p">(</span><span class="n">numrows</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">plotsize</span><span class="o">=</span><span class="n">ps</span><span class="p">,</span><span class="n">xlabel_buffer</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">ylabel_buffer</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                               <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gridspec_kw</span><span class="p">,</span><span class="n">add_buffer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">figureS2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="s1">&#39;Predicted class, $XW^*Q^T$&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">figureS2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\mathsf</span><span class="si">{Pr}</span><span class="s1">_\mathsf</span><span class="si">{misclass}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">figureS2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="s1">&#39;Sample index (a.u.)&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1">#Iterate over the splits in the cross-validator</span>
<span class="k">for</span> <span class="n">row</span><span class="p">,(</span><span class="n">train</span><span class="p">,</span><span class="n">test</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cv_split</span><span class="p">):</span>

    <span class="n">tpls</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">cross_decomposition</span><span class="o">.</span><span class="n">PLSRegression</span><span class="p">(</span><span class="o">**</span><span class="n">PLS_dict</span><span class="p">)</span>

    <span class="n">ntr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>

    <span class="c1">#Break into test and training sets</span>
    <span class="n">xd</span> <span class="o">=</span> <span class="n">train_data_scale</span><span class="p">[</span><span class="n">train</span><span class="p">]</span>
    <span class="n">yd</span> <span class="o">=</span> <span class="n">class_y_train</span><span class="p">[</span><span class="n">train</span><span class="p">]</span>
    <span class="n">xt</span> <span class="o">=</span> <span class="n">train_data_scale</span><span class="p">[</span><span class="n">test</span><span class="p">]</span>
    <span class="n">yt</span> <span class="o">=</span> <span class="n">class_y_train</span><span class="p">[</span><span class="n">test</span><span class="p">]</span>

    <span class="n">traincolor</span> <span class="o">=</span> <span class="n">fullcolors</span><span class="p">[</span><span class="n">train</span><span class="p">]</span>
    <span class="n">testcolor</span> <span class="o">=</span> <span class="n">fullcolors</span><span class="p">[</span><span class="n">test</span><span class="p">]</span>

    <span class="n">this_boot</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">bootstrap_estimator</span><span class="p">(</span><span class="n">nsamples</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span>
                                        <span class="n">estimator</span><span class="o">=</span><span class="n">sklearn</span><span class="o">.</span><span class="n">cross_decomposition</span><span class="o">.</span><span class="n">PLSRegression</span><span class="p">,</span>
                                        <span class="n">estimator_kw</span><span class="o">=</span><span class="n">PLS_dict</span><span class="p">,</span>
                                        <span class="n">X</span><span class="o">=</span><span class="n">xd</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">yd</span><span class="p">,</span>
                                        <span class="n">cv</span><span class="o">=</span><span class="n">lcv</span><span class="p">,</span>
                                       <span class="p">)</span>
    <span class="n">this_boot</span><span class="o">.</span><span class="n">bootstrap</span><span class="p">()</span>
    <span class="n">this_boot</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="n">this_boot</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">with_boot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">train_predict</span><span class="p">,</span><span class="n">boot_train</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">e</span><span class="p">,</span> <span class="o">=</span> <span class="n">this_boot</span><span class="o">.</span><span class="n">bootstrap_uncertainty_bounds</span><span class="p">()</span>
    <span class="n">test_predict</span><span class="p">,</span><span class="n">boot_test</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">e</span> <span class="o">=</span> <span class="n">this_boot</span><span class="o">.</span><span class="n">bootstrap_uncertainty_bounds</span><span class="p">(</span><span class="n">xt</span><span class="p">)</span>

    <span class="n">boot_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">boot_train</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">boot_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">boot_test</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

    <span class="c1">#Call the bootstrap generation function</span>
    <span class="n">plot_bootstrap_pls</span><span class="p">(</span><span class="n">boot_train</span><span class="p">,</span><span class="n">yd</span><span class="p">,</span><span class="n">test_data</span><span class="o">=</span><span class="n">boot_test</span><span class="p">,</span><span class="n">y_test</span><span class="o">=</span><span class="n">yt</span><span class="p">,</span><span class="n">train_colors</span><span class="o">=</span><span class="n">fullcolors</span><span class="p">,</span><span class="n">axes_row</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">],</span><span class="n">group</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1">#Change the default labels and y limits</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">mcax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">mcax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="n">test_boundary</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ntr</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="c1">#ax.text(5,1.7,&quot;Cross-validation training&quot;,size=12,bbox=dict(edgecolor=&#39;white&#39;,facecolor=&#39;white&#39;, alpha=1))</span>
    <span class="c1">#ax.text(ntr+5,1.7,&quot;Cross-validation test&quot;,size=12,bbox=dict(edgecolor=&#39;white&#39;,facecolor=&#39;white&#39;, alpha=1))</span>

    <span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plot_bootstrap_pls</span><span class="p">(</span><span class="n">boot_train</span><span class="p">,</span><span class="n">yd</span><span class="p">,</span><span class="n">test_data</span><span class="o">=</span><span class="n">boot_test</span><span class="p">,</span><span class="n">y_test</span><span class="o">=</span><span class="n">yt</span><span class="p">,</span><span class="n">train_colors</span><span class="o">=</span><span class="n">fullcolors</span><span class="p">,</span><span class="n">axes_row</span><span class="o">=</span><span class="n">axes1</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">nmr_bootstrap_annotate</span><span class="p">(</span><span class="n">axes1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">misclass_legend</span><span class="p">(</span><span class="n">axes1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="n">test_boundary</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ntr</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.7</span><span class="p">,</span><span class="s2">&quot;Cross-validation training&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">ntr</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.7</span><span class="p">,</span><span class="s2">&quot;Cross-validation test&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#break</span>
        <span class="k">pass</span>
<span class="n">figure11</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">figureS2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figureS2.png&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">figure_save_keys</span><span class="p">)</span>
<span class="n">figure11</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figure11.png&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">figure_save_keys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_79_0.png" src="_images/run_environmental_pls-Copy1_79_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_79_1.png" src="_images/run_environmental_pls-Copy1_79_1.png" />
</div>
</div>
#Cross-validation
#Build the cross-validation object
test_cv = sklearn.model_selection.GroupShuffleSplit(n_splits=10,test_size=0.3,random_state=0);group=True

#Splits
if group:
    cv_split = test_cv.split(train_data_scale,class_y_train,groups=groups_list)
else:
    cv_split = test_cv.split(train_data_scale,class_y_train,groups=class_y_train)

#Get the number of plots we're going to need
numplots = test_cv.n_splits
numcols = 1
numrows = numplots // numcols

#Build the figures
fs = (10,1*numrows)
fs1 = (10,4)
ps=(5,1)

gridspec_kw = dict(width_ratios=[4,1])
figure11,axes1 = plt.subplots(1,2,figsize=fs1,sharex='col',sharey=True,gridspec_kw=gridspec_kw)

gridspec_kw['hspace'] = 0
gridspec_kw['wspace'] = 0.05
figureS2,axes = make_grid_plot(numrows,2,plotsize=ps,xlabel_buffer=0.4,ylabel_buffer=0.4,
                               sharex='col',sharey=True,gridspec_kw=gridspec_kw,add_buffer=True)

figureS2.text(0.0,0.5,'Predicted class, $XW^*Q^T$',ha='center',va='center',rotation='vertical',size=20)
figureS2.text(0.9,0.0,r'$\mathsf{Pr}_\mathsf{misclass}$',ha='center',va='center',size=20)
figureS2.text(0.4,0.0,'Sample index (a.u.)',ha='center',va='center',size=20)
#Iterate over the splits in the cross-validator
for row,(train,test) in enumerate(cv_split):

    tpls = sklearn.cross_decomposition.PLSRegression(**PLS_dict)

    ntr = len(train)

    #Break into test and training sets
    xd = train_data_scale[train]
    yd = class_y_train[train]
    xt = train_data_scale[test]
    yt = class_y_train[test]

    traincolor = fullcolors[train]
    testcolor = fullcolors[test]


    #Bootstrap on the training set, get uncertainties in the test set
    lbt_out = plu.bootstrap(xdata=xd,ydata=yd,validdata=xt,PLS_kw=PLS_dict,samples=1500,tq=False)

    rcv,ecv,msecv,boot_train,train_predict,boot_test = lbt_out

    #Call the bootstrap generation function
    plot_bootstrap_pls(boot_train,yd,test_data=boot_test,y_test=yt,train_colors=fullcolors,axes_row=axes[row],group=True)
    #Change the default labels and y limits
    ax = axes[row,0]
    ax.set_ylabel('')
    ax.set_xlabel('')
    ax.set_ylim(-0.5,1.5)
    ax.set_yticks([0,1])
    mcax = axes[row,1]
    mcax.set_xlabel('')

    test_boundary = ax.axvline(x=ntr-0.5,lw=2,ls=':')
    #ax.text(5,1.7,"Cross-validation training",size=12,bbox=dict(edgecolor='white',facecolor='white', alpha=1))
    #ax.text(ntr+5,1.7,"Cross-validation test",size=12,bbox=dict(edgecolor='white',facecolor='white', alpha=1))

    if row == 0:
        plot_bootstrap_pls(boot_train,yd,test_data=boot_test,y_test=yt,train_colors=fullcolors,axes_row=axes1,group=True)
        nmr_bootstrap_annotate(axes1[0])
        misclass_legend(axes1[1])
        ax1 = axes1[0]
        ax1.legend_.remove()
        test_boundary = ax1.axvline(x=ntr-0.5,lw=2,ls=':')
        ax1.text(5,1.7,"Cross-validation training",size=12,bbox=dict(edgecolor='white',facecolor='white', alpha=1))
        ax1.text(ntr+5,1.7,"Cross-validation test",size=12,bbox=dict(edgecolor='white',facecolor='white', alpha=1))
    if row == 0:
        #break
        pass
figure11.tight_layout()
figureS2.savefig('figureS2.png',**figure_save_keys)
figure11.savefig('figure11.png',**figure_save_keys)<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<p>Figure 11 &amp; Figure S2</p>
<hr class="docutils" />
rcv,ecv,msecv,class_predicted_boot,class_predicted_train,scores_boot,loadings_boot = lb9_out

ci_upper = np.array([np.percentile(loadings_boot.T[comp_num::pls_components],97.5,axis=0) for comp_num in range(pls_components)])
ci_lower = np.array([np.percentile(loadings_boot.T[comp_num::pls_components],2.5,axis=0) for comp_num in range(pls_components)])<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">scores_base</span><span class="p">,</span><span class="n">scores_boot</span> <span class="o">=</span> <span class="n">bio_bootstrap</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">with_boot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">scores_boot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">scores_boot</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">scores_base</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">scores_base</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">Variable_colors</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">boot_sc</span> <span class="ow">in</span> <span class="n">scores_boot</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">boot_sc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">boot_sc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">Variable_colors</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_84_0.png" src="_images/run_environmental_pls-Copy1_84_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">loadings_boot</span> <span class="o">=</span> <span class="p">[</span><span class="n">est</span><span class="o">.</span><span class="n">x_loadings_</span> <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">bio_bootstrap</span><span class="o">.</span><span class="n">estimators_</span><span class="p">]</span>
<span class="n">loadings_boot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">loadings_boot</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loadings_boot</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">ci_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">loadings_boot</span><span class="p">,</span><span class="mf">97.5</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">ci_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">loadings_boot</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1000, 1761, 2)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">figure12</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bio_samples_project</span><span class="o">.</span><span class="n">_x_data</span><span class="p">,</span><span class="n">P</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">#p = ax.plot(bio_samples_project._x_data,(ci_upper.T - ci_lower.T)/2 + [1,2],color=&#39;r&#39;,zorder=3)</span>
<span class="c1">#p = ax.plot(bio_samples_project._x_data,(ci_lower.T - ci_upper.T)/2 + [1,2],color=&#39;r&#39;,zorder=3)</span>

<span class="k">for</span> <span class="n">num</span><span class="p">,</span><span class="n">ci_u</span><span class="p">,</span><span class="n">ci_l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">ci_upper</span><span class="p">,</span><span class="n">ci_lower</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">bio_samples_project</span><span class="o">.</span><span class="n">_x_data</span><span class="p">,</span><span class="n">ci_u</span><span class="o">-</span><span class="n">ci_l</span><span class="o">+</span><span class="n">num</span><span class="p">,</span><span class="n">ci_l</span><span class="o">-</span><span class="n">ci_u</span><span class="o">+</span><span class="n">num</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1">#ax.fill_between(bio_samples_project._x_data,ci_upper[0],0,facecolor=&#39;k&#39;)</span>
<span class="c1">#ax.fill_between(bio_samples_project._x_data,ci_lower[0],0,facecolor=&#39;w&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">4.9</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="s2">&quot;Latent variable 1&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">4.9</span><span class="p">,</span><span class="mf">1.9</span><span class="p">,</span><span class="s2">&quot;Latent variable 2&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1">#ax.set_yticks([-0.01,0,0.01,0.02])</span>

<span class="c1">#ax.text(9.1,-0.05,&#39;Nicotinic Acid&#39;,rotation=&#39;vertical&#39;)</span>
<span class="c1">#ax.text(6.7,-0.05,&#39;Fumarate&#39;,rotation=&#39;vertical&#39;)</span>
<span class="c1">#ax.text(5.4,-0.05,&#39;Glucose&#39;,rotation=&#39;vertical&#39;)</span>
<span class="c1">#ax.text(2.5,0.05,&#39;Citrate&#39;,rotation=&#39;vertical&#39;,va=&#39;bottom&#39;)</span>
<span class="c1">#ax.text(2.2,0.05,&#39;Glutamine&#39;,rotation=&#39;vertical&#39;,va=&#39;bottom&#39;)</span>
<span class="c1">#ax.text(1.55,-0.05,&#39;Alanine&#39;,rotation=&#39;vertical&#39;)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Loading Intensity (a.u.)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency shift / 10$^{-6}$ (ppm)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>


<span class="c1">#lactate = c</span>
<span class="c1">#glucose = b</span>
<span class="c1">#unknowns = m, k, g</span>
<span class="n">key_bins</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.33</span><span class="p">,</span><span class="s1">&#39;c-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">1.34</span><span class="p">,</span><span class="s1">&#39;c-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.12</span><span class="p">,</span><span class="s1">&#39;m-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.31</span><span class="p">,</span><span class="s1">&#39;m-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.14</span><span class="p">,</span><span class="s1">&#39;r--&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.28</span><span class="p">,</span><span class="s1">&#39;g--&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.41</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.48</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.50</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.72</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.73</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.84</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.89</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.91</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">1.49</span><span class="p">,</span><span class="s1">&#39;k-&#39;</span><span class="p">]]</span>

<span class="n">text_labels</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;Glucose&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="mf">3.72</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;Lactate&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="mf">1.33</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;UK1&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="mf">3.16</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;UK2&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="mf">3.07</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;UK2&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="mf">3.31</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;UK3&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="mf">3.24</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;New&#39;</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="mf">1.50</span><span class="p">]]</span>

<span class="c1">#tlabels = [&#39;Glucose&#39;,&#39;Lactate&#39;,&#39;UK1&#39;,&#39;UK2&#39;,&#39;UK3&#39;,&#39;New&#39;]</span>
<span class="c1">#tcolors = [&#39;b&#39;,&#39;c&#39;,&#39;r&#39;,&#39;m&#39;,&#39;g&#39;,&#39;k&#39;]</span>
<span class="c1">#tpos = [4.00,1.37,3.14,3.22,3.28,1.5]</span>

<span class="k">for</span> <span class="n">label</span><span class="p">,</span><span class="n">color</span><span class="p">,</span><span class="n">pos</span> <span class="ow">in</span> <span class="n">text_labels</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">bin_id</span><span class="p">,</span><span class="n">color</span> <span class="ow">in</span> <span class="n">key_bins</span><span class="p">:</span>
    <span class="n">metab</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">bin_id</span><span class="o">-</span><span class="mf">0.0025</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">figure12</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figure12.png&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">figure_save_keys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_86_0.png" src="_images/run_environmental_pls-Copy1_86_0.png" />
</div>
</div>
<p>Figure 12</p>
<hr class="docutils" />
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">figure12</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bio_samples_project</span><span class="o">.</span><span class="n">_x_data</span><span class="p">,</span><span class="n">P</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">#p = ax.plot(bio_samples_project._x_data,(ci_upper.T - ci_lower.T)/2 + [1,2],color=&#39;r&#39;,zorder=3)</span>
<span class="c1">#p = ax.plot(bio_samples_project._x_data,(ci_lower.T - ci_upper.T)/2 + [1,2],color=&#39;r&#39;,zorder=3)</span>

<span class="k">for</span> <span class="n">num</span><span class="p">,</span><span class="n">ci_u</span><span class="p">,</span><span class="n">ci_l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">ci_upper</span><span class="p">,</span><span class="n">ci_lower</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">bio_samples_project</span><span class="o">.</span><span class="n">_x_data</span><span class="p">,</span><span class="n">ci_u</span><span class="o">-</span><span class="n">ci_l</span><span class="o">+</span><span class="n">num</span><span class="p">,</span><span class="n">ci_l</span><span class="o">-</span><span class="n">ci_u</span><span class="o">+</span><span class="n">num</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1">#ax.fill_between(bio_samples_project._x_data,ci_upper[0],0,facecolor=&#39;k&#39;)</span>
<span class="c1">#ax.fill_between(bio_samples_project._x_data,ci_lower[0],0,facecolor=&#39;w&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">4.9</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="s2">&quot;Latent variable 1&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">4.9</span><span class="p">,</span><span class="mf">1.9</span><span class="p">,</span><span class="s2">&quot;Latent variable 2&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1">#ax.set_yticks([-0.01,0,0.01,0.02])</span>

<span class="c1">#ax.text(9.1,-0.05,&#39;Nicotinic Acid&#39;,rotation=&#39;vertical&#39;)</span>
<span class="c1">#ax.text(6.7,-0.05,&#39;Fumarate&#39;,rotation=&#39;vertical&#39;)</span>
<span class="c1">#ax.text(5.4,-0.05,&#39;Glucose&#39;,rotation=&#39;vertical&#39;)</span>
<span class="c1">#ax.text(2.5,0.05,&#39;Citrate&#39;,rotation=&#39;vertical&#39;,va=&#39;bottom&#39;)</span>
<span class="c1">#ax.text(2.2,0.05,&#39;Glutamine&#39;,rotation=&#39;vertical&#39;,va=&#39;bottom&#39;)</span>
<span class="c1">#ax.text(1.55,-0.05,&#39;Alanine&#39;,rotation=&#39;vertical&#39;)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Loading Intensity (a.u.)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency shift / 10$^{-6}$ (ppm)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>


<span class="c1">#lactate = c</span>
<span class="c1">#glucose = b</span>
<span class="c1">#unknowns = m, k, g</span>
<span class="n">key_bins</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.33</span><span class="p">,</span><span class="s1">&#39;c-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">1.34</span><span class="p">,</span><span class="s1">&#39;c-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.12</span><span class="p">,</span><span class="s1">&#39;m-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.31</span><span class="p">,</span><span class="s1">&#39;m-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.14</span><span class="p">,</span><span class="s1">&#39;r--&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.28</span><span class="p">,</span><span class="s1">&#39;g--&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.41</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.48</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.50</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.72</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.73</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.84</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.89</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">3.91</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">1.49</span><span class="p">,</span><span class="s1">&#39;k-&#39;</span><span class="p">]]</span>

<span class="n">text_labels</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;Glucose&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="mf">3.72</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;Lactate&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="mf">1.33</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;UK1&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="mf">3.16</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;UK2&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="mf">3.07</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;UK2&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="mf">3.31</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;UK3&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="mf">3.24</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;New&#39;</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="mf">1.50</span><span class="p">]]</span>

<span class="c1">#tlabels = [&#39;Glucose&#39;,&#39;Lactate&#39;,&#39;UK1&#39;,&#39;UK2&#39;,&#39;UK3&#39;,&#39;New&#39;]</span>
<span class="c1">#tcolors = [&#39;b&#39;,&#39;c&#39;,&#39;r&#39;,&#39;m&#39;,&#39;g&#39;,&#39;k&#39;]</span>
<span class="c1">#tpos = [4.00,1.37,3.14,3.22,3.28,1.5]</span>

<span class="c1">#for label,color,pos in text_labels:</span>
<span class="c1">#    ax.text(pos,0.6,label,color=color,rotation=&#39;vertical&#39;,va=&#39;bottom&#39;,ha=&#39;center&#39;)</span>

<span class="c1">#for bin_id,color in key_bins:</span>
<span class="c1">#    metab = ax.axvline(x=bin_id-0.0025,color=color[0],ls=color[1:],zorder=1)</span>
<span class="c1">#figure12.savefig(&#39;figure12.png&#39;,**figure_save_keys)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/run_environmental_pls-Copy1_88_0.png" src="_images/run_environmental_pls-Copy1_88_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table of Contents</h3>
          <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="docs.html">Module Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="toy_regression_object-oriented.html">Example linear regression (1st-order polynomial)</a></li>
<li class="toctree-l1"><a class="reference internal" href="toy_regression_object-oriented_2nd_order.html">Example linear regression (2nd-order polynomial)</a></li>
<li class="toctree-l1"><a class="reference internal" href="qsar_regression_object-oriented.html">Uncertainty in QSAR modeling</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Uncertainty in biomarker identification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Imports-and-local-function-definitions">Imports and local function definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Consensus-analysis">Consensus analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Uncertainty-analysis-on-unsupervised-classification">Uncertainty analysis on unsupervised classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Uncertainty-analysis-on-supervised-learning">Uncertainty analysis on supervised learning</a></li>
</ul>
</li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="qsar_regression_object-oriented.html" title="Uncertainty in QSAR modeling"
              >previous</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/run_environmental_pls-Copy1.ipynb.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>